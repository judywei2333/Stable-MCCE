{"config":{"lang":["en"],"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Multi-Conformation Continuum Electrostatics - MCCE \u00b6 Page last updated on: 2020-01-16 MCCE is a biophysics simulation program combining continuum electrostatics and molecular mechanics. In this program, the protein side chain motions are simulated explicitly while the dielectric effect of solvent and bulk protein material is modeled by continuum electrostatics. What can MCCE do? \u00b6 MCCE can calculate: residue pka, cofactor Em and protein PI in protein-solvent systems; protein structural responses to changes in charge; residue ionization changes in response to protein structural changes; location and stoichiometry of proton transfers coupled to electron transfer References (Cite these papers if you use MCCE for publications): \u00b6 Song Y., J. Mao, Gunner M.R. (2009). J. Comp. Chem epub Mar 2009 Georgescu R.E., Alexov E.G., Gunner M.R.(2002). Combining conformational flexibility and continuum electrostatics for calculating pKa's in proteins. Biophys J. 83, 1731-1748 Alexov, E. and Gunner, M.R. (1997) Incorporating protein conformational flexibility into pH- titration calculations: Results on T4 Lysozyme. Biophys. J. 74, 2075-2093","title":"Overview"},{"location":"#multi-conformation-continuum-electrostatics-mcce","text":"Page last updated on: 2020-01-16 MCCE is a biophysics simulation program combining continuum electrostatics and molecular mechanics. In this program, the protein side chain motions are simulated explicitly while the dielectric effect of solvent and bulk protein material is modeled by continuum electrostatics.","title":"Multi-Conformation Continuum Electrostatics - MCCE"},{"location":"#what-can-mcce-do","text":"MCCE can calculate: residue pka, cofactor Em and protein PI in protein-solvent systems; protein structural responses to changes in charge; residue ionization changes in response to protein structural changes; location and stoichiometry of proton transfers coupled to electron transfer","title":"What can MCCE do?"},{"location":"#references-cite-these-papers-if-you-use-mcce-for-publications","text":"Song Y., J. Mao, Gunner M.R. (2009). J. Comp. Chem epub Mar 2009 Georgescu R.E., Alexov E.G., Gunner M.R.(2002). Combining conformational flexibility and continuum electrostatics for calculating pKa's in proteins. Biophys J. 83, 1731-1748 Alexov, E. and Gunner, M.R. (1997) Incorporating protein conformational flexibility into pH- titration calculations: Results on T4 Lysozyme. Biophys. J. 74, 2075-2093","title":"References (Cite these papers if you use MCCE for publications):"},{"location":"emexample/","text":"Calculate Em of heme in Cytochrome \u00b6 Page last updated on: 2019-12-16","title":"Em calculation"},{"location":"emexample/#calculate-em-of-heme-in-cytochrome","text":"Page last updated on: 2019-12-16","title":"Calculate Em of heme in Cytochrome"},{"location":"hbexample/","text":"Compute hydrogen bond network \u00b6 Page last updated on: 2019-12-16","title":"Hydrogen-bond network"},{"location":"hbexample/#compute-hydrogen-bond-network","text":"Page last updated on: 2019-12-16","title":"Compute hydrogen bond network"},{"location":"mcce2free/","text":"How to convert an existing mcce tpl file to free format tpl file? \u00b6 Page last updated on: 2020-02-16 There accumulated a big number of mcce tpl files (topology file of a molecule) which defines the conformers, atoms, connectivity and so on. Since mcce tpl file follows strict format, new mcce adopted a free format to save the same information. Follow these steps to convert an existing mcce tpl file to a new free format tpl file. This example is assuming you convert a mcce tpl file glu.tpl in param04 directory. Convert \u00b6 Run this command to convert mcce format to free format. bin / tpl - mcce2free . py param04 / glu . tpl > glu . ftpl The above output file has most entries converted. Fix \"rxn\" record \u00b6 Then we can manually compile rxn values in CONFORMER records. First manually replace rxn = with rxn02 = , rxn04 = , rxn08 = depending on the dielectric constant of the tpl file that was converted from. CONFORMER , GLU01 : Em0 = 0 . 0 , pKa0 = 0 . 00 , ne = 0 , nH = 0 , rxn02 = - 6 . 410 , rxn04 = - 3 . 100 , rxn08 = - 1 . 390 Error check \u00b6 Now find the atom name difference, especially H atoms. PDB is using version 3 names and old mcce is using version 2 names. For GLU, the name comparison can be found at here . If you have a pdb file of the residue/ligand, we can test the ftpl file against that pdb file: bin / verify_tpl . py ftplfile pdbfile It will report any atoms that can not be loaded by the converted ftpl file definition. To change the name in ftpl file, glu.ftp for example: sed - i 's/1HB / HB2/g' glu . ftpl You can verify the ftpl file again after the change of names. Store in param directory \u00b6 Finally, place the tested ftpl file under MCCE distribution's \"param\" directory. The MCCE distribution directory is the the ( HOME ) line in your run.prm.","title":"Convert mcce tpl file"},{"location":"mcce2free/#how-to-convert-an-existing-mcce-tpl-file-to-free-format-tpl-file","text":"Page last updated on: 2020-02-16 There accumulated a big number of mcce tpl files (topology file of a molecule) which defines the conformers, atoms, connectivity and so on. Since mcce tpl file follows strict format, new mcce adopted a free format to save the same information. Follow these steps to convert an existing mcce tpl file to a new free format tpl file. This example is assuming you convert a mcce tpl file glu.tpl in param04 directory.","title":"How to convert an existing mcce tpl file to free format tpl file?"},{"location":"mcce2free/#convert","text":"Run this command to convert mcce format to free format. bin / tpl - mcce2free . py param04 / glu . tpl > glu . ftpl The above output file has most entries converted.","title":"Convert"},{"location":"mcce2free/#fix-rxn-record","text":"Then we can manually compile rxn values in CONFORMER records. First manually replace rxn = with rxn02 = , rxn04 = , rxn08 = depending on the dielectric constant of the tpl file that was converted from. CONFORMER , GLU01 : Em0 = 0 . 0 , pKa0 = 0 . 00 , ne = 0 , nH = 0 , rxn02 = - 6 . 410 , rxn04 = - 3 . 100 , rxn08 = - 1 . 390","title":"Fix \"rxn\" record"},{"location":"mcce2free/#error-check","text":"Now find the atom name difference, especially H atoms. PDB is using version 3 names and old mcce is using version 2 names. For GLU, the name comparison can be found at here . If you have a pdb file of the residue/ligand, we can test the ftpl file against that pdb file: bin / verify_tpl . py ftplfile pdbfile It will report any atoms that can not be loaded by the converted ftpl file definition. To change the name in ftpl file, glu.ftp for example: sed - i 's/1HB / HB2/g' glu . ftpl You can verify the ftpl file again after the change of names.","title":"Error check"},{"location":"mcce2free/#store-in-param-directory","text":"Finally, place the tested ftpl file under MCCE distribution's \"param\" directory. The MCCE distribution directory is the the ( HOME ) line in your run.prm.","title":"Store in param directory"},{"location":"mfehowto/","text":"How to break down the energy of a residue ionization? \u00b6 Page last updated on: 2020-01-17","title":"Analyze ionization energy"},{"location":"mfehowto/#how-to-break-down-the-energy-of-a-residue-ionization","text":"Page last updated on: 2020-01-17","title":"How to break down the energy of a residue ionization?"},{"location":"newftpl/","text":"How to make a new topology file? \u00b6 Page last updated on: 2020-05-19 Topology file defines a molecule, including the atom connectivity, atom charge and radius, how conformers are made etc. General format of ftpl file \u00b6 The format of free format tpl file is simple. It is simply a key value pair separated by \":\". The key can be up to three fields, separated by \",\". The first key field is primary key, describing what kind of record it is, and the other two keys are supplementary, describing what molecule/conformer/atom it belongs to. The Value is a string, and will be processed by the mcce program in the context of key. If a space is a part of the key or value, it must be quoted inside double quotes. \":\", \",\" and \"#\" are reserved, and can not be used as part of key and value. The following is an example: Any text after \"#\" is considered comment. Any line that doesn't have \":\" is considered as comment CONNECT , \" N \" , GLUBK : sp2 , \" ? \" , \" CA \" , \" H \" MCCE reads in lines from ftpl files and save them in a single database. The content in multiple ftpl files are compiled into the database. Therefore one ftpl file can define multiple residues, and one residue parameter lines can be spread in multiple files. If the same key appears more than once, only the value of the last one is valid. This means the previous loaded value under this key will be overwritten. The order of reading ftpl files is alphabetic order of the file names. Reference of ftpl records \u00b6 Conformer list \u00b6 Example: CONFLIST , GLU : GLUBK , GLU01 , GLU02 , GLU - 1 This is a required parameter for a molecule This parameter tells MCCE that residue GLU has 4 conformers. A conformer is named in as a 3-char residue name + 2-char conformer label. The conformer that ends with BK is a special backbone conformer. The atoms of the backbone conformerdo not change charge and protonation states. They and the atoms of one of the other side chain conformers make up the residue. In addition backbone conformers of all residues are grouped into one big chunck for energy calculation. Conformers other than backbone conformer are side chain conformers. They differ with each other by atom charge, bond connection, or proton number. Another special type conformer ends with \"DM\" as a convention name. The \"DM\" is not required. It has 0 atoms (no matching CONNECT parameters), and it represents the absence of this conformer, such as water leaving the site. Atom and bonds \u00b6 Example: CONNECT , \" N \" , GLUBK : sp2 , \" ? \" , \" CA \" , \" H \" CONNECT , \" H \" , GLUBK : s , \" N \" CONNECT , \" CA \" , GLUBK : sp3 , \" N \" , \" C \" , \" CB \" , \" HA \" CONNECT , \" HA \" , GLUBK : s , \" CA \" CONNECT , \" C \" , GLUBK : sp2 , \" CA \" , \" O \" , \" ? \" CONNECT , \" O \" , GLUBK : sp2 , \" C \" CONNECT , \" CB \" , GLU01 : sp3 , \" CA \" , \" CG \" , \" HB2 \" , \" HB3 \" CONNECT , \" HB2 \" , GLU01 : s , \" CB \" CONNECT , \" HB3 \" , GLU01 : s , \" CB \" CONNECT , \" CG \" , GLU01 : sp3 , \" CB \" , \" CD \" , \" HG2 \" , \" HG3 \" CONNECT , \" HG2 \" , GLU01 : s , \" CG \" CONNECT , \" HG3 \" , GLU01 : s , \" CG \" CONNECT , \" CD \" , GLU01 : sp2 , \" CG \" , \" OE1 \" , \" OE2 \" CONNECT , \" OE1 \" , GLU01 : sp3 , \" CD \" , \" HE1 \" CONNECT , \" HE1 \" , GLU01 : s , \" OE1 \" CONNECT , \" OE2 \" , GLU01 : s , \" CD \" CONNECT , \" CB \" , GLU02 : sp3 , \" CA \" , \" CG \" , \" HB2 \" , \" HB3 \" CONNECT , \" HB2 \" , GLU02 : s , \" CB \" CONNECT , \" HB3 \" , GLU02 : s , \" CB \" CONNECT , \" CG \" , GLU02 : sp3 , \" CB \" , \" CD \" , \" HG2 \" , \" HG3 \" CONNECT , \" HG2 \" , GLU02 : s , \" CG \" CONNECT , \" HG3 \" , GLU02 : s , \" CG \" CONNECT , \" CD \" , GLU02 : sp2 , \" CG \" , \" OE1 \" , \" OE2 \" CONNECT , \" OE1 \" , GLU02 : s , \" CD \" CONNECT , \" OE2 \" , GLU02 : sp3 , \" CD \" , \" HE2 \" CONNECT , \" HE2 \" , GLU02 : sp3 , \" OE2 \" CONNECT , \" CB \" , GLU - 1 : sp3 , \" CA \" , \" CG \" , \" HB2 \" , \" HB3 \" CONNECT , \" HB2 \" , GLU - 1 : s , \" CB \" CONNECT , \" HB3 \" , GLU - 1 : s , \" CB \" CONNECT , \" CG \" , GLU - 1 : sp3 , \" CB \" , \" CD \" , \" HG2 \" , \" HG3 \" CONNECT , \" HG2 \" , GLU - 1 : s , \" CG \" CONNECT , \" HG3 \" , GLU - 1 : s , \" CG \" CONNECT , \" CD \" , GLU - 1 : sp2 , \" CG \" , \" OE1 \" , \" OE2 \" CONNECT , \" OE1 \" , GLU - 1 : sp2 , \" CD \" CONNECT , \" OE2 \" , GLU - 1 : sp2 , \" CD \" CONNECT parameters define three things for a conformer: the atom names, bond geometry, and bonds. If none CONNECT parameters exist for a conformer, that conformer is a \"dummy\" conformer, representing the absence of the atoms/molecule. The keys are: parameter name, atom name, and conformer name, in this order. The value starts with atom orbital hybridization, which defines the bond angles and bond numbers, then the atoms that are bonded. For a single atom molecule, or an atom that are not connected to other atoms, use \"ion\" as the orbital type. The atom names need to be enclosed in quotations so the spaces will be counted. Atom charges \u00b6 CHARGE , GLUBK , \" N \" : - 0 . 350 CHARGE , GLUBK , \" H \" : 0 . 250 CHARGE , GLUBK , \" CA \" : 0 . 100 CHARGE , GLUBK , \" HA \" : 0 . 000 CHARGE , GLUBK , \" C \" : 0 . 550 CHARGE , GLUBK , \" O \" : - 0 . 550 CHARGE , GLU01 , \" CB \" : 0 . 000 CHARGE , GLU01 , \" HB2\" : 0 . 000 CHARGE , GLU01 , \" HB3\" : 0 . 000 CHARGE , GLU01 , \" CG \" : 0 . 000 CHARGE , GLU01 , \" HG2\" : 0 . 000 CHARGE , GLU01 , \" HG3\" : 0 . 000 CHARGE , GLU01 , \" CD \" : 0 . 550 CHARGE , GLU01 , \" OE1\" : - 0 . 495 CHARGE , GLU01 , \" HE1\" : 0 . 435 CHARGE , GLU01 , \" OE2\" : - 0 . 490 CHARGE , GLU02 , \" CB \" : 0 . 000 CHARGE , GLU02 , \" HB2\" : 0 . 000 CHARGE , GLU02 , \" HB3\" : 0 . 000 CHARGE , GLU02 , \" CG \" : 0 . 000 CHARGE , GLU02 , \" HG2\" : 0 . 000 CHARGE , GLU02 , \" HG3\" : 0 . 000 CHARGE , GLU02 , \" CD \" : 0 . 550 CHARGE , GLU02 , \" OE1\" : - 0 . 490 CHARGE , GLU02 , \" OE2\" : - 0 . 495 CHARGE , GLU02 , \" HE2\" : 0 . 435 CHARGE , GLU - 1 , \" CB \" : 0 . 000 CHARGE , GLU - 1 , \" HB2\" : 0 . 000 CHARGE , GLU - 1 , \" HB3\" : 0 . 000 CHARGE , GLU - 1 , \" CG \" : 0 . 000 CHARGE , GLU - 1 , \" HG2\" : 0 . 000 CHARGE , GLU - 1 , \" HG3\" : 0 . 000 CHARGE , GLU - 1 , \" CD \" : 0 . 100 CHARGE , GLU - 1 , \" OE1\" : - 0 . 550 CHARGE , GLU - 1 , \" OE2\" : - 0 . 550 This parameter defines the charge of an atom in a conformer. The same atom in a molecule may have different charge depending on its bond status, protonation states, and ionization states. The key is the parameter name, conformer name and atom name. and the value is the atomic charge. If a CHARGE parameter is missing for an atom, a 0 charge is assumed. Atom radius \u00b6 Example: RADIUS , GLUBK , \" N \" : 1 . 500 , 1 . 750 , 0 . 160 RADIUS , GLUBK , \" H \" : 1 . 000 , 1 . 000 , 0 . 020 RADIUS , GLUBK , \" CA \" : 2 . 000 , 2 . 000 , 0 . 150 RADIUS , GLUBK , \" HA \" : 0 . 000 , 1 . 000 , 0 . 020 RADIUS , GLUBK , \" C \" : 1 . 700 , 2 . 000 , 0 . 150 RADIUS , GLUBK , \" O \" : 1 . 400 , 1 . 600 , 0 . 200 RADIUS , GLU01 , \" CB \" : 2 . 000 , 2 . 000 , 0 . 150 RADIUS , GLU01 , \" HB2\" : 0 . 000 , 1 . 000 , 0 . 020 RADIUS , GLU01 , \" HB3\" : 0 . 000 , 1 . 000 , 0 . 020 RADIUS , GLU01 , \" CG \" : 2 . 000 , 2 . 000 , 0 . 150 RADIUS , GLU01 , \" HG2\" : 0 . 000 , 1 . 000 , 0 . 020 RADIUS , GLU01 , \" HG3\" : 0 . 000 , 1 . 000 , 0 . 020 RADIUS , GLU01 , \" CD \" : 1 . 700 , 2 . 000 , 0 . 150 RADIUS , GLU01 , \" OE1\" : 1 . 400 , 1 . 600 , 0 . 200 RADIUS , GLU01 , \" HE1\" : 1 . 000 , 1 . 000 , 0 . 020 RADIUS , GLU01 , \" OE2\" : 1 . 400 , 1 . 600 , 0 . 200 RADIUS , GLU02 , \" CB \" : 2 . 000 , 2 . 000 , 0 . 150 RADIUS , GLU02 , \" HB2\" : 0 . 000 , 1 . 000 , 0 . 020 RADIUS , GLU02 , \" HB3\" : 0 . 000 , 1 . 000 , 0 . 020 RADIUS , GLU02 , \" CG \" : 2 . 000 , 2 . 000 , 0 . 150 RADIUS , GLU02 , \" HG2\" : 0 . 000 , 1 . 000 , 0 . 020 RADIUS , GLU02 , \" HG3\" : 0 . 000 , 1 . 000 , 0 . 020 RADIUS , GLU02 , \" CD \" : 1 . 700 , 2 . 000 , 0 . 150 RADIUS , GLU02 , \" OE1\" : 1 . 400 , 1 . 600 , 0 . 200 RADIUS , GLU02 , \" OE2\" : 1 . 400 , 1 . 600 , 0 . 200 RADIUS , GLU02 , \" HE2\" : 1 . 000 , 1 . 000 , 0 . 020 RADIUS , GLU - 1 , \" CB \" : 2 . 000 , 2 . 000 , 0 . 150 RADIUS , GLU - 1 , \" HB2\" : 0 . 000 , 1 . 000 , 0 . 020 RADIUS , GLU - 1 , \" HB3\" : 0 . 000 , 1 . 000 , 0 . 020 RADIUS , GLU - 1 , \" CG \" : 2 . 000 , 2 . 000 , 0 . 150 RADIUS , GLU - 1 , \" HG2\" : 0 . 000 , 1 . 000 , 0 . 020 RADIUS , GLU - 1 , \" HG3\" : 0 . 000 , 1 . 000 , 0 . 020 RADIUS , GLU - 1 , \" CD \" : 1 . 700 , 2 . 000 , 0 . 150 RADIUS , GLU - 1 , \" OE1\" : 1 . 400 , 1 . 600 , 0 . 200 RADIUS , GLU - 1 , \" OE2\" : 1 . 400 , 1 . 600 , 0 . 200 The radius parameter includes both the dielelctric boundary radius, and VDW radius plus energy well depth. The key is the parameter name, conformer name and atom name. The value has three fields. They are radius for defining dielectric boundary, and the radius and energy well depth to caculate Van der Waals energy. Conformer parameters \u00b6 Example: CONFORMER , GLU01 : Em0 = 0 . 0 , pKa0 = 0 . 00 , ne = 0 , nH = 0 , rxn02 = - 6 . 41 , rxn04 = - 3 . 100 , rxn08 = - 1 . 39 CONFORMER , GLU02 : Em0 = 0 . 0 , pKa0 = 0 . 00 , ne = 0 , nH = 0 , rxn02 = - 6 . 44 , rxn04 = - 3 . 100 , rxn08 = - 1 . 39 CONFORMER , GLU - 1 : Em0 = 0 . 0 , pKa0 = 4 . 75 , ne = 0 , nH =- 1 , rxn02 =- 41 . 76 , rxn04 =- 20 . 200 , rxn08 = - 9 . 59 Each conformer defined in CONFLIST except backbone and dummy conformers should have a line in this section. It defines some necessary conformer properties. The key is parameter name and conformer. The value consists fields separated by commas. Each field is a key value pair. Em0: Redox titration midpoint potential of the molecule in solution. pKa0: pH titration mid point of the molecule in solution ne: relative number of electrons. For a redox reaction, the ground state has ne = 0, the excited state has a ne of none 0. nH: relative number of protons. For a protonation reaction, the ground state has nH = 0, charged acid loses a proton so nH = -1 and charged base gains a proton so nH = 1. rxn02: reference reaction field energy at dielectric constant 2. rxn04: reference reaction field energy at dielectric constant 4. rxn08: reference reaction field energy at dielectric constant 8. Rotatable bonds \u00b6 Example: ROTATE , GLU : \" CA \" - \" CB \" , \" CB \" - \" CG \" , \" CG \" - \" CD \" This is an optional parameter. The key is parameter name and residue name. Different conformer types are not configured to have different bond rotations. The key is a series of rotatable bonds. Each rotatable bond is defined by two atoms, and these two atoms are directional. The direction means when a bond rotation is made, the first atom is stationary, and the second atom and all atoms connected to it in that direction will all rotate accordingly. How to make a new ftpl file \u00b6 Although one can manually write all the parameter lines in ftpl file. There are tools to help making ftpl file much easier. Make ftpl file template \u00b6 If you have a pdb file, you can build a ftpl file template out of it. Syntax: pdb2ftpl . py [ - d ] [ - c ID ] pdbfile The command will use CONECT record in pdb file to find bonds when available. If CONECT does not exist, the program will switch to distance calculated by atom coordinates to make bonds. The switch \"-d\" forces the program to use distance to make bonds. The switch \"-c ID\" lets the program to use a different 2-character conformer ID. By default, the ID is 01. Obtain atom charges \u00b6 One way to compute atomic charge is through Atomic Charge Calculator at https://webchem.ncbr.muni.cz/Platform/ChargeCalculator You can specify non-0 total charge of the molecule with this tool. Calculate reference reaction field energy \u00b6 Once you assign the atomic charges to the atoms in the ftpl file template and name it with suffix .ftpl, copy this file to the mcce param directory under its installation folder. The installation directory is where the mcce program is. For example, you find the location of mcce executable: which mcce / home / jmao / projects / Stable - MCCE / bin / mcce Then the param directory is: ls / home / jmao / projects / Stable - MCCE / param 00 always_needed . tpl asn . ftpl _cl . ftpl ena . ftpl gly . ftpl ile . ftpl mel . ftpl ntr . ftpl ser . ftpl tyr . ftpl 7 MQ . ftpl asp . ftpl ctr . ftpl for . ftpl hil . ftpl leu . ftpl mem . ftpl pdbs step1_out . pdb val . ftpl ala . ftpl bcl . ftpl cyd . ftpl gln . ftpl his . ftpl lys . ftpl met . ftpl phe . ftpl thr . ftpl _zn . ftpl arg . ftpl bcr . ftpl cys . ftpl glu . ftpl hoh . ftpl mcce . tpl _na . ftpl pro . ftpl trp . ftpl This is the directory ftpl files are stored. Examples of making ftpl file \u00b6 Here are some examples of making new ftpl file for molecules: Single state \u00b6 This example prepares a ftpl file for a molecule with one single state. That is, no inozation conformer, no dummy conformer. Ethanol: CH3CH2OH Step 1: Get pdb file \u00b6 Goto RSCB ligand expo http://ligand-expo.rcsb.org/ Search Ethanol as molecule name from http://ligand-expo.rcsb.org/ . Download the pdb file of ethanol EOH_ideal.pdb. or use this command to download directly wget http : // ligand - expo . rcsb . org / reports / E / EOH / EOH_ideal . pdb Step 2: Make a ftpl file \u00b6 pdb2ftpl . py EOH_ideal . pdb > eoh . ftpl cat eoh . ftpl # Conformer definition CONFLIST , EOH : EOHBK , EOH01 # ATOM name and bonds CONNECT , \" C1 \" , EOH01 : sp3 , \" C2 \" , \" O \" , \" H11 \" , \" H12 \" CONNECT , \" C2 \" , EOH01 : sp3 , \" C1 \" , \" H21 \" , \" H22 \" , \" H23 \" CONNECT , \" O \" , EOH01 : sp3 , \" C1 \" , \" HO \" CONNECT , \" H11 \" , EOH01 : s , \" C1 \" CONNECT , \" H12 \" , EOH01 : s , \" C1 \" CONNECT , \" H21 \" , EOH01 : s , \" C2 \" CONNECT , \" H22 \" , EOH01 : s , \" C2 \" CONNECT , \" H23 \" , EOH01 : s , \" C2 \" CONNECT , \" HO \" , EOH01 : s , \" O \" # ATOM charges CHARGE , EOH01 , \" C1 \" : to_be_filled CHARGE , EOH01 , \" C2 \" : to_be_filled CHARGE , EOH01 , \" O \" : to_be_filled CHARGE , EOH01 , \" H11 \" : to_be_filled CHARGE , EOH01 , \" H12 \" : to_be_filled CHARGE , EOH01 , \" H21 \" : to_be_filled CHARGE , EOH01 , \" H22 \" : to_be_filled CHARGE , EOH01 , \" H23 \" : to_be_filled CHARGE , EOH01 , \" HO \" : to_be_filled # Atom radius , dielelctric boundary radius , VDW radius , and energy well depth RADIUS , EOH01 , \" C1 \" : 1 . 700 , 2 . 000 , 0 . 150 RADIUS , EOH01 , \" C2 \" : 1 . 700 , 2 . 000 , 0 . 150 RADIUS , EOH01 , \" O \" : 1 . 400 , 1 . 600 , 0 . 200 RADIUS , EOH01 , \" H11 \" : 1 . 000 , 1 . 000 , 0 . 020 RADIUS , EOH01 , \" H12 \" : 1 . 000 , 1 . 000 , 0 . 020 RADIUS , EOH01 , \" H21 \" : 1 . 000 , 1 . 000 , 0 . 020 RADIUS , EOH01 , \" H22 \" : 1 . 000 , 1 . 000 , 0 . 020 RADIUS , EOH01 , \" H23 \" : 1 . 000 , 1 . 000 , 0 . 020 RADIUS , EOH01 , \" HO \" : 1 . 000 , 1 . 000 , 0 . 020 # Conformer parameters that appear in head3 . lst : ne , Em0 , nH , pKa0 , rxn CONFORMER , EOH01 : Em0 = 0 . 0 , pKa0 = 0 . 00 , ne = 0 , nH = 0 , rxn02 = to_be_filled , rxn04 = to_be_filled , rxn08 = to_be_filled Step 3: Calculate charge \u00b6 Go to https://webchem.ncbr.muni.cz/Platform/ChargeCalculator Submit EOH_ideal.pdb, set total charge 0, and obtain the atomic charge results. Assign the charges to the previously made file eoh.ftpl # Conformer definition CONFLIST , EOH : EOHBK , EOH01 # ATOM name and bonds CONNECT , \" C1 \" , EOH01 : sp3 , \" C2 \" , \" O \" , \" H11 \" , \" H12 \" CONNECT , \" C2 \" , EOH01 : sp3 , \" C1 \" , \" H21 \" , \" H22 \" , \" H23 \" CONNECT , \" O \" , EOH01 : sp3 , \" C1 \" , \" HO \" CONNECT , \" H11 \" , EOH01 : s , \" C1 \" CONNECT , \" H12 \" , EOH01 : s , \" C1 \" CONNECT , \" H21 \" , EOH01 : s , \" C2 \" CONNECT , \" H22 \" , EOH01 : s , \" C2 \" CONNECT , \" H23 \" , EOH01 : s , \" C2 \" CONNECT , \" HO \" , EOH01 : s , \" O \" # ATOM charges CHARGE , EOH01 , \" C1 \" : - 0 . 085 CHARGE , EOH01 , \" C2 \" : - 0 . 554 CHARGE , EOH01 , \" O \" : - 0 . 746 CHARGE , EOH01 , \" H11 \" : 0 . 177 CHARGE , EOH01 , \" H12 \" : 0 . 177 CHARGE , EOH01 , \" H21 \" : 0 . 237 CHARGE , EOH01 , \" H22 \" : 0 . 237 CHARGE , EOH01 , \" H23 \" : 0 . 209 CHARGE , EOH01 , \" HO \" : 0 . 351 # Atom radius , dielelctric boundary radius , VDW radius , and energy well depth RADIUS , EOH01 , \" C1 \" : 1 . 700 , 2 . 000 , 0 . 150 RADIUS , EOH01 , \" C2 \" : 1 . 700 , 2 . 000 , 0 . 150 RADIUS , EOH01 , \" O \" : 1 . 400 , 1 . 600 , 0 . 200 RADIUS , EOH01 , \" H11 \" : 1 . 000 , 1 . 000 , 0 . 020 RADIUS , EOH01 , \" H12 \" : 1 . 000 , 1 . 000 , 0 . 020 RADIUS , EOH01 , \" H21 \" : 1 . 000 , 1 . 000 , 0 . 020 RADIUS , EOH01 , \" H22 \" : 1 . 000 , 1 . 000 , 0 . 020 RADIUS , EOH01 , \" H23 \" : 1 . 000 , 1 . 000 , 0 . 020 RADIUS , EOH01 , \" HO \" : 1 . 000 , 1 . 000 , 0 . 020 # Conformer parameters that appear in head3 . lst : ne , Em0 , nH , pKa0 , rxn CONFORMER , EOH01 : Em0 = 0 . 0 , pKa0 = 0 . 00 , ne = 0 , nH = 0 , rxn02 = 0 , rxn04 = 0 , rxn08 = 0 Step 4: Install ftpl file \u00b6 Find the param/ location which mcce / home / jmao / projects / Stable - MCCE / bin / mcce Copy ftpl file to param/ cp eoh . ftpl / home / jmao / projects / Stable - MCCE / param Step 5: Reaction field energy \u00b6 Starting with rxn02 = 0, rxn04 = 0, and rxn08 = 0, we are going to recalculate the proper reference values so that this molecule in solution gives 0 desolvation energy in self-energy file head3.lst. step1 . py --noter EOH_ideal.pdb step2 . py step3 . py Then do cat head3 . lst and find the number under dsolv, which is -4.076 in our case. The step 3 used default dielectric constant 4, so this value is for rxn04. Put this number back to eoh.ftpl file under param/ so it reads like: # Conformer parameters that appear in head3 . lst : ne , Em0 , nH , pKa0 , rxn CONFORMER , EOH01 : Em0 = 0 . 0 , pKa0 = 0 . 00 , ne = 0 , nH = 0 , rxn02 = 0 , rxn04 = - 4 . 076 , rxn08 = 0 If we run 3 steps again, we will get dsolv about 0 this time: step3 . py cat head3 . lst iConf CONFORMER FL occ crg Em0 pKa0 ne nH vdw0 vdw1 tors epol dsolv extra history 00001 EOH01A0001_001 f 0 . 00 0 . 003 0 0 . 00 0 0 0 . 677 0 . 000 0 . 000 0 . 000 0 . 004 0 . 000 01 O000M000 t Next we need to do the same for rxn02 and rxn 08. Step3 will take epsilon as our command option this time. Dielectric constant 2 step3 . py - d 2 cat head3 . lst iConf CONFORMER FL occ crg Em0 pKa0 ne nH vdw0 vdw1 tors epol dsolv extra history 00001 EOH01A0001_001 f 0 . 00 0 . 003 0 0 . 00 0 0 0 . 677 0 . 000 0 . 000 0 . 000 - 8 . 500 0 . 000 01 O000M000 t Dielectric constant 8 step3 . py - d 8 cat head3 . lst iConf CONFORMER FL occ crg Em0 pKa0 ne nH vdw0 vdw1 tors epol dsolv extra history 00001 EOH01A0001_001 f 0 . 00 0 . 003 0 0 . 00 0 0 0 . 677 0 . 000 0 . 000 0 . 000 - 1 . 875 0 . 000 01 O000M000 t Put these numbers back to param/eoh.ftpl under installation folder, this line reads as: CONFORMER , EOH01 : Em0 = 0 . 0 , pKa0 = 0 . 00 , ne = 0 , nH = 0 , rxn02 = - 8 . 5 , rxn04 = - 4 . 076 , rxn08 = - 1 . 875 Protonation or redox states \u00b6 What if a molecule has multiple ionization states? In short, we need to assign two conformer types and give atoms different charge sets. Example: Acetic acid: CH3COOH Prepare pdb files \u00b6 Goto RSCB ligand expo http://ligand-expo.rcsb.org/ Search \"acetic acid\" Click on Chemical details of ACY Download pdb file or wget http : // ligand - expo . rcsb . org / reports / A / ACY / ACY_ideal . pdb This file is in protonated state: ATOM 1 C ACY A 1 0 . 012 - 0 . 056 0 . 002 1 . 00 10 . 00 C ATOM 2 O ACY A 1 0 . 261 - 1 . 238 - 0 . 000 1 . 00 10 . 00 O ATOM 3 OXT ACY A 1 1 . 011 0 . 840 - 0 . 000 1 . 00 10 . 00 O ATOM 4 CH3 ACY A 1 - 1 . 421 0 . 412 - 0 . 000 1 . 00 10 . 00 C ATOM 5 HXT ACY A 1 1 . 913 0 . 493 - 0 . 003 1 . 00 10 . 00 H ATOM 6 H1 ACY A 1 - 1 . 768 0 . 523 1 . 027 1 . 00 10 . 00 H ATOM 7 H2 ACY A 1 - 1 . 489 1 . 372 - 0 . 512 1 . 00 10 . 00 H ATOM 8 H3 ACY A 1 - 2 . 042 - 0 . 320 - 0 . 517 1 . 00 10 . 00 H CONECT 1 2 3 4 CONECT 2 1 CONECT 3 1 5 CONECT 4 1 6 7 8 CONECT 5 3 CONECT 6 4 CONECT 7 4 CONECT 8 4 We need to make a pdb file in name ACY_deprotonated.pdb for deprotonated state by deleting HXT: ATOM 1 C ACY A 1 0 . 012 - 0 . 056 0 . 002 1 . 00 10 . 00 C ATOM 2 O ACY A 1 0 . 261 - 1 . 238 - 0 . 000 1 . 00 10 . 00 O ATOM 3 OXT ACY A 1 1 . 011 0 . 840 - 0 . 000 1 . 00 10 . 00 O ATOM 4 CH3 ACY A 1 - 1 . 421 0 . 412 - 0 . 000 1 . 00 10 . 00 C ATOM 6 H1 ACY A 1 - 1 . 768 0 . 523 1 . 027 1 . 00 10 . 00 H ATOM 7 H2 ACY A 1 - 1 . 489 1 . 372 - 0 . 512 1 . 00 10 . 00 H ATOM 8 H3 ACY A 1 - 2 . 042 - 0 . 320 - 0 . 517 1 . 00 10 . 00 H We also deleted CONECT because we dont want to manually fix CONECT due to the missing HXT. Make ftpl files \u00b6 create ftpl template for protonated acetic acid pdb2ftpl . py ACY_ideal . pdb > acy . ftpl create ftpl template for deprotonated acetic acid pdb2ftpl . py - c - 1 ACY_deprotonated . pdb > acy - 1 . ftpl Merge two files. While CONFLIST maintains a single line, other parameters still take individual lines. # Conformer definition CONFLIST , ACY : ACYBK , ACY01 , ACY - 1 # ATOM name and bonds CONNECT , \" C \" , ACY01 : sp2 , \" O \" , \" OXT \" , \" CH3 \" CONNECT , \" O \" , ACY01 : sp3 , \" C \" CONNECT , \" OXT \" , ACY01 : sp2 , \" C \" , \" HXT \" CONNECT , \" CH3 \" , ACY01 : sp3 , \" C \" , \" H1 \" , \" H2 \" , \" H3 \" CONNECT , \" HXT \" , ACY01 : s , \" OXT \" CONNECT , \" H1 \" , ACY01 : s , \" CH3 \" CONNECT , \" H2 \" , ACY01 : s , \" CH3 \" CONNECT , \" H3 \" , ACY01 : s , \" CH3 \" CONNECT , \" C \" , ACY - 1 : sp2 , \" O \" , \" OXT \" , \" CH3 \" CONNECT , \" O \" , ACY - 1 : sp3 , \" C \" CONNECT , \" OXT \" , ACY - 1 : sp3 , \" C \" CONNECT , \" CH3 \" , ACY - 1 : sp3 , \" C \" , \" H1 \" , \" H2 \" , \" H3 \" CONNECT , \" H1 \" , ACY - 1 : s , \" CH3 \" CONNECT , \" H2 \" , ACY - 1 : s , \" CH3 \" CONNECT , \" H3 \" , ACY - 1 : s , \" CH3 \" # ATOM charges CHARGE , ACY01 , \" C \" : to_be_filled CHARGE , ACY01 , \" O \" : to_be_filled CHARGE , ACY01 , \" OXT \" : to_be_filled CHARGE , ACY01 , \" CH3 \" : to_be_filled CHARGE , ACY01 , \" HXT \" : to_be_filled CHARGE , ACY01 , \" H1 \" : to_be_filled CHARGE , ACY01 , \" H2 \" : to_be_filled CHARGE , ACY01 , \" H3 \" : to_be_filled CHARGE , ACY - 1 , \" C \" : to_be_filled CHARGE , ACY - 1 , \" O \" : to_be_filled CHARGE , ACY - 1 , \" OXT \" : to_be_filled CHARGE , ACY - 1 , \" CH3 \" : to_be_filled CHARGE , ACY - 1 , \" H1 \" : to_be_filled CHARGE , ACY - 1 , \" H2 \" : to_be_filled CHARGE , ACY - 1 , \" H3 \" : to_be_filled # Atom radius , dielelctric boundary radius , VDW radius , and energy well depth RADIUS , ACY01 , \" C \" : 1 . 700 , 2 . 000 , 0 . 150 RADIUS , ACY01 , \" O \" : 1 . 400 , 1 . 600 , 0 . 200 RADIUS , ACY01 , \" OXT \" : 1 . 400 , 1 . 600 , 0 . 200 RADIUS , ACY01 , \" CH3 \" : 1 . 700 , 2 . 000 , 0 . 150 RADIUS , ACY01 , \" HXT \" : 1 . 000 , 1 . 000 , 0 . 020 RADIUS , ACY01 , \" H1 \" : 1 . 000 , 1 . 000 , 0 . 020 RADIUS , ACY01 , \" H2 \" : 1 . 000 , 1 . 000 , 0 . 020 RADIUS , ACY01 , \" H3 \" : 1 . 000 , 1 . 000 , 0 . 020 RADIUS , ACY - 1 , \" C \" : 1 . 700 , 2 . 000 , 0 . 150 RADIUS , ACY - 1 , \" O \" : 1 . 400 , 1 . 600 , 0 . 200 RADIUS , ACY - 1 , \" OXT \" : 1 . 400 , 1 . 600 , 0 . 200 RADIUS , ACY - 1 , \" CH3 \" : 1 . 700 , 2 . 000 , 0 . 150 RADIUS , ACY - 1 , \" H1 \" : 1 . 000 , 1 . 000 , 0 . 020 RADIUS , ACY - 1 , \" H2 \" : 1 . 000 , 1 . 000 , 0 . 020 RADIUS , ACY - 1 , \" H3 \" : 1 . 000 , 1 . 000 , 0 . 020 # Conformer parameters that appear in head3 . lst : ne , Em0 , nH , pKa0 , rxn CONFORMER , ACY01 : Em0 = 0 . 0 , pKa0 = 0 . 00 , ne = 0 , nH = 0 , rxn02 = 0 , rxn04 = 0 , rxn08 = 0 CONFORMER , ACY - 1 : Em0 = 0 . 0 , pKa0 = 0 . 00 , ne = 0 , nH = 0 , rxn02 = 0 , rxn04 = 0 , rxn08 = 0 Calculate charge \u00b6 Go to https://webchem.ncbr.muni.cz/Platform/ChargeCalculator Submit ACY_ideal.pdb, set total charge 0, and obtain the atomic charge results. Submit ACY_deprotonated.pdb, set total charge -1, and obtain the atomic charge results. Assign the charges to acy.ftpl file: take individual lines. # Conformer definition CONFLIST , ACY : ACYBK , ACY01 , ACY - 1 # ATOM name and bonds CONNECT , \" C \" , ACY01 : sp2 , \" O \" , \" OXT \" , \" CH3 \" CONNECT , \" O \" , ACY01 : sp3 , \" C \" CONNECT , \" OXT \" , ACY01 : sp2 , \" C \" , \" HXT \" CONNECT , \" CH3 \" , ACY01 : sp3 , \" C \" , \" H1 \" , \" H2 \" , \" H3 \" CONNECT , \" HXT \" , ACY01 : s , \" OXT \" CONNECT , \" H1 \" , ACY01 : s , \" CH3 \" CONNECT , \" H2 \" , ACY01 : s , \" CH3 \" CONNECT , \" H3 \" , ACY01 : s , \" CH3 \" CONNECT , \" C \" , ACY - 1 : sp2 , \" O \" , \" OXT \" , \" CH3 \" CONNECT , \" O \" , ACY - 1 : sp3 , \" C \" CONNECT , \" OXT \" , ACY - 1 : sp3 , \" C \" CONNECT , \" CH3 \" , ACY - 1 : sp3 , \" C \" , \" H1 \" , \" H2 \" , \" H3 \" CONNECT , \" H1 \" , ACY - 1 : s , \" CH3 \" CONNECT , \" H2 \" , ACY - 1 : s , \" CH3 \" CONNECT , \" H3 \" , ACY - 1 : s , \" CH3 \" # ATOM charges CHARGE , ACY01 , \" C \" : 0 . 680 CHARGE , ACY01 , \" O \" : - 0 . 590 CHARGE , ACY01 , \" OXT \" : - 0 . 774 CHARGE , ACY01 , \" CH3 \" : - 0 . 606 CHARGE , ACY01 , \" HXT \" : 0 . 433 CHARGE , ACY01 , \" H1 \" : 0 . 283 CHARGE , ACY01 , \" H2 \" : 0 . 287 CHARGE , ACY01 , \" H3 \" : 0 . 287 CHARGE , ACY - 1 , \" C \" : 0 . 577 CHARGE , ACY - 1 , \" O \" : - 0 . 768 CHARGE , ACY - 1 , \" OXT \" : - 0 . 699 CHARGE , ACY - 1 , \" CH3 \" : - 0 . 714 CHARGE , ACY - 1 , \" H1 \" : 0 . 198 CHARGE , ACY - 1 , \" H2 \" : 0 . 202 CHARGE , ACY - 1 , \" H3 \" : 0 . 204 # Atom radius , dielelctric boundary radius , VDW radius , and energy well depth RADIUS , ACY01 , \" C \" : 1 . 700 , 2 . 000 , 0 . 150 RADIUS , ACY01 , \" O \" : 1 . 400 , 1 . 600 , 0 . 200 RADIUS , ACY01 , \" OXT \" : 1 . 400 , 1 . 600 , 0 . 200 RADIUS , ACY01 , \" CH3 \" : 1 . 700 , 2 . 000 , 0 . 150 RADIUS , ACY01 , \" HXT \" : 1 . 000 , 1 . 000 , 0 . 020 RADIUS , ACY01 , \" H1 \" : 1 . 000 , 1 . 000 , 0 . 020 RADIUS , ACY01 , \" H2 \" : 1 . 000 , 1 . 000 , 0 . 020 RADIUS , ACY01 , \" H3 \" : 1 . 000 , 1 . 000 , 0 . 020 RADIUS , ACY - 1 , \" C \" : 1 . 700 , 2 . 000 , 0 . 150 RADIUS , ACY - 1 , \" O \" : 1 . 400 , 1 . 600 , 0 . 200 RADIUS , ACY - 1 , \" OXT \" : 1 . 400 , 1 . 600 , 0 . 200 RADIUS , ACY - 1 , \" CH3 \" : 1 . 700 , 2 . 000 , 0 . 150 RADIUS , ACY - 1 , \" H1 \" : 1 . 000 , 1 . 000 , 0 . 020 RADIUS , ACY - 1 , \" H2 \" : 1 . 000 , 1 . 000 , 0 . 020 RADIUS , ACY - 1 , \" H3 \" : 1 . 000 , 1 . 000 , 0 . 020 # Conformer parameters that appear in head3 . lst : ne , Em0 , nH , pKa0 , rxn CONFORMER , ACY01 : Em0 = 0 . 0 , pKa0 = 0 . 00 , ne = 0 , nH = 0 , rxn02 = 0 , rxn04 = 0 , rxn08 = 0 CONFORMER , ACY - 1 : Em0 = 0 . 0 , pKa0 = 0 . 00 , ne = 0 , nH = 0 , rxn02 = 0 , rxn04 = 0 , rxn08 = 0 Install ftpl file \u00b6 Find the param/ location which mcce / home / jmao / projects / Stable - MCCE / bin / mcce Copy ftpl file to param/ cp acy . ftpl / home / jmao / projects / Stable - MCCE / param Reaction field energy \u00b6 Run step 1 to 3: step1 . py --noter ACY_ideal.pdb step2 . py step3 . py - d 2 cat head3 . lst iConf CONFORMER FL occ crg Em0 pKa0 ne nH vdw0 vdw1 tors epol dsolv extra history 00001 ACY01A0001_001 f 0 . 00 0 . 000 0 0 . 00 0 0 0 . 497 0 . 000 0 . 000 0 . 000 - 11 . 413 0 . 000 01 O000M000 t 00002 ACY - 1 A0001_002 f 0 . 00 - 1 . 000 0 0 . 00 0 0 0 . 180 0 . 000 0 . 000 0 . 000 - 47 . 119 0 . 000 - 1 O000M000 t step3 . py - d 4 iConf CONFORMER FL occ crg Em0 pKa0 ne nH vdw0 vdw1 tors epol dsolv extra history 00001 ACY01A0001_001 f 0 . 00 0 . 000 0 0 . 00 0 0 0 . 497 0 . 000 0 . 000 0 . 000 - 5 . 495 0 . 000 01 O000M000 t 00002 ACY - 1 A0001_002 f 0 . 00 - 1 . 000 0 0 . 00 0 0 0 . 180 0 . 000 0 . 000 0 . 000 - 22 . 902 0 . 000 - 1 O000M000 t step3 . py - d 8 iConf CONFORMER FL occ crg Em0 pKa0 ne nH vdw0 vdw1 tors epol dsolv extra history 00001 ACY01A0001_001 f 0 . 00 0 . 000 0 0 . 00 0 0 0 . 497 0 . 000 0 . 000 0 . 000 - 2 . 548 0 . 000 01 O000M000 t 00002 ACY - 1 A0001_002 f 0 . 00 - 1 . 000 0 0 . 00 0 0 0 . 180 0 . 000 0 . 000 0 . 000 - 10 . 801 0 . 000 - 1 O000M000 t Put the values back in /path/to/param/acy.ftpl, set nH=-1 because this conformer loses a proton, and set pKa0 =4.75 as this is acetic acid pKa. # Conformer parameters that appear in head3 . lst : ne , Em0 , nH , pKa0 , rxn CONFORMER , ACY01 : Em0 = 0 . 0 , pKa0 = 0 . 00 , ne = 0 , nH = 0 , rxn02 = - 11 . 413 , rxn04 = - 5 . 495 , rxn08 = - 2 . 548 CONFORMER , ACY - 1 : Em0 = 0 . 0 , pKa0 = 4 . 75 , ne = 0 , nH =- 1 , rxn02 = - 47 . 119 , rxn04 = - 22 . 902 , rxn08 = - 10 . 801","title":"Make a new topology file"},{"location":"newftpl/#how-to-make-a-new-topology-file","text":"Page last updated on: 2020-05-19 Topology file defines a molecule, including the atom connectivity, atom charge and radius, how conformers are made etc.","title":"How to make a new topology file?"},{"location":"newftpl/#general-format-of-ftpl-file","text":"The format of free format tpl file is simple. It is simply a key value pair separated by \":\". The key can be up to three fields, separated by \",\". The first key field is primary key, describing what kind of record it is, and the other two keys are supplementary, describing what molecule/conformer/atom it belongs to. The Value is a string, and will be processed by the mcce program in the context of key. If a space is a part of the key or value, it must be quoted inside double quotes. \":\", \",\" and \"#\" are reserved, and can not be used as part of key and value. The following is an example: Any text after \"#\" is considered comment. Any line that doesn't have \":\" is considered as comment CONNECT , \" N \" , GLUBK : sp2 , \" ? \" , \" CA \" , \" H \" MCCE reads in lines from ftpl files and save them in a single database. The content in multiple ftpl files are compiled into the database. Therefore one ftpl file can define multiple residues, and one residue parameter lines can be spread in multiple files. If the same key appears more than once, only the value of the last one is valid. This means the previous loaded value under this key will be overwritten. The order of reading ftpl files is alphabetic order of the file names.","title":"General format of ftpl file"},{"location":"newftpl/#reference-of-ftpl-records","text":"","title":"Reference of ftpl records"},{"location":"newftpl/#conformer-list","text":"Example: CONFLIST , GLU : GLUBK , GLU01 , GLU02 , GLU - 1 This is a required parameter for a molecule This parameter tells MCCE that residue GLU has 4 conformers. A conformer is named in as a 3-char residue name + 2-char conformer label. The conformer that ends with BK is a special backbone conformer. The atoms of the backbone conformerdo not change charge and protonation states. They and the atoms of one of the other side chain conformers make up the residue. In addition backbone conformers of all residues are grouped into one big chunck for energy calculation. Conformers other than backbone conformer are side chain conformers. They differ with each other by atom charge, bond connection, or proton number. Another special type conformer ends with \"DM\" as a convention name. The \"DM\" is not required. It has 0 atoms (no matching CONNECT parameters), and it represents the absence of this conformer, such as water leaving the site.","title":"Conformer list"},{"location":"newftpl/#atom-and-bonds","text":"Example: CONNECT , \" N \" , GLUBK : sp2 , \" ? \" , \" CA \" , \" H \" CONNECT , \" H \" , GLUBK : s , \" N \" CONNECT , \" CA \" , GLUBK : sp3 , \" N \" , \" C \" , \" CB \" , \" HA \" CONNECT , \" HA \" , GLUBK : s , \" CA \" CONNECT , \" C \" , GLUBK : sp2 , \" CA \" , \" O \" , \" ? \" CONNECT , \" O \" , GLUBK : sp2 , \" C \" CONNECT , \" CB \" , GLU01 : sp3 , \" CA \" , \" CG \" , \" HB2 \" , \" HB3 \" CONNECT , \" HB2 \" , GLU01 : s , \" CB \" CONNECT , \" HB3 \" , GLU01 : s , \" CB \" CONNECT , \" CG \" , GLU01 : sp3 , \" CB \" , \" CD \" , \" HG2 \" , \" HG3 \" CONNECT , \" HG2 \" , GLU01 : s , \" CG \" CONNECT , \" HG3 \" , GLU01 : s , \" CG \" CONNECT , \" CD \" , GLU01 : sp2 , \" CG \" , \" OE1 \" , \" OE2 \" CONNECT , \" OE1 \" , GLU01 : sp3 , \" CD \" , \" HE1 \" CONNECT , \" HE1 \" , GLU01 : s , \" OE1 \" CONNECT , \" OE2 \" , GLU01 : s , \" CD \" CONNECT , \" CB \" , GLU02 : sp3 , \" CA \" , \" CG \" , \" HB2 \" , \" HB3 \" CONNECT , \" HB2 \" , GLU02 : s , \" CB \" CONNECT , \" HB3 \" , GLU02 : s , \" CB \" CONNECT , \" CG \" , GLU02 : sp3 , \" CB \" , \" CD \" , \" HG2 \" , \" HG3 \" CONNECT , \" HG2 \" , GLU02 : s , \" CG \" CONNECT , \" HG3 \" , GLU02 : s , \" CG \" CONNECT , \" CD \" , GLU02 : sp2 , \" CG \" , \" OE1 \" , \" OE2 \" CONNECT , \" OE1 \" , GLU02 : s , \" CD \" CONNECT , \" OE2 \" , GLU02 : sp3 , \" CD \" , \" HE2 \" CONNECT , \" HE2 \" , GLU02 : sp3 , \" OE2 \" CONNECT , \" CB \" , GLU - 1 : sp3 , \" CA \" , \" CG \" , \" HB2 \" , \" HB3 \" CONNECT , \" HB2 \" , GLU - 1 : s , \" CB \" CONNECT , \" HB3 \" , GLU - 1 : s , \" CB \" CONNECT , \" CG \" , GLU - 1 : sp3 , \" CB \" , \" CD \" , \" HG2 \" , \" HG3 \" CONNECT , \" HG2 \" , GLU - 1 : s , \" CG \" CONNECT , \" HG3 \" , GLU - 1 : s , \" CG \" CONNECT , \" CD \" , GLU - 1 : sp2 , \" CG \" , \" OE1 \" , \" OE2 \" CONNECT , \" OE1 \" , GLU - 1 : sp2 , \" CD \" CONNECT , \" OE2 \" , GLU - 1 : sp2 , \" CD \" CONNECT parameters define three things for a conformer: the atom names, bond geometry, and bonds. If none CONNECT parameters exist for a conformer, that conformer is a \"dummy\" conformer, representing the absence of the atoms/molecule. The keys are: parameter name, atom name, and conformer name, in this order. The value starts with atom orbital hybridization, which defines the bond angles and bond numbers, then the atoms that are bonded. For a single atom molecule, or an atom that are not connected to other atoms, use \"ion\" as the orbital type. The atom names need to be enclosed in quotations so the spaces will be counted.","title":"Atom and bonds"},{"location":"newftpl/#atom-charges","text":"CHARGE , GLUBK , \" N \" : - 0 . 350 CHARGE , GLUBK , \" H \" : 0 . 250 CHARGE , GLUBK , \" CA \" : 0 . 100 CHARGE , GLUBK , \" HA \" : 0 . 000 CHARGE , GLUBK , \" C \" : 0 . 550 CHARGE , GLUBK , \" O \" : - 0 . 550 CHARGE , GLU01 , \" CB \" : 0 . 000 CHARGE , GLU01 , \" HB2\" : 0 . 000 CHARGE , GLU01 , \" HB3\" : 0 . 000 CHARGE , GLU01 , \" CG \" : 0 . 000 CHARGE , GLU01 , \" HG2\" : 0 . 000 CHARGE , GLU01 , \" HG3\" : 0 . 000 CHARGE , GLU01 , \" CD \" : 0 . 550 CHARGE , GLU01 , \" OE1\" : - 0 . 495 CHARGE , GLU01 , \" HE1\" : 0 . 435 CHARGE , GLU01 , \" OE2\" : - 0 . 490 CHARGE , GLU02 , \" CB \" : 0 . 000 CHARGE , GLU02 , \" HB2\" : 0 . 000 CHARGE , GLU02 , \" HB3\" : 0 . 000 CHARGE , GLU02 , \" CG \" : 0 . 000 CHARGE , GLU02 , \" HG2\" : 0 . 000 CHARGE , GLU02 , \" HG3\" : 0 . 000 CHARGE , GLU02 , \" CD \" : 0 . 550 CHARGE , GLU02 , \" OE1\" : - 0 . 490 CHARGE , GLU02 , \" OE2\" : - 0 . 495 CHARGE , GLU02 , \" HE2\" : 0 . 435 CHARGE , GLU - 1 , \" CB \" : 0 . 000 CHARGE , GLU - 1 , \" HB2\" : 0 . 000 CHARGE , GLU - 1 , \" HB3\" : 0 . 000 CHARGE , GLU - 1 , \" CG \" : 0 . 000 CHARGE , GLU - 1 , \" HG2\" : 0 . 000 CHARGE , GLU - 1 , \" HG3\" : 0 . 000 CHARGE , GLU - 1 , \" CD \" : 0 . 100 CHARGE , GLU - 1 , \" OE1\" : - 0 . 550 CHARGE , GLU - 1 , \" OE2\" : - 0 . 550 This parameter defines the charge of an atom in a conformer. The same atom in a molecule may have different charge depending on its bond status, protonation states, and ionization states. The key is the parameter name, conformer name and atom name. and the value is the atomic charge. If a CHARGE parameter is missing for an atom, a 0 charge is assumed.","title":"Atom charges"},{"location":"newftpl/#atom-radius","text":"Example: RADIUS , GLUBK , \" N \" : 1 . 500 , 1 . 750 , 0 . 160 RADIUS , GLUBK , \" H \" : 1 . 000 , 1 . 000 , 0 . 020 RADIUS , GLUBK , \" CA \" : 2 . 000 , 2 . 000 , 0 . 150 RADIUS , GLUBK , \" HA \" : 0 . 000 , 1 . 000 , 0 . 020 RADIUS , GLUBK , \" C \" : 1 . 700 , 2 . 000 , 0 . 150 RADIUS , GLUBK , \" O \" : 1 . 400 , 1 . 600 , 0 . 200 RADIUS , GLU01 , \" CB \" : 2 . 000 , 2 . 000 , 0 . 150 RADIUS , GLU01 , \" HB2\" : 0 . 000 , 1 . 000 , 0 . 020 RADIUS , GLU01 , \" HB3\" : 0 . 000 , 1 . 000 , 0 . 020 RADIUS , GLU01 , \" CG \" : 2 . 000 , 2 . 000 , 0 . 150 RADIUS , GLU01 , \" HG2\" : 0 . 000 , 1 . 000 , 0 . 020 RADIUS , GLU01 , \" HG3\" : 0 . 000 , 1 . 000 , 0 . 020 RADIUS , GLU01 , \" CD \" : 1 . 700 , 2 . 000 , 0 . 150 RADIUS , GLU01 , \" OE1\" : 1 . 400 , 1 . 600 , 0 . 200 RADIUS , GLU01 , \" HE1\" : 1 . 000 , 1 . 000 , 0 . 020 RADIUS , GLU01 , \" OE2\" : 1 . 400 , 1 . 600 , 0 . 200 RADIUS , GLU02 , \" CB \" : 2 . 000 , 2 . 000 , 0 . 150 RADIUS , GLU02 , \" HB2\" : 0 . 000 , 1 . 000 , 0 . 020 RADIUS , GLU02 , \" HB3\" : 0 . 000 , 1 . 000 , 0 . 020 RADIUS , GLU02 , \" CG \" : 2 . 000 , 2 . 000 , 0 . 150 RADIUS , GLU02 , \" HG2\" : 0 . 000 , 1 . 000 , 0 . 020 RADIUS , GLU02 , \" HG3\" : 0 . 000 , 1 . 000 , 0 . 020 RADIUS , GLU02 , \" CD \" : 1 . 700 , 2 . 000 , 0 . 150 RADIUS , GLU02 , \" OE1\" : 1 . 400 , 1 . 600 , 0 . 200 RADIUS , GLU02 , \" OE2\" : 1 . 400 , 1 . 600 , 0 . 200 RADIUS , GLU02 , \" HE2\" : 1 . 000 , 1 . 000 , 0 . 020 RADIUS , GLU - 1 , \" CB \" : 2 . 000 , 2 . 000 , 0 . 150 RADIUS , GLU - 1 , \" HB2\" : 0 . 000 , 1 . 000 , 0 . 020 RADIUS , GLU - 1 , \" HB3\" : 0 . 000 , 1 . 000 , 0 . 020 RADIUS , GLU - 1 , \" CG \" : 2 . 000 , 2 . 000 , 0 . 150 RADIUS , GLU - 1 , \" HG2\" : 0 . 000 , 1 . 000 , 0 . 020 RADIUS , GLU - 1 , \" HG3\" : 0 . 000 , 1 . 000 , 0 . 020 RADIUS , GLU - 1 , \" CD \" : 1 . 700 , 2 . 000 , 0 . 150 RADIUS , GLU - 1 , \" OE1\" : 1 . 400 , 1 . 600 , 0 . 200 RADIUS , GLU - 1 , \" OE2\" : 1 . 400 , 1 . 600 , 0 . 200 The radius parameter includes both the dielelctric boundary radius, and VDW radius plus energy well depth. The key is the parameter name, conformer name and atom name. The value has three fields. They are radius for defining dielectric boundary, and the radius and energy well depth to caculate Van der Waals energy.","title":"Atom radius"},{"location":"newftpl/#conformer-parameters","text":"Example: CONFORMER , GLU01 : Em0 = 0 . 0 , pKa0 = 0 . 00 , ne = 0 , nH = 0 , rxn02 = - 6 . 41 , rxn04 = - 3 . 100 , rxn08 = - 1 . 39 CONFORMER , GLU02 : Em0 = 0 . 0 , pKa0 = 0 . 00 , ne = 0 , nH = 0 , rxn02 = - 6 . 44 , rxn04 = - 3 . 100 , rxn08 = - 1 . 39 CONFORMER , GLU - 1 : Em0 = 0 . 0 , pKa0 = 4 . 75 , ne = 0 , nH =- 1 , rxn02 =- 41 . 76 , rxn04 =- 20 . 200 , rxn08 = - 9 . 59 Each conformer defined in CONFLIST except backbone and dummy conformers should have a line in this section. It defines some necessary conformer properties. The key is parameter name and conformer. The value consists fields separated by commas. Each field is a key value pair. Em0: Redox titration midpoint potential of the molecule in solution. pKa0: pH titration mid point of the molecule in solution ne: relative number of electrons. For a redox reaction, the ground state has ne = 0, the excited state has a ne of none 0. nH: relative number of protons. For a protonation reaction, the ground state has nH = 0, charged acid loses a proton so nH = -1 and charged base gains a proton so nH = 1. rxn02: reference reaction field energy at dielectric constant 2. rxn04: reference reaction field energy at dielectric constant 4. rxn08: reference reaction field energy at dielectric constant 8.","title":"Conformer parameters"},{"location":"newftpl/#rotatable-bonds","text":"Example: ROTATE , GLU : \" CA \" - \" CB \" , \" CB \" - \" CG \" , \" CG \" - \" CD \" This is an optional parameter. The key is parameter name and residue name. Different conformer types are not configured to have different bond rotations. The key is a series of rotatable bonds. Each rotatable bond is defined by two atoms, and these two atoms are directional. The direction means when a bond rotation is made, the first atom is stationary, and the second atom and all atoms connected to it in that direction will all rotate accordingly.","title":"Rotatable bonds"},{"location":"newftpl/#how-to-make-a-new-ftpl-file","text":"Although one can manually write all the parameter lines in ftpl file. There are tools to help making ftpl file much easier.","title":"How to make a new ftpl file"},{"location":"newftpl/#make-ftpl-file-template","text":"If you have a pdb file, you can build a ftpl file template out of it. Syntax: pdb2ftpl . py [ - d ] [ - c ID ] pdbfile The command will use CONECT record in pdb file to find bonds when available. If CONECT does not exist, the program will switch to distance calculated by atom coordinates to make bonds. The switch \"-d\" forces the program to use distance to make bonds. The switch \"-c ID\" lets the program to use a different 2-character conformer ID. By default, the ID is 01.","title":"Make ftpl file template"},{"location":"newftpl/#obtain-atom-charges","text":"One way to compute atomic charge is through Atomic Charge Calculator at https://webchem.ncbr.muni.cz/Platform/ChargeCalculator You can specify non-0 total charge of the molecule with this tool.","title":"Obtain atom charges"},{"location":"newftpl/#calculate-reference-reaction-field-energy","text":"Once you assign the atomic charges to the atoms in the ftpl file template and name it with suffix .ftpl, copy this file to the mcce param directory under its installation folder. The installation directory is where the mcce program is. For example, you find the location of mcce executable: which mcce / home / jmao / projects / Stable - MCCE / bin / mcce Then the param directory is: ls / home / jmao / projects / Stable - MCCE / param 00 always_needed . tpl asn . ftpl _cl . ftpl ena . ftpl gly . ftpl ile . ftpl mel . ftpl ntr . ftpl ser . ftpl tyr . ftpl 7 MQ . ftpl asp . ftpl ctr . ftpl for . ftpl hil . ftpl leu . ftpl mem . ftpl pdbs step1_out . pdb val . ftpl ala . ftpl bcl . ftpl cyd . ftpl gln . ftpl his . ftpl lys . ftpl met . ftpl phe . ftpl thr . ftpl _zn . ftpl arg . ftpl bcr . ftpl cys . ftpl glu . ftpl hoh . ftpl mcce . tpl _na . ftpl pro . ftpl trp . ftpl This is the directory ftpl files are stored.","title":"Calculate reference reaction field energy"},{"location":"newftpl/#examples-of-making-ftpl-file","text":"Here are some examples of making new ftpl file for molecules:","title":"Examples of making ftpl file"},{"location":"newftpl/#single-state","text":"This example prepares a ftpl file for a molecule with one single state. That is, no inozation conformer, no dummy conformer. Ethanol: CH3CH2OH","title":"Single state"},{"location":"newftpl/#step-1-get-pdb-file","text":"Goto RSCB ligand expo http://ligand-expo.rcsb.org/ Search Ethanol as molecule name from http://ligand-expo.rcsb.org/ . Download the pdb file of ethanol EOH_ideal.pdb. or use this command to download directly wget http : // ligand - expo . rcsb . org / reports / E / EOH / EOH_ideal . pdb","title":"Step 1: Get pdb file"},{"location":"newftpl/#step-2-make-a-ftpl-file","text":"pdb2ftpl . py EOH_ideal . pdb > eoh . ftpl cat eoh . ftpl # Conformer definition CONFLIST , EOH : EOHBK , EOH01 # ATOM name and bonds CONNECT , \" C1 \" , EOH01 : sp3 , \" C2 \" , \" O \" , \" H11 \" , \" H12 \" CONNECT , \" C2 \" , EOH01 : sp3 , \" C1 \" , \" H21 \" , \" H22 \" , \" H23 \" CONNECT , \" O \" , EOH01 : sp3 , \" C1 \" , \" HO \" CONNECT , \" H11 \" , EOH01 : s , \" C1 \" CONNECT , \" H12 \" , EOH01 : s , \" C1 \" CONNECT , \" H21 \" , EOH01 : s , \" C2 \" CONNECT , \" H22 \" , EOH01 : s , \" C2 \" CONNECT , \" H23 \" , EOH01 : s , \" C2 \" CONNECT , \" HO \" , EOH01 : s , \" O \" # ATOM charges CHARGE , EOH01 , \" C1 \" : to_be_filled CHARGE , EOH01 , \" C2 \" : to_be_filled CHARGE , EOH01 , \" O \" : to_be_filled CHARGE , EOH01 , \" H11 \" : to_be_filled CHARGE , EOH01 , \" H12 \" : to_be_filled CHARGE , EOH01 , \" H21 \" : to_be_filled CHARGE , EOH01 , \" H22 \" : to_be_filled CHARGE , EOH01 , \" H23 \" : to_be_filled CHARGE , EOH01 , \" HO \" : to_be_filled # Atom radius , dielelctric boundary radius , VDW radius , and energy well depth RADIUS , EOH01 , \" C1 \" : 1 . 700 , 2 . 000 , 0 . 150 RADIUS , EOH01 , \" C2 \" : 1 . 700 , 2 . 000 , 0 . 150 RADIUS , EOH01 , \" O \" : 1 . 400 , 1 . 600 , 0 . 200 RADIUS , EOH01 , \" H11 \" : 1 . 000 , 1 . 000 , 0 . 020 RADIUS , EOH01 , \" H12 \" : 1 . 000 , 1 . 000 , 0 . 020 RADIUS , EOH01 , \" H21 \" : 1 . 000 , 1 . 000 , 0 . 020 RADIUS , EOH01 , \" H22 \" : 1 . 000 , 1 . 000 , 0 . 020 RADIUS , EOH01 , \" H23 \" : 1 . 000 , 1 . 000 , 0 . 020 RADIUS , EOH01 , \" HO \" : 1 . 000 , 1 . 000 , 0 . 020 # Conformer parameters that appear in head3 . lst : ne , Em0 , nH , pKa0 , rxn CONFORMER , EOH01 : Em0 = 0 . 0 , pKa0 = 0 . 00 , ne = 0 , nH = 0 , rxn02 = to_be_filled , rxn04 = to_be_filled , rxn08 = to_be_filled","title":"Step 2: Make a ftpl file"},{"location":"newftpl/#step-3-calculate-charge","text":"Go to https://webchem.ncbr.muni.cz/Platform/ChargeCalculator Submit EOH_ideal.pdb, set total charge 0, and obtain the atomic charge results. Assign the charges to the previously made file eoh.ftpl # Conformer definition CONFLIST , EOH : EOHBK , EOH01 # ATOM name and bonds CONNECT , \" C1 \" , EOH01 : sp3 , \" C2 \" , \" O \" , \" H11 \" , \" H12 \" CONNECT , \" C2 \" , EOH01 : sp3 , \" C1 \" , \" H21 \" , \" H22 \" , \" H23 \" CONNECT , \" O \" , EOH01 : sp3 , \" C1 \" , \" HO \" CONNECT , \" H11 \" , EOH01 : s , \" C1 \" CONNECT , \" H12 \" , EOH01 : s , \" C1 \" CONNECT , \" H21 \" , EOH01 : s , \" C2 \" CONNECT , \" H22 \" , EOH01 : s , \" C2 \" CONNECT , \" H23 \" , EOH01 : s , \" C2 \" CONNECT , \" HO \" , EOH01 : s , \" O \" # ATOM charges CHARGE , EOH01 , \" C1 \" : - 0 . 085 CHARGE , EOH01 , \" C2 \" : - 0 . 554 CHARGE , EOH01 , \" O \" : - 0 . 746 CHARGE , EOH01 , \" H11 \" : 0 . 177 CHARGE , EOH01 , \" H12 \" : 0 . 177 CHARGE , EOH01 , \" H21 \" : 0 . 237 CHARGE , EOH01 , \" H22 \" : 0 . 237 CHARGE , EOH01 , \" H23 \" : 0 . 209 CHARGE , EOH01 , \" HO \" : 0 . 351 # Atom radius , dielelctric boundary radius , VDW radius , and energy well depth RADIUS , EOH01 , \" C1 \" : 1 . 700 , 2 . 000 , 0 . 150 RADIUS , EOH01 , \" C2 \" : 1 . 700 , 2 . 000 , 0 . 150 RADIUS , EOH01 , \" O \" : 1 . 400 , 1 . 600 , 0 . 200 RADIUS , EOH01 , \" H11 \" : 1 . 000 , 1 . 000 , 0 . 020 RADIUS , EOH01 , \" H12 \" : 1 . 000 , 1 . 000 , 0 . 020 RADIUS , EOH01 , \" H21 \" : 1 . 000 , 1 . 000 , 0 . 020 RADIUS , EOH01 , \" H22 \" : 1 . 000 , 1 . 000 , 0 . 020 RADIUS , EOH01 , \" H23 \" : 1 . 000 , 1 . 000 , 0 . 020 RADIUS , EOH01 , \" HO \" : 1 . 000 , 1 . 000 , 0 . 020 # Conformer parameters that appear in head3 . lst : ne , Em0 , nH , pKa0 , rxn CONFORMER , EOH01 : Em0 = 0 . 0 , pKa0 = 0 . 00 , ne = 0 , nH = 0 , rxn02 = 0 , rxn04 = 0 , rxn08 = 0","title":"Step 3: Calculate charge"},{"location":"newftpl/#step-4-install-ftpl-file","text":"Find the param/ location which mcce / home / jmao / projects / Stable - MCCE / bin / mcce Copy ftpl file to param/ cp eoh . ftpl / home / jmao / projects / Stable - MCCE / param","title":"Step 4: Install ftpl file"},{"location":"newftpl/#step-5-reaction-field-energy","text":"Starting with rxn02 = 0, rxn04 = 0, and rxn08 = 0, we are going to recalculate the proper reference values so that this molecule in solution gives 0 desolvation energy in self-energy file head3.lst. step1 . py --noter EOH_ideal.pdb step2 . py step3 . py Then do cat head3 . lst and find the number under dsolv, which is -4.076 in our case. The step 3 used default dielectric constant 4, so this value is for rxn04. Put this number back to eoh.ftpl file under param/ so it reads like: # Conformer parameters that appear in head3 . lst : ne , Em0 , nH , pKa0 , rxn CONFORMER , EOH01 : Em0 = 0 . 0 , pKa0 = 0 . 00 , ne = 0 , nH = 0 , rxn02 = 0 , rxn04 = - 4 . 076 , rxn08 = 0 If we run 3 steps again, we will get dsolv about 0 this time: step3 . py cat head3 . lst iConf CONFORMER FL occ crg Em0 pKa0 ne nH vdw0 vdw1 tors epol dsolv extra history 00001 EOH01A0001_001 f 0 . 00 0 . 003 0 0 . 00 0 0 0 . 677 0 . 000 0 . 000 0 . 000 0 . 004 0 . 000 01 O000M000 t Next we need to do the same for rxn02 and rxn 08. Step3 will take epsilon as our command option this time. Dielectric constant 2 step3 . py - d 2 cat head3 . lst iConf CONFORMER FL occ crg Em0 pKa0 ne nH vdw0 vdw1 tors epol dsolv extra history 00001 EOH01A0001_001 f 0 . 00 0 . 003 0 0 . 00 0 0 0 . 677 0 . 000 0 . 000 0 . 000 - 8 . 500 0 . 000 01 O000M000 t Dielectric constant 8 step3 . py - d 8 cat head3 . lst iConf CONFORMER FL occ crg Em0 pKa0 ne nH vdw0 vdw1 tors epol dsolv extra history 00001 EOH01A0001_001 f 0 . 00 0 . 003 0 0 . 00 0 0 0 . 677 0 . 000 0 . 000 0 . 000 - 1 . 875 0 . 000 01 O000M000 t Put these numbers back to param/eoh.ftpl under installation folder, this line reads as: CONFORMER , EOH01 : Em0 = 0 . 0 , pKa0 = 0 . 00 , ne = 0 , nH = 0 , rxn02 = - 8 . 5 , rxn04 = - 4 . 076 , rxn08 = - 1 . 875","title":"Step 5: Reaction field energy"},{"location":"newftpl/#protonation-or-redox-states","text":"What if a molecule has multiple ionization states? In short, we need to assign two conformer types and give atoms different charge sets. Example: Acetic acid: CH3COOH","title":"Protonation or redox states"},{"location":"newftpl/#prepare-pdb-files","text":"Goto RSCB ligand expo http://ligand-expo.rcsb.org/ Search \"acetic acid\" Click on Chemical details of ACY Download pdb file or wget http : // ligand - expo . rcsb . org / reports / A / ACY / ACY_ideal . pdb This file is in protonated state: ATOM 1 C ACY A 1 0 . 012 - 0 . 056 0 . 002 1 . 00 10 . 00 C ATOM 2 O ACY A 1 0 . 261 - 1 . 238 - 0 . 000 1 . 00 10 . 00 O ATOM 3 OXT ACY A 1 1 . 011 0 . 840 - 0 . 000 1 . 00 10 . 00 O ATOM 4 CH3 ACY A 1 - 1 . 421 0 . 412 - 0 . 000 1 . 00 10 . 00 C ATOM 5 HXT ACY A 1 1 . 913 0 . 493 - 0 . 003 1 . 00 10 . 00 H ATOM 6 H1 ACY A 1 - 1 . 768 0 . 523 1 . 027 1 . 00 10 . 00 H ATOM 7 H2 ACY A 1 - 1 . 489 1 . 372 - 0 . 512 1 . 00 10 . 00 H ATOM 8 H3 ACY A 1 - 2 . 042 - 0 . 320 - 0 . 517 1 . 00 10 . 00 H CONECT 1 2 3 4 CONECT 2 1 CONECT 3 1 5 CONECT 4 1 6 7 8 CONECT 5 3 CONECT 6 4 CONECT 7 4 CONECT 8 4 We need to make a pdb file in name ACY_deprotonated.pdb for deprotonated state by deleting HXT: ATOM 1 C ACY A 1 0 . 012 - 0 . 056 0 . 002 1 . 00 10 . 00 C ATOM 2 O ACY A 1 0 . 261 - 1 . 238 - 0 . 000 1 . 00 10 . 00 O ATOM 3 OXT ACY A 1 1 . 011 0 . 840 - 0 . 000 1 . 00 10 . 00 O ATOM 4 CH3 ACY A 1 - 1 . 421 0 . 412 - 0 . 000 1 . 00 10 . 00 C ATOM 6 H1 ACY A 1 - 1 . 768 0 . 523 1 . 027 1 . 00 10 . 00 H ATOM 7 H2 ACY A 1 - 1 . 489 1 . 372 - 0 . 512 1 . 00 10 . 00 H ATOM 8 H3 ACY A 1 - 2 . 042 - 0 . 320 - 0 . 517 1 . 00 10 . 00 H We also deleted CONECT because we dont want to manually fix CONECT due to the missing HXT.","title":"Prepare pdb files"},{"location":"newftpl/#make-ftpl-files","text":"create ftpl template for protonated acetic acid pdb2ftpl . py ACY_ideal . pdb > acy . ftpl create ftpl template for deprotonated acetic acid pdb2ftpl . py - c - 1 ACY_deprotonated . pdb > acy - 1 . ftpl Merge two files. While CONFLIST maintains a single line, other parameters still take individual lines. # Conformer definition CONFLIST , ACY : ACYBK , ACY01 , ACY - 1 # ATOM name and bonds CONNECT , \" C \" , ACY01 : sp2 , \" O \" , \" OXT \" , \" CH3 \" CONNECT , \" O \" , ACY01 : sp3 , \" C \" CONNECT , \" OXT \" , ACY01 : sp2 , \" C \" , \" HXT \" CONNECT , \" CH3 \" , ACY01 : sp3 , \" C \" , \" H1 \" , \" H2 \" , \" H3 \" CONNECT , \" HXT \" , ACY01 : s , \" OXT \" CONNECT , \" H1 \" , ACY01 : s , \" CH3 \" CONNECT , \" H2 \" , ACY01 : s , \" CH3 \" CONNECT , \" H3 \" , ACY01 : s , \" CH3 \" CONNECT , \" C \" , ACY - 1 : sp2 , \" O \" , \" OXT \" , \" CH3 \" CONNECT , \" O \" , ACY - 1 : sp3 , \" C \" CONNECT , \" OXT \" , ACY - 1 : sp3 , \" C \" CONNECT , \" CH3 \" , ACY - 1 : sp3 , \" C \" , \" H1 \" , \" H2 \" , \" H3 \" CONNECT , \" H1 \" , ACY - 1 : s , \" CH3 \" CONNECT , \" H2 \" , ACY - 1 : s , \" CH3 \" CONNECT , \" H3 \" , ACY - 1 : s , \" CH3 \" # ATOM charges CHARGE , ACY01 , \" C \" : to_be_filled CHARGE , ACY01 , \" O \" : to_be_filled CHARGE , ACY01 , \" OXT \" : to_be_filled CHARGE , ACY01 , \" CH3 \" : to_be_filled CHARGE , ACY01 , \" HXT \" : to_be_filled CHARGE , ACY01 , \" H1 \" : to_be_filled CHARGE , ACY01 , \" H2 \" : to_be_filled CHARGE , ACY01 , \" H3 \" : to_be_filled CHARGE , ACY - 1 , \" C \" : to_be_filled CHARGE , ACY - 1 , \" O \" : to_be_filled CHARGE , ACY - 1 , \" OXT \" : to_be_filled CHARGE , ACY - 1 , \" CH3 \" : to_be_filled CHARGE , ACY - 1 , \" H1 \" : to_be_filled CHARGE , ACY - 1 , \" H2 \" : to_be_filled CHARGE , ACY - 1 , \" H3 \" : to_be_filled # Atom radius , dielelctric boundary radius , VDW radius , and energy well depth RADIUS , ACY01 , \" C \" : 1 . 700 , 2 . 000 , 0 . 150 RADIUS , ACY01 , \" O \" : 1 . 400 , 1 . 600 , 0 . 200 RADIUS , ACY01 , \" OXT \" : 1 . 400 , 1 . 600 , 0 . 200 RADIUS , ACY01 , \" CH3 \" : 1 . 700 , 2 . 000 , 0 . 150 RADIUS , ACY01 , \" HXT \" : 1 . 000 , 1 . 000 , 0 . 020 RADIUS , ACY01 , \" H1 \" : 1 . 000 , 1 . 000 , 0 . 020 RADIUS , ACY01 , \" H2 \" : 1 . 000 , 1 . 000 , 0 . 020 RADIUS , ACY01 , \" H3 \" : 1 . 000 , 1 . 000 , 0 . 020 RADIUS , ACY - 1 , \" C \" : 1 . 700 , 2 . 000 , 0 . 150 RADIUS , ACY - 1 , \" O \" : 1 . 400 , 1 . 600 , 0 . 200 RADIUS , ACY - 1 , \" OXT \" : 1 . 400 , 1 . 600 , 0 . 200 RADIUS , ACY - 1 , \" CH3 \" : 1 . 700 , 2 . 000 , 0 . 150 RADIUS , ACY - 1 , \" H1 \" : 1 . 000 , 1 . 000 , 0 . 020 RADIUS , ACY - 1 , \" H2 \" : 1 . 000 , 1 . 000 , 0 . 020 RADIUS , ACY - 1 , \" H3 \" : 1 . 000 , 1 . 000 , 0 . 020 # Conformer parameters that appear in head3 . lst : ne , Em0 , nH , pKa0 , rxn CONFORMER , ACY01 : Em0 = 0 . 0 , pKa0 = 0 . 00 , ne = 0 , nH = 0 , rxn02 = 0 , rxn04 = 0 , rxn08 = 0 CONFORMER , ACY - 1 : Em0 = 0 . 0 , pKa0 = 0 . 00 , ne = 0 , nH = 0 , rxn02 = 0 , rxn04 = 0 , rxn08 = 0","title":"Make ftpl files"},{"location":"newftpl/#calculate-charge","text":"Go to https://webchem.ncbr.muni.cz/Platform/ChargeCalculator Submit ACY_ideal.pdb, set total charge 0, and obtain the atomic charge results. Submit ACY_deprotonated.pdb, set total charge -1, and obtain the atomic charge results. Assign the charges to acy.ftpl file: take individual lines. # Conformer definition CONFLIST , ACY : ACYBK , ACY01 , ACY - 1 # ATOM name and bonds CONNECT , \" C \" , ACY01 : sp2 , \" O \" , \" OXT \" , \" CH3 \" CONNECT , \" O \" , ACY01 : sp3 , \" C \" CONNECT , \" OXT \" , ACY01 : sp2 , \" C \" , \" HXT \" CONNECT , \" CH3 \" , ACY01 : sp3 , \" C \" , \" H1 \" , \" H2 \" , \" H3 \" CONNECT , \" HXT \" , ACY01 : s , \" OXT \" CONNECT , \" H1 \" , ACY01 : s , \" CH3 \" CONNECT , \" H2 \" , ACY01 : s , \" CH3 \" CONNECT , \" H3 \" , ACY01 : s , \" CH3 \" CONNECT , \" C \" , ACY - 1 : sp2 , \" O \" , \" OXT \" , \" CH3 \" CONNECT , \" O \" , ACY - 1 : sp3 , \" C \" CONNECT , \" OXT \" , ACY - 1 : sp3 , \" C \" CONNECT , \" CH3 \" , ACY - 1 : sp3 , \" C \" , \" H1 \" , \" H2 \" , \" H3 \" CONNECT , \" H1 \" , ACY - 1 : s , \" CH3 \" CONNECT , \" H2 \" , ACY - 1 : s , \" CH3 \" CONNECT , \" H3 \" , ACY - 1 : s , \" CH3 \" # ATOM charges CHARGE , ACY01 , \" C \" : 0 . 680 CHARGE , ACY01 , \" O \" : - 0 . 590 CHARGE , ACY01 , \" OXT \" : - 0 . 774 CHARGE , ACY01 , \" CH3 \" : - 0 . 606 CHARGE , ACY01 , \" HXT \" : 0 . 433 CHARGE , ACY01 , \" H1 \" : 0 . 283 CHARGE , ACY01 , \" H2 \" : 0 . 287 CHARGE , ACY01 , \" H3 \" : 0 . 287 CHARGE , ACY - 1 , \" C \" : 0 . 577 CHARGE , ACY - 1 , \" O \" : - 0 . 768 CHARGE , ACY - 1 , \" OXT \" : - 0 . 699 CHARGE , ACY - 1 , \" CH3 \" : - 0 . 714 CHARGE , ACY - 1 , \" H1 \" : 0 . 198 CHARGE , ACY - 1 , \" H2 \" : 0 . 202 CHARGE , ACY - 1 , \" H3 \" : 0 . 204 # Atom radius , dielelctric boundary radius , VDW radius , and energy well depth RADIUS , ACY01 , \" C \" : 1 . 700 , 2 . 000 , 0 . 150 RADIUS , ACY01 , \" O \" : 1 . 400 , 1 . 600 , 0 . 200 RADIUS , ACY01 , \" OXT \" : 1 . 400 , 1 . 600 , 0 . 200 RADIUS , ACY01 , \" CH3 \" : 1 . 700 , 2 . 000 , 0 . 150 RADIUS , ACY01 , \" HXT \" : 1 . 000 , 1 . 000 , 0 . 020 RADIUS , ACY01 , \" H1 \" : 1 . 000 , 1 . 000 , 0 . 020 RADIUS , ACY01 , \" H2 \" : 1 . 000 , 1 . 000 , 0 . 020 RADIUS , ACY01 , \" H3 \" : 1 . 000 , 1 . 000 , 0 . 020 RADIUS , ACY - 1 , \" C \" : 1 . 700 , 2 . 000 , 0 . 150 RADIUS , ACY - 1 , \" O \" : 1 . 400 , 1 . 600 , 0 . 200 RADIUS , ACY - 1 , \" OXT \" : 1 . 400 , 1 . 600 , 0 . 200 RADIUS , ACY - 1 , \" CH3 \" : 1 . 700 , 2 . 000 , 0 . 150 RADIUS , ACY - 1 , \" H1 \" : 1 . 000 , 1 . 000 , 0 . 020 RADIUS , ACY - 1 , \" H2 \" : 1 . 000 , 1 . 000 , 0 . 020 RADIUS , ACY - 1 , \" H3 \" : 1 . 000 , 1 . 000 , 0 . 020 # Conformer parameters that appear in head3 . lst : ne , Em0 , nH , pKa0 , rxn CONFORMER , ACY01 : Em0 = 0 . 0 , pKa0 = 0 . 00 , ne = 0 , nH = 0 , rxn02 = 0 , rxn04 = 0 , rxn08 = 0 CONFORMER , ACY - 1 : Em0 = 0 . 0 , pKa0 = 0 . 00 , ne = 0 , nH = 0 , rxn02 = 0 , rxn04 = 0 , rxn08 = 0","title":"Calculate charge"},{"location":"newftpl/#install-ftpl-file","text":"Find the param/ location which mcce / home / jmao / projects / Stable - MCCE / bin / mcce Copy ftpl file to param/ cp acy . ftpl / home / jmao / projects / Stable - MCCE / param","title":"Install ftpl file"},{"location":"newftpl/#reaction-field-energy","text":"Run step 1 to 3: step1 . py --noter ACY_ideal.pdb step2 . py step3 . py - d 2 cat head3 . lst iConf CONFORMER FL occ crg Em0 pKa0 ne nH vdw0 vdw1 tors epol dsolv extra history 00001 ACY01A0001_001 f 0 . 00 0 . 000 0 0 . 00 0 0 0 . 497 0 . 000 0 . 000 0 . 000 - 11 . 413 0 . 000 01 O000M000 t 00002 ACY - 1 A0001_002 f 0 . 00 - 1 . 000 0 0 . 00 0 0 0 . 180 0 . 000 0 . 000 0 . 000 - 47 . 119 0 . 000 - 1 O000M000 t step3 . py - d 4 iConf CONFORMER FL occ crg Em0 pKa0 ne nH vdw0 vdw1 tors epol dsolv extra history 00001 ACY01A0001_001 f 0 . 00 0 . 000 0 0 . 00 0 0 0 . 497 0 . 000 0 . 000 0 . 000 - 5 . 495 0 . 000 01 O000M000 t 00002 ACY - 1 A0001_002 f 0 . 00 - 1 . 000 0 0 . 00 0 0 0 . 180 0 . 000 0 . 000 0 . 000 - 22 . 902 0 . 000 - 1 O000M000 t step3 . py - d 8 iConf CONFORMER FL occ crg Em0 pKa0 ne nH vdw0 vdw1 tors epol dsolv extra history 00001 ACY01A0001_001 f 0 . 00 0 . 000 0 0 . 00 0 0 0 . 497 0 . 000 0 . 000 0 . 000 - 2 . 548 0 . 000 01 O000M000 t 00002 ACY - 1 A0001_002 f 0 . 00 - 1 . 000 0 0 . 00 0 0 0 . 180 0 . 000 0 . 000 0 . 000 - 10 . 801 0 . 000 - 1 O000M000 t Put the values back in /path/to/param/acy.ftpl, set nH=-1 because this conformer loses a proton, and set pKa0 =4.75 as this is acetic acid pKa. # Conformer parameters that appear in head3 . lst : ne , Em0 , nH , pKa0 , rxn CONFORMER , ACY01 : Em0 = 0 . 0 , pKa0 = 0 . 00 , ne = 0 , nH = 0 , rxn02 = - 11 . 413 , rxn04 = - 5 . 495 , rxn08 = - 2 . 548 CONFORMER , ACY - 1 : Em0 = 0 . 0 , pKa0 = 4 . 75 , ne = 0 , nH =- 1 , rxn02 = - 47 . 119 , rxn04 = - 22 . 902 , rxn08 = - 10 . 801","title":"Reaction field energy"},{"location":"pkaexample/","text":"Calculate pKas of Lysozyme \u00b6 Page last updated on: 2020-02-06 Background \u00b6 Lysozyme is a small enzyme that dissolves bacterial cell walls thus kills bacteria. It was discovered as the first antibiotic to inhibit bacteria growth in food, before penicillin. Crystal structure of hen egg white lysozyme - PDB ID 3WUM The residue GLU 35 and ASP 52 have been identified as two active sites. The pKas of these two residues play an important role in the enzyme's activity. In order for lysozyme to attack the glucose molecule of the substrate, GLU has high pKa and ASP 52 has low pKa. This way GLU 35 acts a proton donor, cuts the glucose with protonation of the glycosidic oxygen and a deprotonated GLU 52 stabilizes the highly charged intermediate, making the reaction easier. Jens Erik Nielsen and J. Andrew McCammon, Protein Sci. 2003 Sep; 12(9): 1894\u20131901 Prepare the calculation \u00b6 After the program is installed and execution path is configured (see link for details), make a working directory and go to the working directory. MCCE will generate intermediate files and result files in the current directory, so it's best to prepare one directory for calculation on one structure. mkdir 4 lzt cd 4 lzt Then download pdb file 4LZT to the working directory: jmao @jmao - desktop ~/ 4 lzt $ getpdb 4 lzt Inquiring the remote file 4 LZT . pdb ... Saving as 4 LZT . pdb ... Download completed . Configure run.prm for MCCE \u00b6 MCCE requires a file run.prm to guide the run. cp { / path / to / mcce / } run . prm . quick . / run . prm { / path / to / mcce / } is the path to the MCCE installation directory. The file run.prm defines how MCCE runs. If the line ends up with a keyword enclosed in a pair of parenthesis, this line is a definition line, with the key being the word in parenthesis and the value being the the first word of this line. The most modified entries \u00b6 ============================================================================== Most modified entries ------------------------------------------------------------------------------ Input and Output : prot . pdb ( INPDB ) Steps : f step 1 : pre - run , pdb -> mcce pdb ( DO_PREMCCE ) f step 2 : make rotatmers ( DO_ROTAMERS ) f step 3 : do energy calculations ( DO_ENERGY ) f step 4 : monte carlo sampling ( DO_MONTE ) f step 6 : Hydrogen bond analysis ( DO_ANALYSIS ) ============================================================================== This line defines the input structure file: prot . pdb ( INPDB ) It's a good idea to keep the downloaded pdb file 3WUM.pdb, so we make a copy named prot.pdb: cp 4 LZT . pdb prot . pdb Since we are calculating pKas, we need to run from step 1 to 4. Mark these steps \"t\" for \"true\". t step 1 : pre - run , pdb -> mcce pdb ( DO_PREMCCE ) t step 2 : make rotatmers ( DO_ROTAMERS ) t step 3 : do energy calculations ( DO_ENERGY ) t step 4 : monte carlo sampling ( DO_MONTE ) The less modified entries \u00b6 This section is usually modified only for the first run. It defines the location of the parameters and titration conditions. 8 . 0 Protein dielectric constant for DelPhi ( EPSILON_PROT ) / home / jmao / projects / Stable - MCCE / extra . tpl ( EXTRA ) / home / jmao / projects / Stable - MCCE / name . txt MCCE renaming rule . ( RENAME_RULES ) ph \" ph \" for pH titration , \" eh \" for eh titration ( TITR_TYPE ) 0 . 0 Initial pH ( TITR_PH0 ) 1 . 0 pH interval ( TITR_PHD ) 0 . 0 Initial Eh ( TITR_EH0 ) 30 . 0 Eh interval ( in mV ) ( TITR_EHD ) 15 Number of titration points ( TITR_STEPS ) .. In the above example, I set the dielectric constant 8.0, which is good for pKa calculation. The path to extra.tpl and name.txt is set to my mcce installation directory. the titration type is set to be \"ph\" the titration range from 0 to 14 at step 1, 15 titration points in total The advanced entries \u00b6 Some entries here have to be customized for your installation and system. / home / jmao / projects / Stable - MCCE ( MCCE_HOME ) This should point to where your mcce is installed. / home / jmao / projects / Stable - MCCE / bin / delphi DelPhi executable ( DELPHI_EXE ) This points to The location of delphi executable. / tmp delphi temporary file folder , \"/tmp\" uses node ( PBE_FOLDER ) For some systems, /tmp is preferred temporary directory. Run mcce \u00b6 Make sure mcce is in your executable path. For me, I run export PATH =/ home / jmao / projects / Stable - MCCE / bin : $ PATH To set the PATH variable. To run mcce mcce Ths program takes 30 minutes to 1 hour to finish. So you can run mcce > run . log & to put the program in background. Results \u00b6 The pKa report is in file pK.out. cat pK . out From the result, GLU 35 has a higher pKa than ASP 52. To analyze the ionization energy of an ionizable residue at ph 5: mfe . py ASP - A0052_ 5 at ph 7: mfe . py ASP - A0052_ 7","title":"pKa calculation"},{"location":"pkaexample/#calculate-pkas-of-lysozyme","text":"Page last updated on: 2020-02-06","title":"Calculate pKas of Lysozyme"},{"location":"pkaexample/#background","text":"Lysozyme is a small enzyme that dissolves bacterial cell walls thus kills bacteria. It was discovered as the first antibiotic to inhibit bacteria growth in food, before penicillin. Crystal structure of hen egg white lysozyme - PDB ID 3WUM The residue GLU 35 and ASP 52 have been identified as two active sites. The pKas of these two residues play an important role in the enzyme's activity. In order for lysozyme to attack the glucose molecule of the substrate, GLU has high pKa and ASP 52 has low pKa. This way GLU 35 acts a proton donor, cuts the glucose with protonation of the glycosidic oxygen and a deprotonated GLU 52 stabilizes the highly charged intermediate, making the reaction easier. Jens Erik Nielsen and J. Andrew McCammon, Protein Sci. 2003 Sep; 12(9): 1894\u20131901","title":"Background"},{"location":"pkaexample/#prepare-the-calculation","text":"After the program is installed and execution path is configured (see link for details), make a working directory and go to the working directory. MCCE will generate intermediate files and result files in the current directory, so it's best to prepare one directory for calculation on one structure. mkdir 4 lzt cd 4 lzt Then download pdb file 4LZT to the working directory: jmao @jmao - desktop ~/ 4 lzt $ getpdb 4 lzt Inquiring the remote file 4 LZT . pdb ... Saving as 4 LZT . pdb ... Download completed .","title":"Prepare the calculation"},{"location":"pkaexample/#configure-runprm-for-mcce","text":"MCCE requires a file run.prm to guide the run. cp { / path / to / mcce / } run . prm . quick . / run . prm { / path / to / mcce / } is the path to the MCCE installation directory. The file run.prm defines how MCCE runs. If the line ends up with a keyword enclosed in a pair of parenthesis, this line is a definition line, with the key being the word in parenthesis and the value being the the first word of this line.","title":"Configure run.prm for MCCE"},{"location":"pkaexample/#the-most-modified-entries","text":"============================================================================== Most modified entries ------------------------------------------------------------------------------ Input and Output : prot . pdb ( INPDB ) Steps : f step 1 : pre - run , pdb -> mcce pdb ( DO_PREMCCE ) f step 2 : make rotatmers ( DO_ROTAMERS ) f step 3 : do energy calculations ( DO_ENERGY ) f step 4 : monte carlo sampling ( DO_MONTE ) f step 6 : Hydrogen bond analysis ( DO_ANALYSIS ) ============================================================================== This line defines the input structure file: prot . pdb ( INPDB ) It's a good idea to keep the downloaded pdb file 3WUM.pdb, so we make a copy named prot.pdb: cp 4 LZT . pdb prot . pdb Since we are calculating pKas, we need to run from step 1 to 4. Mark these steps \"t\" for \"true\". t step 1 : pre - run , pdb -> mcce pdb ( DO_PREMCCE ) t step 2 : make rotatmers ( DO_ROTAMERS ) t step 3 : do energy calculations ( DO_ENERGY ) t step 4 : monte carlo sampling ( DO_MONTE )","title":"The most modified entries"},{"location":"pkaexample/#the-less-modified-entries","text":"This section is usually modified only for the first run. It defines the location of the parameters and titration conditions. 8 . 0 Protein dielectric constant for DelPhi ( EPSILON_PROT ) / home / jmao / projects / Stable - MCCE / extra . tpl ( EXTRA ) / home / jmao / projects / Stable - MCCE / name . txt MCCE renaming rule . ( RENAME_RULES ) ph \" ph \" for pH titration , \" eh \" for eh titration ( TITR_TYPE ) 0 . 0 Initial pH ( TITR_PH0 ) 1 . 0 pH interval ( TITR_PHD ) 0 . 0 Initial Eh ( TITR_EH0 ) 30 . 0 Eh interval ( in mV ) ( TITR_EHD ) 15 Number of titration points ( TITR_STEPS ) .. In the above example, I set the dielectric constant 8.0, which is good for pKa calculation. The path to extra.tpl and name.txt is set to my mcce installation directory. the titration type is set to be \"ph\" the titration range from 0 to 14 at step 1, 15 titration points in total","title":"The less modified entries"},{"location":"pkaexample/#the-advanced-entries","text":"Some entries here have to be customized for your installation and system. / home / jmao / projects / Stable - MCCE ( MCCE_HOME ) This should point to where your mcce is installed. / home / jmao / projects / Stable - MCCE / bin / delphi DelPhi executable ( DELPHI_EXE ) This points to The location of delphi executable. / tmp delphi temporary file folder , \"/tmp\" uses node ( PBE_FOLDER ) For some systems, /tmp is preferred temporary directory.","title":"The advanced entries"},{"location":"pkaexample/#run-mcce","text":"Make sure mcce is in your executable path. For me, I run export PATH =/ home / jmao / projects / Stable - MCCE / bin : $ PATH To set the PATH variable. To run mcce mcce Ths program takes 30 minutes to 1 hour to finish. So you can run mcce > run . log & to put the program in background.","title":"Run mcce"},{"location":"pkaexample/#results","text":"The pKa report is in file pK.out. cat pK . out From the result, GLU 35 has a higher pKa than ASP 52. To analyze the ionization energy of an ionizable residue at ph 5: mfe . py ASP - A0052_ 5 at ph 7: mfe . py ASP - A0052_ 7","title":"Results"},{"location":"quick/","text":"MCCE quick start \u00b6 Page last updated on: 2020-05-03 Get the code \u00b6 To download the latest code: \u00b6 Under a terminal window, run: git clone https : // github . com / GunnerLab / Stable - MCCE . git Compile the code: \u00b6 This creates a directory Stable-MCCE, enter the directory and compile: cd Stable - MCCE make clean make Find the path of Stable-MCCE installation directory: ( base ) jmao @pc : ~/ projects / Stable - MCCE $ pwd / home / jmao / projects / Stable - MCCE In my case the {/path/to/mcce/} is /home/jmao/projects/Stable-MCCE Add the executable to your path: export PATH = { / path / to / mcce / } bin : $ PATH Also put this line at the end of .bashrc file under your home directory so that the environment is properly set everytime you open a terminal window. Troubleshooting: On Mac OS X, an explicit memory free for tree is not supported. You may have to change this subroutine in file lib/db.c /* release database memory */ void free_param () { tdestroy ( param_root , free ); return ; } to /* release database memory */ void free_param () { return ; } Run MCCE is simplest way \u00b6 Prepare a working directory: \u00b6 mkdir test_lysozyme cd test_lysozyme Get a pdb file \u00b6 getpdb 1 dpx You now have a pdb file 1DPX.pdb in the working directory. The simplest way to run mcce is do these four steps: Step 1 convert PDB file into MCCE PDB \u00b6 This step proof reads the structure file and cut terminal residues and complex cofactors into smaller ones if necessary. step1 . py 1 DPX . pdb Step 2 make side chain conformers \u00b6 This step makes alternative side chain locations and ionization states. step2 . py Step 3 make energy table \u00b6 This step calculates conformer self energy and pairwise interaction table. step3 . py Step 4 Simulate a titration with Monte Carlo sampling \u00b6 This setp simulates a titration and write out the conformation and ionization states of each side chain at various conditions. step4 . py Notes \u00b6 For more detailed command usages, use \"-h\" switch in each command above. Some steps take hours to finish, so it is recommended to run at the background. For example step3 . py > run . log &","title":"Quick Start"},{"location":"quick/#mcce-quick-start","text":"Page last updated on: 2020-05-03","title":"MCCE quick start"},{"location":"quick/#get-the-code","text":"","title":"Get the code"},{"location":"quick/#to-download-the-latest-code","text":"Under a terminal window, run: git clone https : // github . com / GunnerLab / Stable - MCCE . git","title":"To download the latest code:"},{"location":"quick/#compile-the-code","text":"This creates a directory Stable-MCCE, enter the directory and compile: cd Stable - MCCE make clean make Find the path of Stable-MCCE installation directory: ( base ) jmao @pc : ~/ projects / Stable - MCCE $ pwd / home / jmao / projects / Stable - MCCE In my case the {/path/to/mcce/} is /home/jmao/projects/Stable-MCCE Add the executable to your path: export PATH = { / path / to / mcce / } bin : $ PATH Also put this line at the end of .bashrc file under your home directory so that the environment is properly set everytime you open a terminal window. Troubleshooting: On Mac OS X, an explicit memory free for tree is not supported. You may have to change this subroutine in file lib/db.c /* release database memory */ void free_param () { tdestroy ( param_root , free ); return ; } to /* release database memory */ void free_param () { return ; }","title":"Compile the code:"},{"location":"quick/#run-mcce-is-simplest-way","text":"","title":"Run MCCE is simplest way"},{"location":"quick/#prepare-a-working-directory","text":"mkdir test_lysozyme cd test_lysozyme","title":"Prepare a working directory:"},{"location":"quick/#get-a-pdb-file","text":"getpdb 1 dpx You now have a pdb file 1DPX.pdb in the working directory. The simplest way to run mcce is do these four steps:","title":"Get a pdb file"},{"location":"quick/#step-1-convert-pdb-file-into-mcce-pdb","text":"This step proof reads the structure file and cut terminal residues and complex cofactors into smaller ones if necessary. step1 . py 1 DPX . pdb","title":"Step 1 convert PDB file into MCCE PDB"},{"location":"quick/#step-2-make-side-chain-conformers","text":"This step makes alternative side chain locations and ionization states. step2 . py","title":"Step 2 make side chain conformers"},{"location":"quick/#step-3-make-energy-table","text":"This step calculates conformer self energy and pairwise interaction table. step3 . py","title":"Step 3 make energy table"},{"location":"quick/#step-4-simulate-a-titration-with-monte-carlo-sampling","text":"This setp simulates a titration and write out the conformation and ionization states of each side chain at various conditions. step4 . py","title":"Step 4 Simulate a titration with Monte Carlo sampling"},{"location":"quick/#notes","text":"For more detailed command usages, use \"-h\" switch in each command above. Some steps take hours to finish, so it is recommended to run at the background. For example step3 . py > run . log &","title":"Notes"},{"location":"runprm/","text":"How to customize run.prm, the run configuration file? \u00b6 Page last updated on: 2020-05-19 The mcce program reads file run.prm from the working directory and runs according to its instructions. The two ways that run mcce are: customize run.prm and call mcce directly run step1.py, step2.py, step3.py, are step4.py as wrappers of mcce. run.prm format \u00b6 The valid parameters are defined as a key-value pair, defined by a line. At the end of the line, the key string word is enclosed in a pair of parenthesis. The key string must be one word. If a key is detected from a line, the first word of the line is its value. For example: f step 1 : pre - run , pdb -> mcce pdb ( DO_PREMCCE ) The key is \"DO_MCCE\" and the value is \"f\". Lines other than parameter lines are considered as comment lines, therefore ignored. Most commonly edited entries \u00b6 Input and output \u00b6 prot . pdb ( INPDB ) Th parameter \"INPDB\" specifies a pdb file as the initial input structure. Major mcce steps \u00b6 MCCE can be divided into four steps. The steps have keys: DO_PREMCCE DO_ROTAMERS DO_ENERGY DO_MONTE The value 't' is for true (do), and 'f' is for false (not do). Steps : f step 1 : pre - run , pdb -> mcce pdb ( DO_PREMCCE ) f step 2 : make rotatmers ( DO_ROTAMERS ) f step 3 : do energy calculations ( DO_ENERGY ) f step 4 : monte carlo sampling ( DO_MONTE ) The later step depends on the out put of previous step. Less edited entries \u00b6 Step 2 and step 4 have more flexibility and are customized more often than others. General \u00b6 4 . 0 Protein dielectric constant for DelPhi ( EPSILON_PROT ) Dielectric constant of protein. Usually epsilon 8 is used for small soluble protein (~100 residues), and 4 is used for big trans-membrane protein (> 200 residues). This value is used by step 2 to optimize rotamers and step 3 to compute energy table. / home / mcce / Stable - MCCE / extra . tpl ( EXTRA ) This file contains entries that overwrite those defined in ftpl and tpl files in param/ directory, and extral controls over the program. The extra controls are in two categories: offset energy of ionizable residues. These energy corrects the residue solution pKa values based on previous benchmarks. The scaling factor of van der Walls energy term. The recommended values are the inverse of dielectric constant defined by EPSILON_PROT. / home / mcce / Stable - MCCE / name . txt MCCE renaming rule . ( RENAME_RULES ) The renaming rule can divide a big group into separate ionizable groups. put ligands and cofactor as one group. This is done by renaming the atom and residue. Step 2, Rotamer making \u00b6 f Use control file \" head1.lst \" for rotamer making ( ROT_SPECIF ) This file enables site specific rotamer making rules. When set as \"t\", it overwrites the rules defined by run.prm. t Do swap ( stereo isotope ) ( ROT_SWAP ) Make stereo isotope conformers for residues like GLN and ASN. t Do rotate ? ( PACK ) Rotate around rotatable bonds? 6 number of rotamers in a bond rotation ( ROTATIONS ) Number of rotamers in a bond rotation. Step 4, Monte Carlo sampling \u00b6 ph \" ph \" for pH titration , \" eh \" for eh titration ( TITR_TYPE ) The type of simulation, pH or Eh. 0 . 0 Initial pH ( TITR_PH0 ) The starting pH, or the pH of Eh titration. 1 . 0 pH interval ( TITR_PHD ) The interval of pH titration 0 . 0 Initial Eh ( TITR_EH0 ) The starting Eh, or the Eh of pH titration. 30 . 0 Eh interval ( in mV ) ( TITR_EHD ) The interval of Eh titration. 15 Number of titration points ( TITR_STEPS ) Number of titration points. f Output Microstate from standard monte carlo ( MS_OUT ) f Output readable micristate file from standard monte carlo ( RE_MS_OUT ) Write out microstates or not. System specific entries \u00b6 These entries are tailored to the system and installation. System and installation location \u00b6 / home / mcce / Stable - MCCE ( MCCE_HOME ) The MCCE installation root. It is required by the program to find relevant parameters. / home / mcce / Stable - MCCE / bin / delphi DelPhi executable ( DELPHI_EXE ) PB solver delphi location. / tmp delphi temporary file folder , \"/tmp\" uses node ( PBE_FOLDER ) Location of PB solver output. This should be a folder with write permission and large enough Sometimes to store GBs of files. new . tpl local parameter file for unrecognized res ( NEWTPL ) Program mcce creates a temporary tpl file whenever it couldn't solve a new cofactor. The presumed parameters are in this file. debug . log ( DEBUG_LOG ) Debug log file name. Detail levels of program output \u00b6 t Minimize output files ( MINIMIZE_SIZE ) If this is \"f\", mcce will write more debug information. t Print trace file ( DO_TRACE ) Creates a record with MCCE revision number, time and date of run, and all user options set in run.prm and appends it to (or creates) the run.trace file. t clean up delphi focusing directory ? ( DELPHI_CLEAN ) Flag of cleaning delphi temporary folder. Set to 't' only for debugging purpose. Other entries \u00b6 Step 1 \u00b6 t Label terminal residues ? ( TERMINALS ) If this flag is on 't', mcce program will identify the C terminus and N terminus of the polypeteides based on the geometry. Terminal residues have extra ionizable sites than residues having peptide bonds. One needs to be careful if there are missing piece of peptide in the given structure. 0 . 1 cut off water if % SAS exceeds this number ( H2O_SASCUTOFF ) The water molecules are stripped of if the surface exposure is over this cutoff. This a recursive procedure which means after some waters are removed, the new surface exposure is recaculated and the process id repeated. 2 . 0 distance limit of reporting clashes ( CLASH_DISTANCE ) The threshold to report abnormal distance found between non-bonded atoms. t ignore hydrogens in input structure ( IGNORE_INPUT_H ) Delete and rebuild input H atoms in step 1 and step 2. Step 2: \u00b6 t Rebuild sidechain based on torsion minima ( REBUILD_SC ) Rebuild side chain. f Do swing ? ( SWING ) Swing conformers deviate from their parent conformer by a small degree. 10 . 0 phi in degrees of swing ( PHI_SWING ) Swing angle. 1 . 00 SAS cuttoff of making fewer rotamers ( SAS_CUTOFF ) Surface residues get fewer rotamers. There is another mechanism to search the most exposed rotamer to compensate this. 10 . 0 Cutoff of self vdw in kcal / mol ( VDW_CUTOFF ) If a rotamer has self energy, comparing with the most favorable one, over this cutoff, it will not ne kept. 5000 number of repacks ( REPACKS ) The rotamer optimization starts from random initial state, then minimizes the energy on each side chain. The number of restarts of this process is rapacks. 0 . 03 occupancy cutoff of repacks ( REPACK_CUTOFF ) The occupancy of side chain conformer lower than this value will not be kept. t h - bond directed rotamer making ( HDIRECTED ) Do search on hydrogen bond. 1 . 0 threshold for two conformers being different ( HDIRDIFF ) Only one of the similar conformers is kept. Similarity os measured by Root Mean Square Deviation. 36 Limit number of the H bond conformers ( HDIRLIMT ) The number limit on H bond directed conformers. f Do relaxation on water ( RELAX_WAT ) Move water molecules to relax the distance crash. 3 . 2 if distance between water and heavy atom is smaller than this , move water away ( WATER_RELAX_THR ) The threshold of moving water. 10 number of cycles to relax rotamer clash ( HV_RELAX_NCYCLE ) Heavy atom rotamer relaxation by MD. Number of global restarts (cycles). 10 time ( in fs ) for each relaxation iteration ( HV_RELAX_DT ) Heavy atom rotamer relaxation time. 10 number of iterations ( HV_RELAX_NITER ) Number of local restarts. 2 . relax rotamer if vdw interaction is bigger than this ( HV_RELAX_VDW_THR ) Lower end threshold of relaxing rotamers, Van der Waals energy value in kcal/mol. 5 . not relax rotamer if heavy atom vdw is bigger than this ( HV_RELAX_HV_VDW_THR ) High end threshold of relaxing rotamers, Van der Waals energy value in kcal/mol. - 1 . 0 relax if electrostatic interaction is more favorable than this , and the charged groups are close ( HV_RELAX_ELEC_THR ) Relax heavy atoms when they show dominantly favorable electrostatic interaction. 0 . 1 threshold used to define a charged atom , see hv_relax_elec_dist_thr ( HV_RELAX_ELEC_CRG_THR ) Atoms with charge over this value are considered charged atoms. 3 . 0 only relax electrostatically favorable pairs that has charged atom distance shorter than this ( HV_RELAX_ELEC_DIST_THR ) Relax heavy atoms when they show close proximity. 20 . scaling factor for torsion during relaxation ( HV_TORS_SCALE ) Scaling factor for torsion energy when searching torsion minima. 10000 maximun n steps of shake ( HV_RELAX_N_SHAKE ) MD shake parameter. 0 . 001 maximun allowance for bond length to deviate ( HV_RELAX_SHAKE_TOL ) MD bond length detaion parameter. 1 . 0 constraint distance ( HV_RELAX_CONSTRAINT ) MD atom constrain distance. 20 . constraint force for atom stay in original position ( HV_RELAX_CONSTRAINT_FRC ) MD atom constraint force. f include neighbors when doing relaxation ( expensive ) ( HV_RELAX_INCLUDE_NGH ) Include neighbor in MD relaxation. 4 . 0 threshold for include as a neighbor during relaxation ( HV_RELAX_NGH_THR ) Define a neighboring side chain. t Do relaxation on hydrogens ( RELAX_H ) Optimize hydrogen position. - 5 . 0 Energy threshold for keeping the conformer ( RELAX_E_THR ) 200 Loop over N local microstates ( RELAX_NSTATES ) 6 default number of hydroxyl positions ( RELAX_N_HYD ) 5 . do not relax hydrogen if vdw bwt two sidechain conformer bigger than this ( RELAX_CLASH_THR ) 1 . 0 phi for each step of relaxation ( RELAX_PHI ) 300 Maximum number of steps of relaxation ( RELAX_NITER ) 0 . 5 Torque threshold for keep relaxing ( RELAX_TORQ_THR ) These parameters are for MD relaxation. 0 . 02 Last pruning threshold for conformers ( PRUNE_THR ) 0 . 5 Pruning cutoff of RMSD ( PRUNE_RMSD ) 1 . 0 Pruning cutoff of eletrostatic pairwise ( PRUNE_ELE ) 8 . 0 Pruning cutoff of vdw pairwise ( PRUNE_VDW ) To reduce the number of final conformers, similar conformers are grouped into one. The similarity is defined by these parameters. 0 maximum number of conformer per residue ( 0 = unlimited ) ( NCONF_LIMIT ) Set a limit to final conformers of a residue. step 3: \u00b6 f Use SAS + Coulomb ' s law for ele interaction (QUICK_ENERGIES) Use coulomb's law instead of solving PB equation. 80 . 0 Solvent dielectric constant for DelPhi ( EPSILON_SOLV ) 65 Grids in each DelPhi ( GRIDS_DELPHI ) 2 . 0 The target grids per angstrom for DelPhi ( GRIDS_PER_ANG ) 1 . 4 Radius of the probe ( RADIUS_PROBE ) 2 . 0 Ion radius ( IONRAD ) 0 . 15 Salt ( SALT ) PB solver parameters. f skip delphi in step3 ( DEBUG option ) ( SKIP_ELE ) This is a debug option. f Reassign charge and radii before delphi ( if not true then use value in PDB file ) ( REASSIGN ) Step 3 uses atom charges from step2_out.pdb. Use this to overwrite. f Recalculate torsions energy when write out head3 . lst ( RECALC_TORS ) Recalculate torsion energy. 1 . 7 defalut van der Waals radius , for SAS ( DEFAULT_RADIUS ) 0 . 5 factor to 1 - 4 LJ potontial ( 1 . 0 is full ) ( FACTOR_14LJ ) 6 . 0 dielectric constant for Coulomb ' s law (EPSILON_COULOMB) More parameters used by the prigram in step 1, 2 and 3. 1 delphi start conformer number , 0 based ( PBE_START ) 99999 delphi end conformer number , self included ( PBE_END ) Start and end of PB solution on conformers. step 4: \u00b6 f Average the pairwise , \"f\" uses the smaller ( AVERAGE_PAIRWISE ) When loading energy from step 3, average the pairwise interaction. 20 . Warning Threshold of difference in pairwise ( WARN_PAIRWISE ) Issue a warning message if asymmetric pairwise interaction is detected. 5 . 0 Big pairwise threshold to make big list ( BIG_PAIRWISE ) Residues with big interactions may get synchronized flips. This is the cut off value. - 1 Random seed , - 1 uses time as random seed ( MONTE_SEED ) Random seed. 298 . 15 Temperature ( MONTE_T ) 3 Number of flips ( MONTE_FLIPS ) 100 Annealing = n_start * confs ( MONTE_NSTART ) 500 Equalibration = n_eq * confs ( MONTE_NEQ ) 0 . 001 Cut - off occupancy of the reduction ( MONTE_REDUCE ) Monte Carlo simulation parameters. ### Only for Junjun ' s monte carlo 2 Number of independent monte carlo sampling ( MONTE_RUNS ) 2000 Sampling = n_iter * confs ( MONTE_NITER ) 20000 Trace energy each MONTE_TRACE steps , 0 no trace ( MONTE_TRACE ) 1000000 Maximum microstates for analytical solution ( NSTATE_MAX ) f Specify mfe point , f = pKa / Em ( MFE_POINT ) - 1 . 0 MFE cutoff ( Kcal ) , default 0 . 5 ( MFE_CUTOFF ) More Monte Carlo simulation parameters. ### Only for Yifan ' s monte carlo t Using Yifan ' s monte carlo (MONTE_ADV_OPT) f Using format from old version ( MONTE_OLD_INPUT ) 5000 Min Sampling = n_iter * confs ( MONTE_NITER_MIN ) - 1 Max Sampling = n_iter * confs ( - 1 stop @ converge ) ( MONTE_NITER_MAX ) 10000 Number of iterations each cycle ( MONTE_NITER_CYCLE ) 1000 niter * n_conf check convergence ( MONTE_NITER_CHK ) - 1 Number of the reduce steps ( - 1 stop @ converge ) ( MONTE_N_REDUCE ) 0 . 01 Threshhold for convergence ( MONTE_CONVERGE ) f Calculate free energy ( MONTE_DO_ENERGY ) 298 . 15 Starting temperature for annealling ( ANNEAL_TEMP_START ) 0 Number of steps of annealling ( ANNEAL_NSTEP ) 1000 Number of iterations for each annealling step ( ANNEAL_NITER_STEP ) More Monte Carlo simulation parameters. IPECE parameters \u00b6 f add neutral atoms to simulate a membrane slab ( IPECE_ADD_ME ) 33 . the thichness of the membrane to be add ( IPECE_MEM_THICKNESS ) M the chain ID of the add atoms ( IPECE_MEM_CHAINID ) This is for creating a simulated membrane.","title":"Customize run.prm"},{"location":"runprm/#how-to-customize-runprm-the-run-configuration-file","text":"Page last updated on: 2020-05-19 The mcce program reads file run.prm from the working directory and runs according to its instructions. The two ways that run mcce are: customize run.prm and call mcce directly run step1.py, step2.py, step3.py, are step4.py as wrappers of mcce.","title":"How to customize run.prm, the run configuration file?"},{"location":"runprm/#runprm-format","text":"The valid parameters are defined as a key-value pair, defined by a line. At the end of the line, the key string word is enclosed in a pair of parenthesis. The key string must be one word. If a key is detected from a line, the first word of the line is its value. For example: f step 1 : pre - run , pdb -> mcce pdb ( DO_PREMCCE ) The key is \"DO_MCCE\" and the value is \"f\". Lines other than parameter lines are considered as comment lines, therefore ignored.","title":"run.prm format"},{"location":"runprm/#most-commonly-edited-entries","text":"","title":"Most commonly edited entries"},{"location":"runprm/#input-and-output","text":"prot . pdb ( INPDB ) Th parameter \"INPDB\" specifies a pdb file as the initial input structure.","title":"Input and output"},{"location":"runprm/#major-mcce-steps","text":"MCCE can be divided into four steps. The steps have keys: DO_PREMCCE DO_ROTAMERS DO_ENERGY DO_MONTE The value 't' is for true (do), and 'f' is for false (not do). Steps : f step 1 : pre - run , pdb -> mcce pdb ( DO_PREMCCE ) f step 2 : make rotatmers ( DO_ROTAMERS ) f step 3 : do energy calculations ( DO_ENERGY ) f step 4 : monte carlo sampling ( DO_MONTE ) The later step depends on the out put of previous step.","title":"Major mcce steps"},{"location":"runprm/#less-edited-entries","text":"Step 2 and step 4 have more flexibility and are customized more often than others.","title":"Less edited entries"},{"location":"runprm/#general","text":"4 . 0 Protein dielectric constant for DelPhi ( EPSILON_PROT ) Dielectric constant of protein. Usually epsilon 8 is used for small soluble protein (~100 residues), and 4 is used for big trans-membrane protein (> 200 residues). This value is used by step 2 to optimize rotamers and step 3 to compute energy table. / home / mcce / Stable - MCCE / extra . tpl ( EXTRA ) This file contains entries that overwrite those defined in ftpl and tpl files in param/ directory, and extral controls over the program. The extra controls are in two categories: offset energy of ionizable residues. These energy corrects the residue solution pKa values based on previous benchmarks. The scaling factor of van der Walls energy term. The recommended values are the inverse of dielectric constant defined by EPSILON_PROT. / home / mcce / Stable - MCCE / name . txt MCCE renaming rule . ( RENAME_RULES ) The renaming rule can divide a big group into separate ionizable groups. put ligands and cofactor as one group. This is done by renaming the atom and residue.","title":"General"},{"location":"runprm/#step-2-rotamer-making","text":"f Use control file \" head1.lst \" for rotamer making ( ROT_SPECIF ) This file enables site specific rotamer making rules. When set as \"t\", it overwrites the rules defined by run.prm. t Do swap ( stereo isotope ) ( ROT_SWAP ) Make stereo isotope conformers for residues like GLN and ASN. t Do rotate ? ( PACK ) Rotate around rotatable bonds? 6 number of rotamers in a bond rotation ( ROTATIONS ) Number of rotamers in a bond rotation.","title":"Step 2, Rotamer making"},{"location":"runprm/#step-4-monte-carlo-sampling","text":"ph \" ph \" for pH titration , \" eh \" for eh titration ( TITR_TYPE ) The type of simulation, pH or Eh. 0 . 0 Initial pH ( TITR_PH0 ) The starting pH, or the pH of Eh titration. 1 . 0 pH interval ( TITR_PHD ) The interval of pH titration 0 . 0 Initial Eh ( TITR_EH0 ) The starting Eh, or the Eh of pH titration. 30 . 0 Eh interval ( in mV ) ( TITR_EHD ) The interval of Eh titration. 15 Number of titration points ( TITR_STEPS ) Number of titration points. f Output Microstate from standard monte carlo ( MS_OUT ) f Output readable micristate file from standard monte carlo ( RE_MS_OUT ) Write out microstates or not.","title":"Step 4, Monte Carlo sampling"},{"location":"runprm/#system-specific-entries","text":"These entries are tailored to the system and installation.","title":"System specific entries"},{"location":"runprm/#system-and-installation-location","text":"/ home / mcce / Stable - MCCE ( MCCE_HOME ) The MCCE installation root. It is required by the program to find relevant parameters. / home / mcce / Stable - MCCE / bin / delphi DelPhi executable ( DELPHI_EXE ) PB solver delphi location. / tmp delphi temporary file folder , \"/tmp\" uses node ( PBE_FOLDER ) Location of PB solver output. This should be a folder with write permission and large enough Sometimes to store GBs of files. new . tpl local parameter file for unrecognized res ( NEWTPL ) Program mcce creates a temporary tpl file whenever it couldn't solve a new cofactor. The presumed parameters are in this file. debug . log ( DEBUG_LOG ) Debug log file name.","title":"System and installation location"},{"location":"runprm/#detail-levels-of-program-output","text":"t Minimize output files ( MINIMIZE_SIZE ) If this is \"f\", mcce will write more debug information. t Print trace file ( DO_TRACE ) Creates a record with MCCE revision number, time and date of run, and all user options set in run.prm and appends it to (or creates) the run.trace file. t clean up delphi focusing directory ? ( DELPHI_CLEAN ) Flag of cleaning delphi temporary folder. Set to 't' only for debugging purpose.","title":"Detail levels of program output"},{"location":"runprm/#other-entries","text":"","title":"Other entries"},{"location":"runprm/#step-1","text":"t Label terminal residues ? ( TERMINALS ) If this flag is on 't', mcce program will identify the C terminus and N terminus of the polypeteides based on the geometry. Terminal residues have extra ionizable sites than residues having peptide bonds. One needs to be careful if there are missing piece of peptide in the given structure. 0 . 1 cut off water if % SAS exceeds this number ( H2O_SASCUTOFF ) The water molecules are stripped of if the surface exposure is over this cutoff. This a recursive procedure which means after some waters are removed, the new surface exposure is recaculated and the process id repeated. 2 . 0 distance limit of reporting clashes ( CLASH_DISTANCE ) The threshold to report abnormal distance found between non-bonded atoms. t ignore hydrogens in input structure ( IGNORE_INPUT_H ) Delete and rebuild input H atoms in step 1 and step 2.","title":"Step 1"},{"location":"runprm/#step-2","text":"t Rebuild sidechain based on torsion minima ( REBUILD_SC ) Rebuild side chain. f Do swing ? ( SWING ) Swing conformers deviate from their parent conformer by a small degree. 10 . 0 phi in degrees of swing ( PHI_SWING ) Swing angle. 1 . 00 SAS cuttoff of making fewer rotamers ( SAS_CUTOFF ) Surface residues get fewer rotamers. There is another mechanism to search the most exposed rotamer to compensate this. 10 . 0 Cutoff of self vdw in kcal / mol ( VDW_CUTOFF ) If a rotamer has self energy, comparing with the most favorable one, over this cutoff, it will not ne kept. 5000 number of repacks ( REPACKS ) The rotamer optimization starts from random initial state, then minimizes the energy on each side chain. The number of restarts of this process is rapacks. 0 . 03 occupancy cutoff of repacks ( REPACK_CUTOFF ) The occupancy of side chain conformer lower than this value will not be kept. t h - bond directed rotamer making ( HDIRECTED ) Do search on hydrogen bond. 1 . 0 threshold for two conformers being different ( HDIRDIFF ) Only one of the similar conformers is kept. Similarity os measured by Root Mean Square Deviation. 36 Limit number of the H bond conformers ( HDIRLIMT ) The number limit on H bond directed conformers. f Do relaxation on water ( RELAX_WAT ) Move water molecules to relax the distance crash. 3 . 2 if distance between water and heavy atom is smaller than this , move water away ( WATER_RELAX_THR ) The threshold of moving water. 10 number of cycles to relax rotamer clash ( HV_RELAX_NCYCLE ) Heavy atom rotamer relaxation by MD. Number of global restarts (cycles). 10 time ( in fs ) for each relaxation iteration ( HV_RELAX_DT ) Heavy atom rotamer relaxation time. 10 number of iterations ( HV_RELAX_NITER ) Number of local restarts. 2 . relax rotamer if vdw interaction is bigger than this ( HV_RELAX_VDW_THR ) Lower end threshold of relaxing rotamers, Van der Waals energy value in kcal/mol. 5 . not relax rotamer if heavy atom vdw is bigger than this ( HV_RELAX_HV_VDW_THR ) High end threshold of relaxing rotamers, Van der Waals energy value in kcal/mol. - 1 . 0 relax if electrostatic interaction is more favorable than this , and the charged groups are close ( HV_RELAX_ELEC_THR ) Relax heavy atoms when they show dominantly favorable electrostatic interaction. 0 . 1 threshold used to define a charged atom , see hv_relax_elec_dist_thr ( HV_RELAX_ELEC_CRG_THR ) Atoms with charge over this value are considered charged atoms. 3 . 0 only relax electrostatically favorable pairs that has charged atom distance shorter than this ( HV_RELAX_ELEC_DIST_THR ) Relax heavy atoms when they show close proximity. 20 . scaling factor for torsion during relaxation ( HV_TORS_SCALE ) Scaling factor for torsion energy when searching torsion minima. 10000 maximun n steps of shake ( HV_RELAX_N_SHAKE ) MD shake parameter. 0 . 001 maximun allowance for bond length to deviate ( HV_RELAX_SHAKE_TOL ) MD bond length detaion parameter. 1 . 0 constraint distance ( HV_RELAX_CONSTRAINT ) MD atom constrain distance. 20 . constraint force for atom stay in original position ( HV_RELAX_CONSTRAINT_FRC ) MD atom constraint force. f include neighbors when doing relaxation ( expensive ) ( HV_RELAX_INCLUDE_NGH ) Include neighbor in MD relaxation. 4 . 0 threshold for include as a neighbor during relaxation ( HV_RELAX_NGH_THR ) Define a neighboring side chain. t Do relaxation on hydrogens ( RELAX_H ) Optimize hydrogen position. - 5 . 0 Energy threshold for keeping the conformer ( RELAX_E_THR ) 200 Loop over N local microstates ( RELAX_NSTATES ) 6 default number of hydroxyl positions ( RELAX_N_HYD ) 5 . do not relax hydrogen if vdw bwt two sidechain conformer bigger than this ( RELAX_CLASH_THR ) 1 . 0 phi for each step of relaxation ( RELAX_PHI ) 300 Maximum number of steps of relaxation ( RELAX_NITER ) 0 . 5 Torque threshold for keep relaxing ( RELAX_TORQ_THR ) These parameters are for MD relaxation. 0 . 02 Last pruning threshold for conformers ( PRUNE_THR ) 0 . 5 Pruning cutoff of RMSD ( PRUNE_RMSD ) 1 . 0 Pruning cutoff of eletrostatic pairwise ( PRUNE_ELE ) 8 . 0 Pruning cutoff of vdw pairwise ( PRUNE_VDW ) To reduce the number of final conformers, similar conformers are grouped into one. The similarity is defined by these parameters. 0 maximum number of conformer per residue ( 0 = unlimited ) ( NCONF_LIMIT ) Set a limit to final conformers of a residue.","title":"Step 2:"},{"location":"runprm/#step-3","text":"f Use SAS + Coulomb ' s law for ele interaction (QUICK_ENERGIES) Use coulomb's law instead of solving PB equation. 80 . 0 Solvent dielectric constant for DelPhi ( EPSILON_SOLV ) 65 Grids in each DelPhi ( GRIDS_DELPHI ) 2 . 0 The target grids per angstrom for DelPhi ( GRIDS_PER_ANG ) 1 . 4 Radius of the probe ( RADIUS_PROBE ) 2 . 0 Ion radius ( IONRAD ) 0 . 15 Salt ( SALT ) PB solver parameters. f skip delphi in step3 ( DEBUG option ) ( SKIP_ELE ) This is a debug option. f Reassign charge and radii before delphi ( if not true then use value in PDB file ) ( REASSIGN ) Step 3 uses atom charges from step2_out.pdb. Use this to overwrite. f Recalculate torsions energy when write out head3 . lst ( RECALC_TORS ) Recalculate torsion energy. 1 . 7 defalut van der Waals radius , for SAS ( DEFAULT_RADIUS ) 0 . 5 factor to 1 - 4 LJ potontial ( 1 . 0 is full ) ( FACTOR_14LJ ) 6 . 0 dielectric constant for Coulomb ' s law (EPSILON_COULOMB) More parameters used by the prigram in step 1, 2 and 3. 1 delphi start conformer number , 0 based ( PBE_START ) 99999 delphi end conformer number , self included ( PBE_END ) Start and end of PB solution on conformers.","title":"step 3:"},{"location":"runprm/#step-4","text":"f Average the pairwise , \"f\" uses the smaller ( AVERAGE_PAIRWISE ) When loading energy from step 3, average the pairwise interaction. 20 . Warning Threshold of difference in pairwise ( WARN_PAIRWISE ) Issue a warning message if asymmetric pairwise interaction is detected. 5 . 0 Big pairwise threshold to make big list ( BIG_PAIRWISE ) Residues with big interactions may get synchronized flips. This is the cut off value. - 1 Random seed , - 1 uses time as random seed ( MONTE_SEED ) Random seed. 298 . 15 Temperature ( MONTE_T ) 3 Number of flips ( MONTE_FLIPS ) 100 Annealing = n_start * confs ( MONTE_NSTART ) 500 Equalibration = n_eq * confs ( MONTE_NEQ ) 0 . 001 Cut - off occupancy of the reduction ( MONTE_REDUCE ) Monte Carlo simulation parameters. ### Only for Junjun ' s monte carlo 2 Number of independent monte carlo sampling ( MONTE_RUNS ) 2000 Sampling = n_iter * confs ( MONTE_NITER ) 20000 Trace energy each MONTE_TRACE steps , 0 no trace ( MONTE_TRACE ) 1000000 Maximum microstates for analytical solution ( NSTATE_MAX ) f Specify mfe point , f = pKa / Em ( MFE_POINT ) - 1 . 0 MFE cutoff ( Kcal ) , default 0 . 5 ( MFE_CUTOFF ) More Monte Carlo simulation parameters. ### Only for Yifan ' s monte carlo t Using Yifan ' s monte carlo (MONTE_ADV_OPT) f Using format from old version ( MONTE_OLD_INPUT ) 5000 Min Sampling = n_iter * confs ( MONTE_NITER_MIN ) - 1 Max Sampling = n_iter * confs ( - 1 stop @ converge ) ( MONTE_NITER_MAX ) 10000 Number of iterations each cycle ( MONTE_NITER_CYCLE ) 1000 niter * n_conf check convergence ( MONTE_NITER_CHK ) - 1 Number of the reduce steps ( - 1 stop @ converge ) ( MONTE_N_REDUCE ) 0 . 01 Threshhold for convergence ( MONTE_CONVERGE ) f Calculate free energy ( MONTE_DO_ENERGY ) 298 . 15 Starting temperature for annealling ( ANNEAL_TEMP_START ) 0 Number of steps of annealling ( ANNEAL_NSTEP ) 1000 Number of iterations for each annealling step ( ANNEAL_NITER_STEP ) More Monte Carlo simulation parameters.","title":"step 4:"},{"location":"runprm/#ipece-parameters","text":"f add neutral atoms to simulate a membrane slab ( IPECE_ADD_ME ) 33 . the thichness of the membrane to be add ( IPECE_MEM_THICKNESS ) M the chain ID of the add atoms ( IPECE_MEM_CHAINID ) This is for creating a simulated membrane.","title":"IPECE parameters"},{"location":"tools/","text":"MCCE tools reference \u00b6 Page last updated on: 2020-06-03 Improving and helping runs \u00b6 step by step mcce run scripts \u00b6 MCCE involves 4 main steps: Step 1: Convert raw PDB file to MCCE PDB file, reformat terminal residues, and strip off surface water and ions. Step 2: Make side chain conformers, including rotamers and ionization conformers. Step 3: Compute self-energy of conformers and pairwise energy lookup table. Step 4: Monte Carlo sampling to evaluate favorable side chain position and ionization at various conditions. While the control of these 4 steps is fully configured in run.prm and executed by mcce command, the 4 steps can be carried out by python wrapper scripts without configuring run.prm. Step 1: prepare structure \u00b6 usage : step1 . py [ - h ] [ -- norun ] [ -- noter ] [ - e / path / to / mcce ] [ - u Key = Value ] [ - d epsilon ] [ -- dry ] pdb Run mcce step 1 , premcce to format PDB file to MCCE PDB format . positional arguments : pdb optional arguments : - h , -- help show this help message and exit -- norun Create run . prm but do not run step 1 -- noter Do not label terminal residues ( for making ftpl ) . - e / path / to / mcce mcce executable location , default to \" mcce \" - u Key = Value User customized variables - d epsilon protein dielectric constant for delphi , default to 4 . 0 -- dry Delete all water molecules . Step 2: make conformers \u00b6 usage : step2 . py [ - h ] [ -- norun ] [ - d epsilon ] [ - e / path / to / mcce ] [ - u Key = Value ] [ - l level ] Run mcce step 2 , make side chain conformers from step1_out . pdb . optional arguments : - h , -- help show this help message and exit -- norun Create run . prm but do not run step 2 - d epsilon dielectric constant for optimizing conformers - e / path / to / mcce mcce executable location , default to \" mcce \" - u Key = Value User customized variables - l level conformer level 1 : quick , 2 : medium , 3 : comprehensive Step 3: energy calculation \u00b6 usage : step3 . py [ - h ] [ - c start end ] [ - d epsilon ] [ - e / path / to / mcce ] [ - f tmp folder ] [ - p processes ] [ - r ] [ - u Key = Value ] [ - x / path / to / delphi ] [ -- norun ] Run mcce step 3 , energy calculations , with multiple threads . optional arguments : - h , -- help show this help message and exit - c start end starting and ending conformer , default to 1 and 9999 - d epsilon protein dielectric constant for delphi , default to 4 . 0 - e / path / to / mcce mcce executable location , default to \" mcce \" - f tmp folder delphi temporary folder , default to / tmp - p processes run mcce with number of processes , default to 1 - r refresh opp files and head3 . lst without running delphi - u Key = Value User customized variables - x / path / to / delphi delphi executable location , default to \" delphi \" -- norun Create run . prm but do not run step 3 step3.py is able to run in multiple threads. Step 4: Monte Carlo sampling \u00b6 usage : step4 . py [ - h ] [ -- norun ] [ - i initial ph / eh ] [ - d interval ] [ - n steps ] [ -- xts ] [ -- ms ] [ - e / path / to / mcce ] [ - t ph or eh ] [ - u Key = Value ] Run mcce step 4 , Monte Carlo sampling to simulate a titration . optional arguments : - h , -- help show this help message and exit -- norun Create run . prm but do not run step 4 - i initial ph / eh Initial pH / Eh of titration - d interval titration interval in pJ or mV - n steps number of steps of titration -- xts Enable entropy correction , default is false -- ms Enable microstate output - e / path / to / mcce mcce executable location , default to \" mcce \" - t ph or eh titration type , pH or Eh - u Key = Value User customized variables Step 5: titration fitting \u00b6 Step 5 is optional. It writes net charge of each residue in sum_crg2.out and fits the titration curve in pK2.out. usage : step5 . py [ - h ] Run mcce step 5 , generate net charge , fit titration curve . optional arguments : - h , -- help show this help message and exit Step 6: hydrogen bond \u00b6 Step 6 is for hydrogen bond network analysis. It requires step 4 to output microstates. usage : step6 . py [ - h ] [ -- norun ] [ - e / path / to / mcce ] [ - u Key = Value ] Run step 6 , hydrogen bond analysis , requires microstate output from step 4 . optional arguments : - h , -- help show this help message and exit -- norun Create run . prm but do not run step 6 - e / path / to / mcce mcce executable location , default to \" mcce \" - u Key = Value User customized variables Example: step4 . py --ms step6 . py Combine first 4 steps \u00b6 The first 4 steps are essential steps. #!/bin/bash step1.py input.pdb step2.py step3.py step4.py energies.py \u00b6 Run step3 with multiple threads. Syntax: energies . py [ - h ] [ - p processes ] [ - r ] [ - c start end ] [ - e / path / to / mcce ] Optional arguments: Argument Description -h, --help show this help message and exit -p processes run mcce with number of processes, default to 1 -r refresh opp files and head3.lst without running delphi -c start end starting and ending conformer, default to 1 and 9999 -e /path/to/mcce mcce executable location, default to \"mcce\" Examples: energies . py - p 6 This command runs step 3 in 6 threads. energies . py - r This command runs step 3 just to refresh head3.lst and vdw energy. energies . py - c 1 100 - p 4 This command calculates conformer from 1 to 100 in 5 threads. Note After this command, the lines: 1 delphi start conformer number , 0 based ( PBE_START ) 99999 delphi end conformer number , self included ( PBE_END ) in run.prm file might be altered. getpdb \u00b6 Download a pdb file by its PDB ID. Syntax: getpbd pdbid [ saved name ] Example: getpdb 1 akk Inquiring the remote file 1 AKK . pdb ... Saving as 1 AKK . pdb ... Download completed . Or getpdb 1 akk prot . pdb Inquiring the remote file 1 AKK . pdb ... Saving as prot . pdb ... Download completed . to save as specified name. translate_step2.py \u00b6 Translate old atom names in step2_out to new PDB v3 names. Syntax: translate_step2 . py step2_out . pdb Hydrogen names in PDB v3 are significantly different from PDB v2. Due to the randomness in step 2, it is sometimes desired to preserve step2_out.pdb. This tool translates the names so that step2_out.pdb so that it can be used by new mcce. This program prints the translated content on screen. So the user is responsible to make backup of the step2_out.pdb file and redirect the outcome to a new step2_out.pdb. Example: cp step2_out . pdb step2_out . pdb . bak translate_step2 . py step2_out . pdb . bak > step2_out . pdb Result Analysis \u00b6 state.py \u00b6 Analyze how a microstate energy is composed. Syntax: state . py Required files: run.prm head3.lst extra.tpl for scaling factors that are not equal to 1. energies/*.opp for pairwise interactions microstate file named \"states\" The microstate file is in a fixed format. The first line is like: T = 298 . 15 , ph = 7 . 0 , eh = 0 . 0 It specifies the the environment variables which affects the energy calculation. Variables are separated by \", \". The variable names are not case sensitive. T: Temperature. Room temperature is 298.15 K ph: pH value. eh: Eh value, the electric potential for potential titration. The rest of the lines are microstates. One line per state. Each line consists the index number of conformers (0 based). Numbers can be separated by either comma or space. Example: Make a states file: Run state . py mfe.py \u00b6 Analyze ionization free energy of a residue. It tells you why a residue has that pKa and what factors played a role. Syntax mfe . py [ - h ] [ - p pH / Eh ] [ - x TS_correction ] [ - c cutoff ] residue residue: residue ID as in pK.out pH/Eh: pH value at which ionization energy is calculated. Default is the pKa (midpoint) where dG = 0. cut_off: Report only pairwise interaction bigger than this value. TS_correction: \"t\" to include entropy in G, \"f\" not to include, \"r\" (default) will look for run.prm. If entropy correction was turned on in step 4, mfe should not include this term as entropy has been \"removed\". Required files: run.prm head3.lst extra.tpl for scaling factors that are not equal to 1. energies/*.opp for pairwise interactions Example: Check titration result in pKa.out: cat pK . out ... ASP - A0044_ 3 . 947 ... ASP-A0052 is the residue_ID. Its calculated pKa is 2.275. At this point, the free energy of reaction from ASP neutral to ASP ionized should be close to 0. Run $ mfe.py -c 0 .01 ASP-A0044_ Residue ASP-A0044_ pKa/Em = 3 .947 ================================= Terms pH meV Kcal --------------------------------- vdw0 -0.00 -0.27 -0.01 vdw1 -0.01 -0.59 -0.01 tors -0.15 -8.63 -0.20 ebkb -0.67 -38.66 -0.91 dsol 0 .26 15 .35 0 .36 offset -0.62 -36.17 -0.85 pH & pK0 0 .80 46 .61 1 .10 Eh & Em0 0 .00 0 .00 0 .00 -TS 0 .58 33 .46 0 .79 residues -0.19 -11.14 -0.26 ********************************* TOTAL -0.00 -0.05 -0.00 sum_crg ********************************* NTRA0003_ -0.03 -1.66 -0.04 1 .00 ASPA0022_ 0 .02 0 .95 0 .02 -0.86 ASNA0023_ -0.01 -0.68 -0.02 0 .00 LYSA0027_ -0.01 -0.77 -0.02 1 .00 LYSA0039_ -0.14 -8.23 -0.19 1 .00 ASNA0041_ -0.01 -0.62 -0.01 0 .00 LYSA0049_ -0.04 -2.10 -0.05 1 .00 ASPA0054_ 0 .01 0 .69 0 .02 -0.95 GLUA0073_ 0 .01 0 .79 0 .02 -0.99 ASPA0075_ 0 .05 2 .85 0 .07 -1.00 TYRA0078_ 0 .02 1 .05 0 .02 -0.00 SERA0080_ 0 .02 1 .19 0 .03 0 .00 ARGA0083_ -0.04 -2.51 -0.06 1 .00 ARGA0087_ -0.03 -1.49 -0.04 1 .00 HISA0102_ -0.02 -1.02 -0.02 1 .00 ================================= You can do mfe calculation at pH other than mid-point. Parameter file preparation \u00b6 Connecting to other programs \u00b6","title":"Tools Program Reference"},{"location":"tools/#mcce-tools-reference","text":"Page last updated on: 2020-06-03","title":"MCCE tools reference"},{"location":"tools/#improving-and-helping-runs","text":"","title":"Improving and helping runs"},{"location":"tools/#step-by-step-mcce-run-scripts","text":"MCCE involves 4 main steps: Step 1: Convert raw PDB file to MCCE PDB file, reformat terminal residues, and strip off surface water and ions. Step 2: Make side chain conformers, including rotamers and ionization conformers. Step 3: Compute self-energy of conformers and pairwise energy lookup table. Step 4: Monte Carlo sampling to evaluate favorable side chain position and ionization at various conditions. While the control of these 4 steps is fully configured in run.prm and executed by mcce command, the 4 steps can be carried out by python wrapper scripts without configuring run.prm.","title":"step by step mcce run scripts"},{"location":"tools/#step-1-prepare-structure","text":"usage : step1 . py [ - h ] [ -- norun ] [ -- noter ] [ - e / path / to / mcce ] [ - u Key = Value ] [ - d epsilon ] [ -- dry ] pdb Run mcce step 1 , premcce to format PDB file to MCCE PDB format . positional arguments : pdb optional arguments : - h , -- help show this help message and exit -- norun Create run . prm but do not run step 1 -- noter Do not label terminal residues ( for making ftpl ) . - e / path / to / mcce mcce executable location , default to \" mcce \" - u Key = Value User customized variables - d epsilon protein dielectric constant for delphi , default to 4 . 0 -- dry Delete all water molecules .","title":"Step 1: prepare structure"},{"location":"tools/#step-2-make-conformers","text":"usage : step2 . py [ - h ] [ -- norun ] [ - d epsilon ] [ - e / path / to / mcce ] [ - u Key = Value ] [ - l level ] Run mcce step 2 , make side chain conformers from step1_out . pdb . optional arguments : - h , -- help show this help message and exit -- norun Create run . prm but do not run step 2 - d epsilon dielectric constant for optimizing conformers - e / path / to / mcce mcce executable location , default to \" mcce \" - u Key = Value User customized variables - l level conformer level 1 : quick , 2 : medium , 3 : comprehensive","title":"Step 2: make conformers"},{"location":"tools/#step-3-energy-calculation","text":"usage : step3 . py [ - h ] [ - c start end ] [ - d epsilon ] [ - e / path / to / mcce ] [ - f tmp folder ] [ - p processes ] [ - r ] [ - u Key = Value ] [ - x / path / to / delphi ] [ -- norun ] Run mcce step 3 , energy calculations , with multiple threads . optional arguments : - h , -- help show this help message and exit - c start end starting and ending conformer , default to 1 and 9999 - d epsilon protein dielectric constant for delphi , default to 4 . 0 - e / path / to / mcce mcce executable location , default to \" mcce \" - f tmp folder delphi temporary folder , default to / tmp - p processes run mcce with number of processes , default to 1 - r refresh opp files and head3 . lst without running delphi - u Key = Value User customized variables - x / path / to / delphi delphi executable location , default to \" delphi \" -- norun Create run . prm but do not run step 3 step3.py is able to run in multiple threads.","title":"Step 3: energy calculation"},{"location":"tools/#step-4-monte-carlo-sampling","text":"usage : step4 . py [ - h ] [ -- norun ] [ - i initial ph / eh ] [ - d interval ] [ - n steps ] [ -- xts ] [ -- ms ] [ - e / path / to / mcce ] [ - t ph or eh ] [ - u Key = Value ] Run mcce step 4 , Monte Carlo sampling to simulate a titration . optional arguments : - h , -- help show this help message and exit -- norun Create run . prm but do not run step 4 - i initial ph / eh Initial pH / Eh of titration - d interval titration interval in pJ or mV - n steps number of steps of titration -- xts Enable entropy correction , default is false -- ms Enable microstate output - e / path / to / mcce mcce executable location , default to \" mcce \" - t ph or eh titration type , pH or Eh - u Key = Value User customized variables","title":"Step 4: Monte Carlo sampling"},{"location":"tools/#step-5-titration-fitting","text":"Step 5 is optional. It writes net charge of each residue in sum_crg2.out and fits the titration curve in pK2.out. usage : step5 . py [ - h ] Run mcce step 5 , generate net charge , fit titration curve . optional arguments : - h , -- help show this help message and exit","title":"Step 5: titration fitting"},{"location":"tools/#step-6-hydrogen-bond","text":"Step 6 is for hydrogen bond network analysis. It requires step 4 to output microstates. usage : step6 . py [ - h ] [ -- norun ] [ - e / path / to / mcce ] [ - u Key = Value ] Run step 6 , hydrogen bond analysis , requires microstate output from step 4 . optional arguments : - h , -- help show this help message and exit -- norun Create run . prm but do not run step 6 - e / path / to / mcce mcce executable location , default to \" mcce \" - u Key = Value User customized variables Example: step4 . py --ms step6 . py","title":"Step 6: hydrogen bond"},{"location":"tools/#combine-first-4-steps","text":"The first 4 steps are essential steps. #!/bin/bash step1.py input.pdb step2.py step3.py step4.py","title":"Combine first 4 steps"},{"location":"tools/#energiespy","text":"Run step3 with multiple threads. Syntax: energies . py [ - h ] [ - p processes ] [ - r ] [ - c start end ] [ - e / path / to / mcce ] Optional arguments: Argument Description -h, --help show this help message and exit -p processes run mcce with number of processes, default to 1 -r refresh opp files and head3.lst without running delphi -c start end starting and ending conformer, default to 1 and 9999 -e /path/to/mcce mcce executable location, default to \"mcce\" Examples: energies . py - p 6 This command runs step 3 in 6 threads. energies . py - r This command runs step 3 just to refresh head3.lst and vdw energy. energies . py - c 1 100 - p 4 This command calculates conformer from 1 to 100 in 5 threads. Note After this command, the lines: 1 delphi start conformer number , 0 based ( PBE_START ) 99999 delphi end conformer number , self included ( PBE_END ) in run.prm file might be altered.","title":"energies.py"},{"location":"tools/#getpdb","text":"Download a pdb file by its PDB ID. Syntax: getpbd pdbid [ saved name ] Example: getpdb 1 akk Inquiring the remote file 1 AKK . pdb ... Saving as 1 AKK . pdb ... Download completed . Or getpdb 1 akk prot . pdb Inquiring the remote file 1 AKK . pdb ... Saving as prot . pdb ... Download completed . to save as specified name.","title":"getpdb"},{"location":"tools/#translate_step2py","text":"Translate old atom names in step2_out to new PDB v3 names. Syntax: translate_step2 . py step2_out . pdb Hydrogen names in PDB v3 are significantly different from PDB v2. Due to the randomness in step 2, it is sometimes desired to preserve step2_out.pdb. This tool translates the names so that step2_out.pdb so that it can be used by new mcce. This program prints the translated content on screen. So the user is responsible to make backup of the step2_out.pdb file and redirect the outcome to a new step2_out.pdb. Example: cp step2_out . pdb step2_out . pdb . bak translate_step2 . py step2_out . pdb . bak > step2_out . pdb","title":"translate_step2.py"},{"location":"tools/#result-analysis","text":"","title":"Result Analysis"},{"location":"tools/#statepy","text":"Analyze how a microstate energy is composed. Syntax: state . py Required files: run.prm head3.lst extra.tpl for scaling factors that are not equal to 1. energies/*.opp for pairwise interactions microstate file named \"states\" The microstate file is in a fixed format. The first line is like: T = 298 . 15 , ph = 7 . 0 , eh = 0 . 0 It specifies the the environment variables which affects the energy calculation. Variables are separated by \", \". The variable names are not case sensitive. T: Temperature. Room temperature is 298.15 K ph: pH value. eh: Eh value, the electric potential for potential titration. The rest of the lines are microstates. One line per state. Each line consists the index number of conformers (0 based). Numbers can be separated by either comma or space. Example: Make a states file: Run state . py","title":"state.py"},{"location":"tools/#mfepy","text":"Analyze ionization free energy of a residue. It tells you why a residue has that pKa and what factors played a role. Syntax mfe . py [ - h ] [ - p pH / Eh ] [ - x TS_correction ] [ - c cutoff ] residue residue: residue ID as in pK.out pH/Eh: pH value at which ionization energy is calculated. Default is the pKa (midpoint) where dG = 0. cut_off: Report only pairwise interaction bigger than this value. TS_correction: \"t\" to include entropy in G, \"f\" not to include, \"r\" (default) will look for run.prm. If entropy correction was turned on in step 4, mfe should not include this term as entropy has been \"removed\". Required files: run.prm head3.lst extra.tpl for scaling factors that are not equal to 1. energies/*.opp for pairwise interactions Example: Check titration result in pKa.out: cat pK . out ... ASP - A0044_ 3 . 947 ... ASP-A0052 is the residue_ID. Its calculated pKa is 2.275. At this point, the free energy of reaction from ASP neutral to ASP ionized should be close to 0. Run $ mfe.py -c 0 .01 ASP-A0044_ Residue ASP-A0044_ pKa/Em = 3 .947 ================================= Terms pH meV Kcal --------------------------------- vdw0 -0.00 -0.27 -0.01 vdw1 -0.01 -0.59 -0.01 tors -0.15 -8.63 -0.20 ebkb -0.67 -38.66 -0.91 dsol 0 .26 15 .35 0 .36 offset -0.62 -36.17 -0.85 pH & pK0 0 .80 46 .61 1 .10 Eh & Em0 0 .00 0 .00 0 .00 -TS 0 .58 33 .46 0 .79 residues -0.19 -11.14 -0.26 ********************************* TOTAL -0.00 -0.05 -0.00 sum_crg ********************************* NTRA0003_ -0.03 -1.66 -0.04 1 .00 ASPA0022_ 0 .02 0 .95 0 .02 -0.86 ASNA0023_ -0.01 -0.68 -0.02 0 .00 LYSA0027_ -0.01 -0.77 -0.02 1 .00 LYSA0039_ -0.14 -8.23 -0.19 1 .00 ASNA0041_ -0.01 -0.62 -0.01 0 .00 LYSA0049_ -0.04 -2.10 -0.05 1 .00 ASPA0054_ 0 .01 0 .69 0 .02 -0.95 GLUA0073_ 0 .01 0 .79 0 .02 -0.99 ASPA0075_ 0 .05 2 .85 0 .07 -1.00 TYRA0078_ 0 .02 1 .05 0 .02 -0.00 SERA0080_ 0 .02 1 .19 0 .03 0 .00 ARGA0083_ -0.04 -2.51 -0.06 1 .00 ARGA0087_ -0.03 -1.49 -0.04 1 .00 HISA0102_ -0.02 -1.02 -0.02 1 .00 ================================= You can do mfe calculation at pH other than mid-point.","title":"mfe.py"},{"location":"tools/#parameter-file-preparation","text":"","title":"Parameter file preparation"},{"location":"tools/#connecting-to-other-programs","text":"","title":"Connecting to other programs"},{"location":"wikihowto/","text":"How to edit MCCE wiki \u00b6 Page last updated on: 2020-05-29 This documentation is written in mkdocs, which uses markdown language and publishes on github pages at url https://github.com/GunnerLab/Stable-MCCE . Install of Mkdocs \u00b6 You need pip, a python package manager, for installation. Generally, you are able to install pip through conda conda install pip or system package manager sudo aptitude install python - pip If you don't know pip, please go to https://pip.pypa.io/en/stable/ for more information. In a terminal window, run these commands to install mkdocs, theme, and necessary plugins for documentation of this project. pip install -- upgrade pip pip install bs4 pip install unicode pip install mkdocs pip install mkdocs - material pip install pymdown - extensions pip install markdown - blockdiag pip install markdown - include pip install mkdocs - git - revision - date - plugin Writing and editing \u00b6 All documentation files reside under folder wiki/ mkdocs.yml : configuration file, also defines the menu docs/ : location of documentation files img/ : location for image files site/ : site web pages published by command mkdocs gh-deploy, do not edit this directory. Under wiki/ directory, run mkdocs serve will bring up a web service, and point browser to http://localhost:8000 to enable viewing and debugging the documentation. Deploying \u00b6 Commit changes: \u00b6 git commit - a - m \"updated by jmao\" This commit will update the time stamp on the page as well. Push to your forked repository \u00b6 First check if you set up the GunnerLab as upstream For example: ( base ) jmao @pc : ~/ projects / Stable - MCCE / wiki $ git remote - v origin https : // github . com / newbooks / Stable - MCCE . git ( fetch ) origin https : // github . com / newbooks / Stable - MCCE . git ( push ) upstream https : // github . com / GunnerLab / Stable - MCCE . git ( fetch ) upstream https : // github . com / GunnerLab / Stable - MCCE . git ( push ) If you do not have upstream repo, push to the origin, then make a pull request: git push Then go to https://github.com/ under your forked repository. Make a pull request. Someone will publish the edit for you. Publish directly \u00b6 If you are a group member with publish permission, you can publish directly. Make sure the upstream is setup properly: git remote - v If upstream is not pointing to https://github.com/GunnerLab/Stable-MCCE.git , run git remote add upstream https : // github . com / GunnerLab / Stable - MCCE . git Under wiki folder, run gh - deploy ( base ) jmao @pc : ~/ projects / Stable - MCCE / wiki $ mkdocs gh - deploy INFO - Cleaning site directory INFO - Building documentation to directory : / home / jmao / projects / Stable - MCCE / wiki / site INFO - Copying '/home/jmao/projects/Stable-MCCE/wiki/site' to 'gh-pages' branch and pushing to GitHub . INFO - Your documentation should shortly be available at : https : // GunnerLab . github . io / Stable - MCCE / If gh-deploy reports conflict in special branch gh-pages, use \"--force\" switch to overwrite: mkdocs gh - deploy --force The published site is on: https://gunnerlab.github.io/Stable-MCCE/ .","title":"How to write documentation"},{"location":"wikihowto/#how-to-edit-mcce-wiki","text":"Page last updated on: 2020-05-29 This documentation is written in mkdocs, which uses markdown language and publishes on github pages at url https://github.com/GunnerLab/Stable-MCCE .","title":"How to edit MCCE wiki"},{"location":"wikihowto/#install-of-mkdocs","text":"You need pip, a python package manager, for installation. Generally, you are able to install pip through conda conda install pip or system package manager sudo aptitude install python - pip If you don't know pip, please go to https://pip.pypa.io/en/stable/ for more information. In a terminal window, run these commands to install mkdocs, theme, and necessary plugins for documentation of this project. pip install -- upgrade pip pip install bs4 pip install unicode pip install mkdocs pip install mkdocs - material pip install pymdown - extensions pip install markdown - blockdiag pip install markdown - include pip install mkdocs - git - revision - date - plugin","title":"Install of Mkdocs"},{"location":"wikihowto/#writing-and-editing","text":"All documentation files reside under folder wiki/ mkdocs.yml : configuration file, also defines the menu docs/ : location of documentation files img/ : location for image files site/ : site web pages published by command mkdocs gh-deploy, do not edit this directory. Under wiki/ directory, run mkdocs serve will bring up a web service, and point browser to http://localhost:8000 to enable viewing and debugging the documentation.","title":"Writing and editing"},{"location":"wikihowto/#deploying","text":"","title":"Deploying"},{"location":"wikihowto/#commit-changes","text":"git commit - a - m \"updated by jmao\" This commit will update the time stamp on the page as well.","title":"Commit changes:"},{"location":"wikihowto/#push-to-your-forked-repository","text":"First check if you set up the GunnerLab as upstream For example: ( base ) jmao @pc : ~/ projects / Stable - MCCE / wiki $ git remote - v origin https : // github . com / newbooks / Stable - MCCE . git ( fetch ) origin https : // github . com / newbooks / Stable - MCCE . git ( push ) upstream https : // github . com / GunnerLab / Stable - MCCE . git ( fetch ) upstream https : // github . com / GunnerLab / Stable - MCCE . git ( push ) If you do not have upstream repo, push to the origin, then make a pull request: git push Then go to https://github.com/ under your forked repository. Make a pull request. Someone will publish the edit for you.","title":"Push to your forked repository"},{"location":"wikihowto/#publish-directly","text":"If you are a group member with publish permission, you can publish directly. Make sure the upstream is setup properly: git remote - v If upstream is not pointing to https://github.com/GunnerLab/Stable-MCCE.git , run git remote add upstream https : // github . com / GunnerLab / Stable - MCCE . git Under wiki folder, run gh - deploy ( base ) jmao @pc : ~/ projects / Stable - MCCE / wiki $ mkdocs gh - deploy INFO - Cleaning site directory INFO - Building documentation to directory : / home / jmao / projects / Stable - MCCE / wiki / site INFO - Copying '/home/jmao/projects/Stable-MCCE/wiki/site' to 'gh-pages' branch and pushing to GitHub . INFO - Your documentation should shortly be available at : https : // GunnerLab . github . io / Stable - MCCE / If gh-deploy reports conflict in special branch gh-pages, use \"--force\" switch to overwrite: mkdocs gh - deploy --force The published site is on: https://gunnerlab.github.io/Stable-MCCE/ .","title":"Publish directly"}]}