{"config":{"lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Multi-Conformation Continuum Electrostatics - MCCE \u00b6 Page last updated on: 2020-07-07 MCCE is a biophysics simulation program developed at Gunner Lab at City College of New York. MCCE combines continuum electrostatics and molecular mechanics. In this program, the protein side chain motions are simulated explicitly while the dielectric effect of solvent and bulk protein material is modeled by continuum electrostatics. What can MCCE do? \u00b6 MCCE can calculate: residue pka, cofactor Em and protein PI in protein-solvent systems; protein structural responses to changes in charge; residue ionization changes in response to protein structural changes; location and stoichiometry of proton transfers coupled to electron transfer References \u00b6 Cite these papers if you use MCCE for publications: Song Y., J. Mao, Gunner M.R. (2009). J. Comp. Chem epub Mar 2009 Georgescu R.E., Alexov E.G., Gunner M.R.(2002). Combining conformational flexibility and continuum electrostatics for calculating pKa's in proteins. Biophys J. 83, 1731-1748 Alexov, E. and Gunner, M.R. (1997) Incorporating protein conformational flexibility into pH- titration calculations: Results on T4 Lysozyme. Biophys. J. 74, 2075-2093 Contact \u00b6 Need to contact us? About issues with this program: Submit an issue from Github About Physics of MCCE: Email to Marilyn Gunner Not sure? Email to Junjun Mao","title":"What is MCCE?"},{"location":"#multi-conformation-continuum-electrostatics-mcce","text":"Page last updated on: 2020-07-07 MCCE is a biophysics simulation program developed at Gunner Lab at City College of New York. MCCE combines continuum electrostatics and molecular mechanics. In this program, the protein side chain motions are simulated explicitly while the dielectric effect of solvent and bulk protein material is modeled by continuum electrostatics.","title":"Multi-Conformation Continuum Electrostatics - MCCE"},{"location":"#what-can-mcce-do","text":"MCCE can calculate: residue pka, cofactor Em and protein PI in protein-solvent systems; protein structural responses to changes in charge; residue ionization changes in response to protein structural changes; location and stoichiometry of proton transfers coupled to electron transfer","title":"What can MCCE do?"},{"location":"#references","text":"Cite these papers if you use MCCE for publications: Song Y., J. Mao, Gunner M.R. (2009). J. Comp. Chem epub Mar 2009 Georgescu R.E., Alexov E.G., Gunner M.R.(2002). Combining conformational flexibility and continuum electrostatics for calculating pKa's in proteins. Biophys J. 83, 1731-1748 Alexov, E. and Gunner, M.R. (1997) Incorporating protein conformational flexibility into pH- titration calculations: Results on T4 Lysozyme. Biophys. J. 74, 2075-2093","title":"References"},{"location":"#contact","text":"Need to contact us? About issues with this program: Submit an issue from Github About Physics of MCCE: Email to Marilyn Gunner Not sure? Email to Junjun Mao","title":"Contact"},{"location":"develop/","text":"How to contribute code using git \u00b6 Page last updated on: 2020-07-07 Part 1. One-time set up \u00b6 Identity: \u00b6 $ git config --global user.name \"<Your Name>\" $ git config --global user.email <your email> Save credential for 6 hours: \u00b6 $ git config --global credential.helper 'cache --timeout=21600' Save credential permanently: \u00b6 $ git config --global credential.helper store Alias of showing git history: \u00b6 Add this to ~/.gitconfig [alias] lg = log --graph --abbrev-commit --decorate --format=format:'%C(bold blue)%h%C(reset) - %C(bold green)(%ar)%C(reset) %C(white)%s%C(reset) %C(dim white)- %an%C(reset)%C(bold yellow)%d%C(reset)' --all Part 2. Start a new repository \u00b6 Clone a remote repo: \u00b6 Clone a remote repo to local computer: $ git clone <url> Convert a local directory: \u00b6 Convert an existing local directory to local git repository: $ git init Part 3. Single line development: \u00b6 Add all files to track: \u00b6 $ git add . Check status: \u00b6 $ git status Commit: \u00b6 $ git commit -a -m \"<commit message>\" Add a file to track: \u00b6 $ git add <file name> Show history: \u00b6 $ git lg It requires you set up the \u201clg\u201d alias in ~/.gitconfig Part 4. Go to past commits \u00b6 Create a new branch and revert to a past commit: $ git checkout -b <new branch> <commit hash> <new branch> is a branch name you make. <commit hash> is the string as reported by git log If you want to make this branch as the new master branch, do a swap as following: make sure your are in the new branch $ git checkout <new branch> force master to merge with current branch and use current branch as favored: $ git merge -s ours master go to the master branch and reconcile again: $ git checkout master $ git merge <new branch> after merge, delete the branch. $ git branch -d <new branch> Part 5. Multi-line development \u00b6 Show branches: \u00b6 $ git branch \u00b6 Show remote branches: $ git branch -r Switch between branches: \u00b6 $ git checkout <branch name> Create and switch branch: \u00b6 $ git checkout -b <branch name> Merge branches: \u00b6 $ git merge <another branch> This will merge a branch to current branch: Merge with current favored: \u00b6 $ git merge -s ours <another branch> Delete branches \u00b6 $ git branch -d <branch name> Force delete: \u00b6 $ git branch -D <branch name> Part 6. Sync remote and local \u00b6 Check remote: \u00b6 $ git remote -v \u201corigin\u201d is the default name of your first remote. Add more remotes: \u00b6 $ git remote add <remote> <url> Pull from remote repo: \u00b6 $ git pull Or $ git pull <remote> <branch> Push to remote: \u00b6 $ git push Push new local branch to remote: \u00b6 $ git push -u <remote> <branch> Delete remote branch: \u00b6 $ git push <remote> --delete <branch> Delete remote tracking branch: \u00b6 $ git remote prune <remote> Part 7. Merge branches \u00b6 Common scenario of merge: \u00b6 Start a new feature: $ git checkout -b new-feature Edit some files, then commit the change: $ git commit -a -m \"Start a feature\" Edit some files, then commit more changes: $ git commit -a -m \"Finish a feature\" Merge in the new-feature branch: $ git checkout master $ git merge new-feature $ git branch -d new-feature Conflict in merge: \u00b6 When conflicts occur, the conflicting files will have visual marks like: <<<<<<< master conflicting text in receiving branch ======= conflicting text in merging branch >>>>>>> branch You need to edit text and remove <<<<<<, ======, >>>>>> lines. Then run a commit: $ git commit -a -m \"<commit message>\"","title":"How to contribute code"},{"location":"develop/#how-to-contribute-code-using-git","text":"Page last updated on: 2020-07-07","title":"How to contribute code using git"},{"location":"develop/#part-1-one-time-set-up","text":"","title":"Part 1. One-time set up"},{"location":"develop/#identity","text":"$ git config --global user.name \"<Your Name>\" $ git config --global user.email <your email>","title":"Identity:"},{"location":"develop/#save-credential-for-6-hours","text":"$ git config --global credential.helper 'cache --timeout=21600'","title":"Save credential for 6 hours:"},{"location":"develop/#save-credential-permanently","text":"$ git config --global credential.helper store","title":"Save credential permanently:"},{"location":"develop/#alias-of-showing-git-history","text":"Add this to ~/.gitconfig [alias] lg = log --graph --abbrev-commit --decorate --format=format:'%C(bold blue)%h%C(reset) - %C(bold green)(%ar)%C(reset) %C(white)%s%C(reset) %C(dim white)- %an%C(reset)%C(bold yellow)%d%C(reset)' --all","title":"Alias of showing git history:"},{"location":"develop/#part-2-start-a-new-repository","text":"","title":"Part 2. Start a new repository"},{"location":"develop/#clone-a-remote-repo","text":"Clone a remote repo to local computer: $ git clone <url>","title":"Clone a remote repo:"},{"location":"develop/#convert-a-local-directory","text":"Convert an existing local directory to local git repository: $ git init","title":"Convert a local directory:"},{"location":"develop/#part-3-single-line-development","text":"","title":"Part 3. Single line development:"},{"location":"develop/#add-all-files-to-track","text":"$ git add .","title":"Add all files to track:"},{"location":"develop/#check-status","text":"$ git status","title":"Check status:"},{"location":"develop/#commit","text":"$ git commit -a -m \"<commit message>\"","title":"Commit:"},{"location":"develop/#add-a-file-to-track","text":"$ git add <file name>","title":"Add a file to track:"},{"location":"develop/#show-history","text":"$ git lg It requires you set up the \u201clg\u201d alias in ~/.gitconfig","title":"Show history:"},{"location":"develop/#part-4-go-to-past-commits","text":"Create a new branch and revert to a past commit: $ git checkout -b <new branch> <commit hash> <new branch> is a branch name you make. <commit hash> is the string as reported by git log If you want to make this branch as the new master branch, do a swap as following: make sure your are in the new branch $ git checkout <new branch> force master to merge with current branch and use current branch as favored: $ git merge -s ours master go to the master branch and reconcile again: $ git checkout master $ git merge <new branch> after merge, delete the branch. $ git branch -d <new branch>","title":"Part 4. Go to past commits"},{"location":"develop/#part-5-multi-line-development","text":"","title":"Part 5. Multi-line development"},{"location":"develop/#show-branches","text":"$ git branch","title":"Show branches:"},{"location":"develop/#_1","text":"Show remote branches: $ git branch -r","title":""},{"location":"develop/#switch-between-branches","text":"$ git checkout <branch name>","title":"Switch between branches:"},{"location":"develop/#create-and-switch-branch","text":"$ git checkout -b <branch name>","title":"Create and switch branch:"},{"location":"develop/#merge-branches","text":"$ git merge <another branch> This will merge a branch to current branch:","title":"Merge branches:"},{"location":"develop/#merge-with-current-favored","text":"$ git merge -s ours <another branch>","title":"Merge with current favored:"},{"location":"develop/#delete-branches","text":"$ git branch -d <branch name>","title":"Delete branches"},{"location":"develop/#force-delete","text":"$ git branch -D <branch name>","title":"Force delete:"},{"location":"develop/#part-6-sync-remote-and-local","text":"","title":"Part 6. Sync remote and local"},{"location":"develop/#check-remote","text":"$ git remote -v \u201corigin\u201d is the default name of your first remote.","title":"Check remote:"},{"location":"develop/#add-more-remotes","text":"$ git remote add <remote> <url>","title":"Add more remotes:"},{"location":"develop/#pull-from-remote-repo","text":"$ git pull Or $ git pull <remote> <branch>","title":"Pull from remote repo:"},{"location":"develop/#push-to-remote","text":"$ git push","title":"Push to remote:"},{"location":"develop/#push-new-local-branch-to-remote","text":"$ git push -u <remote> <branch>","title":"Push new local branch to remote:"},{"location":"develop/#delete-remote-branch","text":"$ git push <remote> --delete <branch>","title":"Delete remote branch:"},{"location":"develop/#delete-remote-tracking-branch","text":"$ git remote prune <remote>","title":"Delete remote tracking branch:"},{"location":"develop/#part-7-merge-branches","text":"","title":"Part 7. Merge branches"},{"location":"develop/#common-scenario-of-merge","text":"Start a new feature: $ git checkout -b new-feature Edit some files, then commit the change: $ git commit -a -m \"Start a feature\" Edit some files, then commit more changes: $ git commit -a -m \"Finish a feature\" Merge in the new-feature branch: $ git checkout master $ git merge new-feature $ git branch -d new-feature","title":"Common scenario of merge:"},{"location":"develop/#conflict-in-merge","text":"When conflicts occur, the conflicting files will have visual marks like: <<<<<<< master conflicting text in receiving branch ======= conflicting text in merging branch >>>>>>> branch You need to edit text and remove <<<<<<, ======, >>>>>> lines. Then run a commit: $ git commit -a -m \"<commit message>\"","title":"Conflict in merge:"},{"location":"emexample/","text":"Calculate Em of heme in Cytochrome \u00b6 Page last updated on: 2020-07-07 Background \u00b6 Cytochrome c is a small protein that transports electron in mitochondria to facilitate the synthesis of ATP. It redox potential plays an imprtant role in its function. The regulation of the Cytochrome C redox potential can be explained by Continuum Electrostatic analysis. Junjun Mao, Karin Hauser, and M. R. Gunner, How Cytochromes with Different Folds Control Heme Redox Potentials, Biochemistry 2003, 42, 33, 9829\u20139840 Cytochrome C from E. Caballus (PDB ID 1AKK) has an experimental Em of 260 mV. Prepare the calculation \u00b6 After the program is installed and execution path is configured (see link for details), make a working directory and go to the working directory. MCCE will generate intermediate files and result files in the current directory, so it's best to prepare one directory for calculation on one structure. $ mkdir 1akk $ cd 1akk Then download pdb file 1AKK to the working directory: $ getpdb 1akk Inquiring the remote file 1AKK.pdb ... Saving as 1AKK.pdb ... Download completed. Run 4 steps of MCCE \u00b6 Step 1. Convert PDB file into MCCE PDB \u00b6 This step proof reads the structure file and cut terminal residues and complex cofactors into smaller ones if necessary. The heme in cytochrome C has two ligands HIS18 and MET80. They behave differently than HIS and MET so we have to rename them. Copy name.txt from the MCCE directoy to working directory. $ cp /path/to/mcce/name.txt ./ Your /path/to/mcce can be found by running $ var=`which mcce`; echo ${var%/*/*} Now that you have a name.txt in your working directory, add these two lines to ./name.txt: *****HIS** 18 *****HIL** 18 *****MET** 80 *****MEL** 80 Then run step 1: $ step1.py -u RENAME_RULES=./name.txt 1AKK.pdb The reason we specify the location is to force mcce to use our own renaming rules instead of the default one. This command generates step1_out.pdb which is required of step 2. If you want to know the help information and other options of this command: $ step1.py -h Step 2. Make side chain conformers \u00b6 This step makes alternative side chain locations and ionization states. $ step2.py This command generates step2_out.pdb which is required of step 3. If you want to know the help information and other options of this command: $ step2.py -h Step 3. Make energy table \u00b6 This step calculates conformer self energy and pairwise interaction table. $ step3.py This command generates opp files under energies/ folder and file head3.lst which are required of step 4. If you want to know the help information and other options of this command: $ step3.py -h Step 4. Simulate a titration with Monte Carlo sampling \u00b6 This setp simulates a titration and write out the conformation and ionization states of each side chain at various conditions. $ step4.py -i 0 -d 60 -t eh The occupancy table is in file fort.38. The net charge is in file sum_crg.out Eh is in file pK.out Results \u00b6 The pKa report is in file pK.out. $ cat pK.out Your will see the calculated Eh for heme is 247 mV To analyze the ionization energy of heme at the midpoint: $ mfe.py HEM+A0105_","title":"Em calculation"},{"location":"emexample/#calculate-em-of-heme-in-cytochrome","text":"Page last updated on: 2020-07-07","title":"Calculate Em of heme in Cytochrome"},{"location":"emexample/#background","text":"Cytochrome c is a small protein that transports electron in mitochondria to facilitate the synthesis of ATP. It redox potential plays an imprtant role in its function. The regulation of the Cytochrome C redox potential can be explained by Continuum Electrostatic analysis. Junjun Mao, Karin Hauser, and M. R. Gunner, How Cytochromes with Different Folds Control Heme Redox Potentials, Biochemistry 2003, 42, 33, 9829\u20139840 Cytochrome C from E. Caballus (PDB ID 1AKK) has an experimental Em of 260 mV.","title":"Background"},{"location":"emexample/#prepare-the-calculation","text":"After the program is installed and execution path is configured (see link for details), make a working directory and go to the working directory. MCCE will generate intermediate files and result files in the current directory, so it's best to prepare one directory for calculation on one structure. $ mkdir 1akk $ cd 1akk Then download pdb file 1AKK to the working directory: $ getpdb 1akk Inquiring the remote file 1AKK.pdb ... Saving as 1AKK.pdb ... Download completed.","title":"Prepare the calculation"},{"location":"emexample/#run-4-steps-of-mcce","text":"","title":"Run 4 steps of MCCE"},{"location":"emexample/#step-1-convert-pdb-file-into-mcce-pdb","text":"This step proof reads the structure file and cut terminal residues and complex cofactors into smaller ones if necessary. The heme in cytochrome C has two ligands HIS18 and MET80. They behave differently than HIS and MET so we have to rename them. Copy name.txt from the MCCE directoy to working directory. $ cp /path/to/mcce/name.txt ./ Your /path/to/mcce can be found by running $ var=`which mcce`; echo ${var%/*/*} Now that you have a name.txt in your working directory, add these two lines to ./name.txt: *****HIS** 18 *****HIL** 18 *****MET** 80 *****MEL** 80 Then run step 1: $ step1.py -u RENAME_RULES=./name.txt 1AKK.pdb The reason we specify the location is to force mcce to use our own renaming rules instead of the default one. This command generates step1_out.pdb which is required of step 2. If you want to know the help information and other options of this command: $ step1.py -h","title":"Step 1. Convert PDB file into MCCE PDB"},{"location":"emexample/#step-2-make-side-chain-conformers","text":"This step makes alternative side chain locations and ionization states. $ step2.py This command generates step2_out.pdb which is required of step 3. If you want to know the help information and other options of this command: $ step2.py -h","title":"Step 2. Make side chain conformers"},{"location":"emexample/#step-3-make-energy-table","text":"This step calculates conformer self energy and pairwise interaction table. $ step3.py This command generates opp files under energies/ folder and file head3.lst which are required of step 4. If you want to know the help information and other options of this command: $ step3.py -h","title":"Step 3. Make energy table"},{"location":"emexample/#step-4-simulate-a-titration-with-monte-carlo-sampling","text":"This setp simulates a titration and write out the conformation and ionization states of each side chain at various conditions. $ step4.py -i 0 -d 60 -t eh The occupancy table is in file fort.38. The net charge is in file sum_crg.out Eh is in file pK.out","title":"Step 4. Simulate a titration with Monte Carlo sampling"},{"location":"emexample/#results","text":"The pKa report is in file pK.out. $ cat pK.out Your will see the calculated Eh for heme is 247 mV To analyze the ionization energy of heme at the midpoint: $ mfe.py HEM+A0105_","title":"Results"},{"location":"hbexample/","text":"Compute hydrogen bond network \u00b6 Page last updated on: 2020-06-22 Hydrogen bond network obtained from MCCE is the hydrogen bonds existing in protein in Boltzmann distribution. The network helps reveal proton transclocation pathways, water pathways involving in the protein. The relative publication is on Cytochrome c Oxidase . Principle \u00b6 The hydrogen bond network in MCCE is obtained from microstates in Boltzmann Distribution in Monte Carlo sampling, based on defined D-H...D distance and angle, where D is the donor atom with a lone pair. Save microstates with Boltzmann Distribution in Monte Carlo sampling. Calculate all possible hydrogen bonds exist between residue conformers. A hydrogen bond matrix is obtatined. Coupling with microstates (Step 1) and hydrogen bond matrix (Step 2), hydrogen bonds selected in miscrostates in Monte Carlo sampling are calculated. Input \u00b6 Monte Carlo sampling microstates is obtained from energies and head3.lst . Hydrogen bond matrix is obtatined from step2_out.pdb and head3.lst . Selected hydrogen bond network is calculated based on hb.dat and microstate file, which is in ms_out folder. Output \u00b6 pH#eH#ms.txt under ms_out folder is generated for each pH and eH titration, where each file is named after titration point of pH and eH value following by 'ms'. Hydrogen bond matrix is saved in hb.dat and hah.txt , where hb.dat is a binary file and hah.txt is a readable txt file. hb.dat has 2D matrix with N * N, where N is the total conformer number in the protein. hah.txt stores the geometry infos for each hydrogen bond. resInHbNet.txt contains the all residues that can be involved in hydrogen bond network. reshbond.txt contains all possible bonds between residues. pH#eH#hb.txt under hb_out folder is obtained for each pH and eH titration, where each file is named after titration point of pH and eH value foloowing by 'hb'. File format \u00b6 pH#eH#ms.txt : Comment line and blank line are dismissed. Each file starts with headers, consist of monte carlo sampling unchanged information. Then it stores the new conformer id for each microstate, and its relative energy and times it stay at this microstate. First line : Temperature, pH, eH values Second line : Method to get microstate. Either MONTERUNS or ENUMERATE, representing from monte carlo sampling or analytical method Third line : n_fixed, the number of fixed residues for sampling. Following are the occupied conformer ids for each fixed residue, splitted by space. Fourth line : n_free, the number of free titrated residues that can get flipped during sampling. Follwing are all conformer ids, splitted by space for each free titrated residue, splitted by semicolon. For each Monte Carlo sampling : Fifth line : order of monte carlo sampling Fifth line : n_free, following occupied conformer id for each free titrated residue. This is the starting state for the sampling. The starting state will be decided by its energy to be accpeted or not. Sixth line : Energy of microstate, counter representing times the microstate stays, new conformer ids compared to last microstate. T:298.15,pH:7.00,eH:0.00 METHOD:MONTERUNS #N_FIXED:FIXED_CONF_ID 33:4 5 16 17 18 19 20 35 39 93 94 103 104 105 111 119 128 129 138 145 157 158 176 199 216 217 226 232 239 708 762 854 919 #N_FREE residues:CONF_IDs for each free residues 43:0 1 2 3 ;6 7 10 11 ;27 28 ;29 30 31 32 33 34 ; ... #EVERY MONTERUN START FROM A NEW STATE #MC:ITER_MONTERUNS #N_FREE: FREE_CONF_ID, #ENERGY, COUNT,NEW_CONF MC:0 43:1 7 28 31 48 53 56 61 92 106 121 137 140 147 156 167 175 178 183 222 227 234 241 256 269 327 351 383 417 449 472 502 542 552 583 728 769 804 882 945 1008 1059 1112 -93.403641,9, -93.274643,3,782 -93.646645,1,63 ... MC:1 43:0 7 28 30 48 50 55 60 92 106 127 137 140 146 156 167 175 178 183 222 227 235 245 256 269 327 342 373 417 449 472 502 542 546 594 729 791 797 901 941 1008 1059 1112 -92.401054,3, -91.990730,4,121 925 -93.319809,9,572 ... 2. hb.dat : - First integer(4 bite): n_conf, the total conformer number of the protein. - The following is n_conf * n_conf matrix where 1 represents a hydrogen bond and 0 no hydrogen bond. 3. hah.txt : - Conformer_id of Donor, Conformer_id of Acceptor, Donor Atom, ~ Hyrogen-- Acceptor Atom, Distance, Angle GLN01A0002_001 HOH01A0109_001 NE2~2HE2-- O 3.02 160 GLN01A0002_001 HOH01A0109_002 NE2~2HE2-- O 3.02 160 4. resInHbNet.txt : - residue_name involving hydrogen bond network META0001 GLNA0002 TYRA0003 LYSA0004 5. reshbond.txt : - Residue_name of Donor, Residue_name of Acceptor GLNA0002 HOHA0109 TYRA0003 META0001 TYRA0003 HOHA0070 TYRA0003 HOHA0132 6. pH#eH#hb.txt : - Donor Residue, Acceptro Residue, Occupancy of hydrogen bond in all microstates LYSA0050 META0001 1.000 LYSA0050 ASPA0047 1.000 GLNA0002 HOHA0109 0.750 LYSA0004 GLUA0015 1.000 Example \u00b6 Here is a tutorial to calculate the hydrogen bond network using MCCE and to visualize hydrogen bond network using Cytoscape. Parameter setting in run.prm: \u00b6 Output microstate in MCCE step 4. step 4: t Output Microstate from standard monte carlo (MS_OUT) Run Step 6 to get hydrogen bond network. \"(GET_HBOND_MATRIX)\" : obtain hydrogen bond matrix from step2_out.pdb and head3.lst. \"(HBOND_LOWER_LIMIT)\" : setting for (GET_HBOND_MATRIX). Hydrogen bond distance lower limit. \"(HBOND_UPPER_LIMIT)\" : setting for (GET_HBOND_MATRIX). Hydrogen bond distance upper limit. \"(HBOND_ANG_CUTOFF)\" : setting for (GET_HBOND_MATRIX). Hydrogen bond angle cutoff, only angle larger than the cutoff will be considered hydrogen bond. \"(GET_HBOND_NETWORK)\" : obtain hydrogen bond network in Botlzmann distribution based on hb.dat and microstate file. Hydrogen bond donor and acceptor attom parameters are setting in param04/hb.tpl . HDONOR ASP01 HD1 HDONOR ASP02 HD2 HACCEPT ASP01 OD1 OD2 HACCEPT ASP02 OD1 OD2 HACCEPT ASP-1 OD1 OD2 Default hydrogen bond definition in run.prm is: Step 6: t Obtain hydrogen bond matrix (GET_HBOND_MATRIX) 1.2 Lower limit of hydrogen bond H--B distance (HBOND_LOWER_LIMIT) 3.2 Upper limit of hydrogen bond H--B distance (HBOND_UPPER_LIMIT) 90.0 Angle cutoff of hydrogen bond (HBOND_ANG_CUTOFF) t Obtain hydrogen bond network (GET_HBOND_NETWORK) Output file after step 6: hb.txt if final hydrogen bond network. hb.dat, hah.txt, resInHbNet.txt, reshbonds.txt from (GET_HBOND_MATRIX) . hb.txt from (GET_HBOND_NETWORK) . Result Analysis: \u00b6 Cytoscape visualization: \u00b6 We are using Cytoscape for visualizing hydrogen bond networks. Download and install Cytoscape . Input file preparation for Cytoscape: \u00b6 hb.txt: hydrogen bond network with direct hydrogen bond between residues/waters, which is the direct output after MCCE. out.dat: aggrageted hydrogen bond network coupling with water for multiple hydrogen bond networks, which needs post-analysis based on hb.txt. Steps to get out.dat: \u00b6 Inputs : - Multiple hb.txt files: rename them as 1.dat, 2.dat, 3.dat etc. - Residues_list.lst: residues list selected. ARGA0019 ASPA0028 LYSA0027 TYRA0122 ASNA0025 Scripts : /home/cai/source/jlu_net20170830 - jhead.h: water molecules cutoff represents the maximum water number allowing to bridging hydrogen bond between residues. Here 4 is up to 4 water molecules are allowed to bridge between two residues. For example, if you want to see up to two water bridging hydrogen bond connections between two residues, then you can change 4 to 2. static int cutoff = 4; - jlu_new-cai.cpp: flags if output relevent files. const int flag_interest=0; //flag to study interested residues: T100 and E286 const int flag_matrix=1; //flag to output matrix of hb network const int flag_network=1; //flag to output network with donor, acceptor, occ const int flag_network_opt=1; //flag to output network with shorter name const int flag_map=1; //flag to output classification of amino acids in network const int flag_sif=1; //flag to output network with format of sif const int flag_cat_3s8f=0; //flag to sync the cofactor name to protein 3s8f.pdb in sifformat const int flag_cat_1m56=1; //flag to sync the cofactor name to protein 1m56.pdb in sifformat - jhead-test2.cpp - Makefile: a-4w.out in makefile, output name after compiling, can be changed. Here for up to 4 water, we write a-4w.out . Suppose for two water: change a-4w.out to a-2w.out make - a-4w.out Run scripts : ./a-4w.out Outputs : - out.txt: residue-residue hydrogen bond interacton, in a N * N matrix format - out.dat: residue-residue hydrogen bond interaction DONOR ACCEPT OCCUPANCY RA0019 DA0028 100 KA0027 NA0025 100 NA0025 DA0028 100 - out_opt.dat: residue-residue hydrogen bond interaction with opimal shorter residue name DONOR ACCEPT OCCUPANCY 19 28 100 27 25 100 25 28 100 - out.sif: residue residue hydrogen bond interaction, with the format that can be used to connect 3D structure with cytoscape using RINalyzer - out_map.dat: residue's amnio acid type classification RESIDUE CLASS FULL_NAME 19 B ARGA0019 28 A ASPA0028 27 B LYSA0027 - out_path.txt: water pathway that connect the two residues ARGA0019#####################ASPA0028 GET: ARGA0019, HOHS5631, ASPA0028, Here, water HOHS5631 helps bridge ARGA0019 - ASPA0028 hydrogen bond. Visualization on Cytoscape: \u00b6 Open out.dat file using the Cytoscape and play with different layout. Supplement \u00b6 Comparison between old and new hydrogen bond network \u00b6 Comparison between old and new format microstate file old_version new_version time 58s 1s size 246MB 27MB Comparison between old and new step 6 old_version new_version time 117s 87s","title":"Hydrogen-bond network"},{"location":"hbexample/#compute-hydrogen-bond-network","text":"Page last updated on: 2020-06-22 Hydrogen bond network obtained from MCCE is the hydrogen bonds existing in protein in Boltzmann distribution. The network helps reveal proton transclocation pathways, water pathways involving in the protein. The relative publication is on Cytochrome c Oxidase .","title":"Compute hydrogen bond network"},{"location":"hbexample/#principle","text":"The hydrogen bond network in MCCE is obtained from microstates in Boltzmann Distribution in Monte Carlo sampling, based on defined D-H...D distance and angle, where D is the donor atom with a lone pair. Save microstates with Boltzmann Distribution in Monte Carlo sampling. Calculate all possible hydrogen bonds exist between residue conformers. A hydrogen bond matrix is obtatined. Coupling with microstates (Step 1) and hydrogen bond matrix (Step 2), hydrogen bonds selected in miscrostates in Monte Carlo sampling are calculated.","title":"Principle"},{"location":"hbexample/#input","text":"Monte Carlo sampling microstates is obtained from energies and head3.lst . Hydrogen bond matrix is obtatined from step2_out.pdb and head3.lst . Selected hydrogen bond network is calculated based on hb.dat and microstate file, which is in ms_out folder.","title":"Input"},{"location":"hbexample/#output","text":"pH#eH#ms.txt under ms_out folder is generated for each pH and eH titration, where each file is named after titration point of pH and eH value following by 'ms'. Hydrogen bond matrix is saved in hb.dat and hah.txt , where hb.dat is a binary file and hah.txt is a readable txt file. hb.dat has 2D matrix with N * N, where N is the total conformer number in the protein. hah.txt stores the geometry infos for each hydrogen bond. resInHbNet.txt contains the all residues that can be involved in hydrogen bond network. reshbond.txt contains all possible bonds between residues. pH#eH#hb.txt under hb_out folder is obtained for each pH and eH titration, where each file is named after titration point of pH and eH value foloowing by 'hb'.","title":"Output"},{"location":"hbexample/#file-format","text":"pH#eH#ms.txt : Comment line and blank line are dismissed. Each file starts with headers, consist of monte carlo sampling unchanged information. Then it stores the new conformer id for each microstate, and its relative energy and times it stay at this microstate. First line : Temperature, pH, eH values Second line : Method to get microstate. Either MONTERUNS or ENUMERATE, representing from monte carlo sampling or analytical method Third line : n_fixed, the number of fixed residues for sampling. Following are the occupied conformer ids for each fixed residue, splitted by space. Fourth line : n_free, the number of free titrated residues that can get flipped during sampling. Follwing are all conformer ids, splitted by space for each free titrated residue, splitted by semicolon. For each Monte Carlo sampling : Fifth line : order of monte carlo sampling Fifth line : n_free, following occupied conformer id for each free titrated residue. This is the starting state for the sampling. The starting state will be decided by its energy to be accpeted or not. Sixth line : Energy of microstate, counter representing times the microstate stays, new conformer ids compared to last microstate. T:298.15,pH:7.00,eH:0.00 METHOD:MONTERUNS #N_FIXED:FIXED_CONF_ID 33:4 5 16 17 18 19 20 35 39 93 94 103 104 105 111 119 128 129 138 145 157 158 176 199 216 217 226 232 239 708 762 854 919 #N_FREE residues:CONF_IDs for each free residues 43:0 1 2 3 ;6 7 10 11 ;27 28 ;29 30 31 32 33 34 ; ... #EVERY MONTERUN START FROM A NEW STATE #MC:ITER_MONTERUNS #N_FREE: FREE_CONF_ID, #ENERGY, COUNT,NEW_CONF MC:0 43:1 7 28 31 48 53 56 61 92 106 121 137 140 147 156 167 175 178 183 222 227 234 241 256 269 327 351 383 417 449 472 502 542 552 583 728 769 804 882 945 1008 1059 1112 -93.403641,9, -93.274643,3,782 -93.646645,1,63 ... MC:1 43:0 7 28 30 48 50 55 60 92 106 127 137 140 146 156 167 175 178 183 222 227 235 245 256 269 327 342 373 417 449 472 502 542 546 594 729 791 797 901 941 1008 1059 1112 -92.401054,3, -91.990730,4,121 925 -93.319809,9,572 ... 2. hb.dat : - First integer(4 bite): n_conf, the total conformer number of the protein. - The following is n_conf * n_conf matrix where 1 represents a hydrogen bond and 0 no hydrogen bond. 3. hah.txt : - Conformer_id of Donor, Conformer_id of Acceptor, Donor Atom, ~ Hyrogen-- Acceptor Atom, Distance, Angle GLN01A0002_001 HOH01A0109_001 NE2~2HE2-- O 3.02 160 GLN01A0002_001 HOH01A0109_002 NE2~2HE2-- O 3.02 160 4. resInHbNet.txt : - residue_name involving hydrogen bond network META0001 GLNA0002 TYRA0003 LYSA0004 5. reshbond.txt : - Residue_name of Donor, Residue_name of Acceptor GLNA0002 HOHA0109 TYRA0003 META0001 TYRA0003 HOHA0070 TYRA0003 HOHA0132 6. pH#eH#hb.txt : - Donor Residue, Acceptro Residue, Occupancy of hydrogen bond in all microstates LYSA0050 META0001 1.000 LYSA0050 ASPA0047 1.000 GLNA0002 HOHA0109 0.750 LYSA0004 GLUA0015 1.000","title":"File format"},{"location":"hbexample/#example","text":"Here is a tutorial to calculate the hydrogen bond network using MCCE and to visualize hydrogen bond network using Cytoscape.","title":"Example"},{"location":"hbexample/#parameter-setting-in-runprm","text":"Output microstate in MCCE step 4. step 4: t Output Microstate from standard monte carlo (MS_OUT) Run Step 6 to get hydrogen bond network. \"(GET_HBOND_MATRIX)\" : obtain hydrogen bond matrix from step2_out.pdb and head3.lst. \"(HBOND_LOWER_LIMIT)\" : setting for (GET_HBOND_MATRIX). Hydrogen bond distance lower limit. \"(HBOND_UPPER_LIMIT)\" : setting for (GET_HBOND_MATRIX). Hydrogen bond distance upper limit. \"(HBOND_ANG_CUTOFF)\" : setting for (GET_HBOND_MATRIX). Hydrogen bond angle cutoff, only angle larger than the cutoff will be considered hydrogen bond. \"(GET_HBOND_NETWORK)\" : obtain hydrogen bond network in Botlzmann distribution based on hb.dat and microstate file. Hydrogen bond donor and acceptor attom parameters are setting in param04/hb.tpl . HDONOR ASP01 HD1 HDONOR ASP02 HD2 HACCEPT ASP01 OD1 OD2 HACCEPT ASP02 OD1 OD2 HACCEPT ASP-1 OD1 OD2 Default hydrogen bond definition in run.prm is: Step 6: t Obtain hydrogen bond matrix (GET_HBOND_MATRIX) 1.2 Lower limit of hydrogen bond H--B distance (HBOND_LOWER_LIMIT) 3.2 Upper limit of hydrogen bond H--B distance (HBOND_UPPER_LIMIT) 90.0 Angle cutoff of hydrogen bond (HBOND_ANG_CUTOFF) t Obtain hydrogen bond network (GET_HBOND_NETWORK) Output file after step 6: hb.txt if final hydrogen bond network. hb.dat, hah.txt, resInHbNet.txt, reshbonds.txt from (GET_HBOND_MATRIX) . hb.txt from (GET_HBOND_NETWORK) .","title":"Parameter setting in run.prm:"},{"location":"hbexample/#result-analysis","text":"","title":"Result Analysis:"},{"location":"hbexample/#cytoscape-visualization","text":"We are using Cytoscape for visualizing hydrogen bond networks. Download and install Cytoscape .","title":"Cytoscape visualization:"},{"location":"hbexample/#input-file-preparation-for-cytoscape","text":"hb.txt: hydrogen bond network with direct hydrogen bond between residues/waters, which is the direct output after MCCE. out.dat: aggrageted hydrogen bond network coupling with water for multiple hydrogen bond networks, which needs post-analysis based on hb.txt.","title":"Input file preparation for Cytoscape:"},{"location":"hbexample/#steps-to-get-outdat","text":"Inputs : - Multiple hb.txt files: rename them as 1.dat, 2.dat, 3.dat etc. - Residues_list.lst: residues list selected. ARGA0019 ASPA0028 LYSA0027 TYRA0122 ASNA0025 Scripts : /home/cai/source/jlu_net20170830 - jhead.h: water molecules cutoff represents the maximum water number allowing to bridging hydrogen bond between residues. Here 4 is up to 4 water molecules are allowed to bridge between two residues. For example, if you want to see up to two water bridging hydrogen bond connections between two residues, then you can change 4 to 2. static int cutoff = 4; - jlu_new-cai.cpp: flags if output relevent files. const int flag_interest=0; //flag to study interested residues: T100 and E286 const int flag_matrix=1; //flag to output matrix of hb network const int flag_network=1; //flag to output network with donor, acceptor, occ const int flag_network_opt=1; //flag to output network with shorter name const int flag_map=1; //flag to output classification of amino acids in network const int flag_sif=1; //flag to output network with format of sif const int flag_cat_3s8f=0; //flag to sync the cofactor name to protein 3s8f.pdb in sifformat const int flag_cat_1m56=1; //flag to sync the cofactor name to protein 1m56.pdb in sifformat - jhead-test2.cpp - Makefile: a-4w.out in makefile, output name after compiling, can be changed. Here for up to 4 water, we write a-4w.out . Suppose for two water: change a-4w.out to a-2w.out make - a-4w.out Run scripts : ./a-4w.out Outputs : - out.txt: residue-residue hydrogen bond interacton, in a N * N matrix format - out.dat: residue-residue hydrogen bond interaction DONOR ACCEPT OCCUPANCY RA0019 DA0028 100 KA0027 NA0025 100 NA0025 DA0028 100 - out_opt.dat: residue-residue hydrogen bond interaction with opimal shorter residue name DONOR ACCEPT OCCUPANCY 19 28 100 27 25 100 25 28 100 - out.sif: residue residue hydrogen bond interaction, with the format that can be used to connect 3D structure with cytoscape using RINalyzer - out_map.dat: residue's amnio acid type classification RESIDUE CLASS FULL_NAME 19 B ARGA0019 28 A ASPA0028 27 B LYSA0027 - out_path.txt: water pathway that connect the two residues ARGA0019#####################ASPA0028 GET: ARGA0019, HOHS5631, ASPA0028, Here, water HOHS5631 helps bridge ARGA0019 - ASPA0028 hydrogen bond.","title":"Steps to get out.dat:"},{"location":"hbexample/#visualization-on-cytoscape","text":"Open out.dat file using the Cytoscape and play with different layout.","title":"Visualization on Cytoscape:"},{"location":"hbexample/#supplement","text":"","title":"Supplement"},{"location":"hbexample/#comparison-between-old-and-new-hydrogen-bond-network","text":"Comparison between old and new format microstate file old_version new_version time 58s 1s size 246MB 27MB Comparison between old and new step 6 old_version new_version time 117s 87s","title":"Comparison between old and new hydrogen bond network"},{"location":"mcce2free/","text":"How to convert an existing mcce tpl file to free format tpl file? \u00b6 Page last updated on: 2020-07-07 There accumulated a big number of mcce tpl files (topology file of a molecule) which defines the conformers, atoms, connectivity and so on. Since mcce tpl file follows strict format, new mcce adopted a free format to save the same information. Follow these steps to convert an existing mcce tpl file to a new free format tpl file. This example is assuming you convert a mcce tpl file glu.tpl in param04 directory. Convert \u00b6 Run this command to convert mcce format to free format. $ bin/tpl-mcce2free.py param04/glu.tpl > glu.ftpl The above output file has most entries converted. Fix \"rxn\" record \u00b6 Then we can manually compile rxn values in CONFORMER records. First manually replace rxn= with rxn02= , rxn04= , rxn08= depending on the dielectric constant of the tpl file that was converted from. CONFORMER, GLU01: Em0= 0.0, pKa0= 0.00, ne= 0, nH= 0, rxn02= -6.410, rxn04= -3.100, rxn08= -1.390 Error check \u00b6 Now find the atom name difference, especially H atoms. PDB is using version 3 names and old mcce is using version 2 names. For GLU, the name comparison can be found at here . If you have a pdb file of the residue/ligand, we can test the ftpl file against that pdb file: $ bin/verify_tpl.py ftplfile pdbfile It will report any atoms that can not be loaded by the converted ftpl file definition. To change the name in ftpl file, glu.ftp for example: $ sed -i 's/1HB / HB2/g' glu.ftpl You can verify the ftpl file again after the change of names. Store in param directory \u00b6 Finally, place the tested ftpl file under MCCE distribution's \"param\" directory. The MCCE distribution directory is the (HOME) line in your run.prm.","title":"Convert mcce tpl file"},{"location":"mcce2free/#how-to-convert-an-existing-mcce-tpl-file-to-free-format-tpl-file","text":"Page last updated on: 2020-07-07 There accumulated a big number of mcce tpl files (topology file of a molecule) which defines the conformers, atoms, connectivity and so on. Since mcce tpl file follows strict format, new mcce adopted a free format to save the same information. Follow these steps to convert an existing mcce tpl file to a new free format tpl file. This example is assuming you convert a mcce tpl file glu.tpl in param04 directory.","title":"How to convert an existing mcce tpl file to free format tpl file?"},{"location":"mcce2free/#convert","text":"Run this command to convert mcce format to free format. $ bin/tpl-mcce2free.py param04/glu.tpl > glu.ftpl The above output file has most entries converted.","title":"Convert"},{"location":"mcce2free/#fix-rxn-record","text":"Then we can manually compile rxn values in CONFORMER records. First manually replace rxn= with rxn02= , rxn04= , rxn08= depending on the dielectric constant of the tpl file that was converted from. CONFORMER, GLU01: Em0= 0.0, pKa0= 0.00, ne= 0, nH= 0, rxn02= -6.410, rxn04= -3.100, rxn08= -1.390","title":"Fix \"rxn\" record"},{"location":"mcce2free/#error-check","text":"Now find the atom name difference, especially H atoms. PDB is using version 3 names and old mcce is using version 2 names. For GLU, the name comparison can be found at here . If you have a pdb file of the residue/ligand, we can test the ftpl file against that pdb file: $ bin/verify_tpl.py ftplfile pdbfile It will report any atoms that can not be loaded by the converted ftpl file definition. To change the name in ftpl file, glu.ftp for example: $ sed -i 's/1HB / HB2/g' glu.ftpl You can verify the ftpl file again after the change of names.","title":"Error check"},{"location":"mcce2free/#store-in-param-directory","text":"Finally, place the tested ftpl file under MCCE distribution's \"param\" directory. The MCCE distribution directory is the (HOME) line in your run.prm.","title":"Store in param directory"},{"location":"mfehowto/","text":"How to break down the energy of a residue ionization? \u00b6 Page last updated on: 2020-06-19 MCCE calculates theoretical pKas as well as explain why these residues have those pKas. Continuum Electrostatic interpretation of pKa \u00b6 Free energy and pKa \u00b6 An amino acid and conjugate base in equilibrium: $$ AH <=> A^- + H^+ $$ The free energy of the reaction has relationship with the equilibrium of: $$ \\Delta G = \\Delta G_0 + 2.303RT\\lg(\\frac{[A^- ][H^+ ]}{[HA]}) $$ At the equilibrium of midpoint where [A^- ] = [HA] [A^- ] = [HA] , therefore residue pKa is linked to the reaction free energy: $$ 0 = \\Delta G_0 + 2.303RT\\lg([H^+ ]) $$ pKa = -\\lg([H^+ ]) = \\frac{\\Delta G_0}{2.303RT} pKa = -\\lg([H^+ ]) = \\frac{\\Delta G_0}{2.303RT} The acids in solution and in protein \u00b6 We know the ionization energy in solution, which is represented by the solution pKa: \\begin{alignat*}{5} &AH\\quad &&\\xrightarrow{\\Delta G1}\\quad &&&A^- + H^+ \\quad\\quad\\quad &&&&in\\thinspace solution\\\\ &\\downarrow \\small{\\Delta G2}\\quad &&\\quad &&&\\downarrow \\small{\\Delta G3} \\quad\\quad\\quad &&&&\\\\ &[Protein] | AH\\quad &&\\xrightarrow{\\Delta G4}\\quad &&&[Protein'] | A^- + H^+ \\quad\\quad\\quad &&&&in\\thinspace protein \\end{alignat*} \\begin{alignat*}{5} &AH\\quad &&\\xrightarrow{\\Delta G1}\\quad &&&A^- + H^+ \\quad\\quad\\quad &&&&in\\thinspace solution\\\\ &\\downarrow \\small{\\Delta G2}\\quad &&\\quad &&&\\downarrow \\small{\\Delta G3} \\quad\\quad\\quad &&&&\\\\ &[Protein] | AH\\quad &&\\xrightarrow{\\Delta G4}\\quad &&&[Protein'] | A^- + H^+ \\quad\\quad\\quad &&&&in\\thinspace protein \\end{alignat*} {\\Delta G1} {\\Delta G1} is solution pKa, and {\\Delta G4} {\\Delta G4} is acid pKa in protein, what we are looking for. {\\Delta G2} {\\Delta G2} and {\\Delta G3} {\\Delta G3} involve the free energy of moving acid from solution to protein environment, interaction between the acid and the protein, and the interaction within the protein at AH AH and A^- A^- states. The desolvation energy, pairwise interactions are all calculated by continuum electrostatic methods. MCCE's way to compute pKa \u00b6 MCCE makes residues as independently ionizable pieces. All residues are given freedom to change conformation and ionization if possible. Residue pairwise interactions are precalculated. The choice of a residue being at which position and ionization state is statistically counted by Monte Carlo sampling. A pKa calculation is a simulated titration that carried out at multiple pH points. The residue charges change with pH, and their pKas are their midpoints determined by fitting the titration curve. Therefore the calculated pKa of a residue is a statistical result that came from the simultaneous interactions of many factors. To understand the pKa, we need to decipher the factors with the help of mean field energy analysis. Understanding the residue pKa and factors that affect pKa \u00b6 Mean field approximation \u00b6 The accurate interaction calculation is only possible at microstate level. At the end, what we know is the probability of a residue being at certain conformation and ionization. The interaction between residues calculated after Monte Carlo sampling os approximated by \"mean field\". For example, 4 possible interactions for a pair of acids could be: A_1H \\leftrightarrow A_2H \\tag{1} A_1H \\leftrightarrow A_2H \\tag{1} A_1H \\leftrightarrow A_2^- \\tag{2} A_1H \\leftrightarrow A_2^- \\tag{2} A_1^- \\leftrightarrow A_2H \\tag{3} A_1^- \\leftrightarrow A_2H \\tag{3} A_1^- \\leftrightarrow A_2^- \\tag{4} A_1^- \\leftrightarrow A_2^- \\tag{4} If MCCE sampled acids A1 A1 and A2 A2 are both at 50% ionization, after MOnte Carlo sampling, from the ionization rate alone, we could not know the interaction is 50% of (2) and 50% of (3), 50% of (1) and 50% of (4), or a mix. This is the limitation of mean fields energy analysis. Once we know the limitation, we can extract quite useful information of residue ionization. MFE energy terms \u00b6 Once step 4 is done, one can run mfe.py on a residue to break down the energy terms of a ionization free energy. The input residue has to be in file pK.out. For example, in lysozyme pKa calculation , we obtained pKa output file pK.out. $ cat pK.out pH pKa/Em n(slope) 1000*chi2 vdw0 vdw1 tors ebkb dsol offset pHpK0 EhEm0 -TS residues total NTR+A0001_ 5.095 0.985 0.015 -0.00 -0.01 -0.26 0.52 4.01 -0.95 -2.90 0.00 0.00 -0.11 0.29 LYS+A0001_ 9.593 0.998 0.027 -0.00 -0.00 0.00 0.15 0.46 0.29 -0.81 0.00 -0.00 -0.09 0.00 ARG+A0005_ 12.695 0.858 0.051 -0.01 -0.00 -0.00 -0.73 0.89 0.00 0.20 0.00 0.14 -0.35 0.14 GLU-A0007_ 3.192 0.944 0.010 -0.01 0.00 -0.19 -1.27 1.17 -0.22 1.56 0.00 0.30 -1.02 0.31 LYS+A0013_ 11.322 0.954 0.019 -0.00 -0.00 0.00 0.19 0.61 0.29 0.92 0.00 0.00 -2.01 0.00 ARG+A0014_ 13.330 0.934 0.004 -0.01 -0.00 0.00 0.07 -0.28 0.00 0.83 0.00 0.43 -0.60 0.44 HIS+A0015_ 6.816 0.988 0.065 -0.01 -0.01 0.00 1.44 1.33 -0.73 -0.16 0.00 0.36 -0.42 1.80 ASP-A0018_ 2.013 0.929 0.127 -0.01 -0.00 -0.16 -2.03 0.95 -0.62 2.74 0.00 0.40 -0.86 0.40 TYR-A0020_ 13.498 0.687 0.401 0.00 0.00 0.00 0.24 3.29 -0.37 -3.30 0.00 0.18 0.04 0.09 ARG+A0021_ 13.239 0.796 0.092 -0.01 -0.00 0.00 -0.09 0.11 0.00 0.74 0.00 0.28 -0.74 0.29 TYR-A0023_ 10.312 0.863 0.020 0.00 0.00 0.00 -1.17 1.98 -0.37 -0.11 0.00 0.29 -0.33 0.29 LYS+A0033_ 10.581 0.974 0.026 -0.00 -0.00 0.00 0.06 0.61 0.29 0.18 0.00 0.00 -1.09 0.05 GLU-A0035_ 5.133 0.880 1.144 -0.04 -0.01 -0.01 -1.26 2.16 -0.22 -0.38 0.00 0.26 -0.23 0.26 ARG+A0045_ 12.919 0.796 1.608 -0.03 -0.00 0.00 0.19 -0.32 0.00 0.42 0.00 0.45 -0.24 0.46 ASP-A0048_ 1.528 0.963 0.058 -0.01 0.00 -0.24 -2.52 3.22 -0.62 3.22 0.00 0.14 -3.01 0.17 ASP-A0052_ 3.330 0.859 0.170 -0.01 0.00 -0.10 -1.32 1.99 -0.62 1.42 0.00 0.46 -1.20 0.61 TYR-A0053_ >14.0 0.00 0.00 0.00 -1.70 4.45 -0.37 -3.80 0.00 0.00 8.03 6.61 ARG+A0061_ >14.0 -0.01 -0.00 0.00 0.69 0.15 0.00 1.50 0.00 0.42 -2.43 0.31 ASP-A0066_ 2.066 3.239 0.002 -0.01 0.02 -0.04 -5.30 7.34 -0.62 2.68 0.00 -0.11 -4.50 -0.55 ARG+A0068_ 13.604 0.768 0.028 0.12 1.81 0.16 0.29 -0.80 0.00 1.10 0.00 -0.19 -0.05 2.46 ARG+A0073_ 12.750 0.935 0.132 -0.01 -0.00 0.00 -0.12 0.10 0.00 0.25 0.00 0.35 -0.22 0.35 ASP-A0087_ 2.073 0.960 0.014 -0.02 0.01 -0.21 -1.88 1.24 -0.62 2.68 0.00 0.31 -1.18 0.31 LYS+A0096_ 10.631 0.831 0.307 -0.00 0.00 0.00 -1.52 1.26 0.29 0.23 0.00 0.00 -0.25 0.01 LYS+A0097_ 10.813 0.918 0.072 -0.00 -0.00 0.00 -0.27 0.07 0.29 0.41 0.00 0.00 -0.51 -0.00 ASP-A0101_ 3.988 1.009 0.010 -0.00 -0.05 -0.10 0.04 1.15 -0.62 0.76 0.00 0.57 -1.17 0.58 ARG+A0112_ 12.956 0.923 0.080 -0.01 -0.00 0.00 -0.27 0.77 0.00 0.46 0.00 0.55 -0.90 0.59 ARG+A0114_ 13.257 0.968 0.050 -0.01 -0.00 0.00 -0.09 -0.29 0.00 0.76 0.00 0.34 -0.35 0.35 LYS+A0116_ 9.554 0.941 0.042 -0.00 -0.00 0.00 0.12 0.43 0.29 -0.85 0.00 0.00 0.02 0.01 ASP-A0119_ 3.596 1.005 0.031 -0.01 0.00 -0.24 -1.08 1.95 -0.62 1.15 0.00 0.09 -1.15 0.09 ARG+A0125_ 13.083 0.915 0.005 -0.01 -0.00 -0.00 0.36 -0.18 0.00 0.58 0.00 0.45 -0.75 0.45 ARG+A0128_ 13.586 0.939 0.008 0.00 -0.00 0.00 0.08 -0.81 0.00 1.09 0.00 0.45 -0.36 0.45 CTR-A0129_ 2.464 0.905 0.072 -0.01 -0.01 -0.12 -0.06 1.66 0.00 1.29 0.00 0.49 -2.75 0.49 Now we would like to know why ASP52 has a low pKa of 3.33 $ mfe.py ASP-A0052_ -c 0.1 Residue ASP-A0052_ pKa/Em=3.33 ================================= Terms pH meV Kcal --------------------------------- vdw0 -0.01 -0.85 -0.02 vdw1 0.00 0.21 0.00 tors -0.10 -5.89 -0.14 ebkb -1.32 -76.87 -1.81 dsol 1.99 115.58 2.72 offset -0.62 -36.17 -0.85 pH&pK0 1.42 82.42 1.94 Eh&Em0 0.00 0.00 0.00 -TS 0.00 0.00 0.00 residues -1.20 -69.73 -1.64 ********************************* TOTAL 0.15 8.70 0.20 sum_crg ********************************* ASNA0044_ -0.44 -25.31 -0.59 0.00 ARGA0045_ -0.12 -6.74 -0.16 1.00 ASNA0046_ -0.16 -9.25 -0.22 0.00 ASPA0048_ 0.51 29.65 0.70 -0.96 SERA0050_ 0.12 7.04 0.17 0.00 GLNA0057_ 0.22 12.63 0.30 0.00 ASNA0059_ -0.99 -57.31 -1.35 0.00 ARGA0061_ -0.27 -15.65 -0.37 1.00 ASPA0066_ 0.39 22.84 0.54 -1.00 ARGA0112_ -0.19 -11.15 -0.26 1.00 ARGA0114_ -0.10 -5.86 -0.14 1.00 ================================= Program computes the ionization free energy, specifically, the free energy difference between the ionized ASP and the neutral ASP. If we don't specify pH, mfe.py uses the midpoint pH or Eh. Energy terms: vdw0: Van der Waals interaction within the residue. Since the vdw interaction is similar to ionized and neutral ASP, the contribution to \\Delta G \\Delta G of ionization is small. vdw1: Van der Waals interaction to the protein backbone. Again the contribution to pKa is usually small. tors: Side chain torsion energy. The contribution to pKa is usually small. ebkb: The protein backbone electrostatic interaction. The protein secondary structure especially helices have a dipole that may affect the ionized residue more than neutral form of the residue, therefore it could be a factor of pKa. dsolv: The desolvation energy. The ionized residue is less stabilized im protein than in solution. This makes the ionization inside protein harder and it links to a positive free energy to the reaction from neutral residue to ionized residue. offset: The is a system correction of pKa calibrated by benchmark. It captures the terms not counted by MCCE. pH&pK0: Solution pH effect to the ionization. It is environment pressure to the residue ionization. To an acid, low solution pH makes the ionization (releasing proton) easy so it contributes as a favorable energy. To a base, low pH makes ionization harder. When pH equals residue's solution pKa, the environment pH is at the balance point, where the contribution is 0. Eh&Em0: Environment Eh effect to redox reaction. This works similarily as pH&pK0. -TS: Entropy term. The number of rotamers of neutral and ionized residues generated by MCCE may be different. The effect of number of rotamers on two ionization states act like entropy. Since this may not be a desired effect, one can enable entropy correction in step 4, Monte Carlo sampling. If entropy correction is enabled in MC, the entropy effect has been eliminated and entropy should be set to 0 in MFE analysis. Program mfe.py is able to know how MC is done and handle this accordingly, or one can turn on or off in MFE manually. residues: Total pairwise interaction from other residues. Other residues may shift the ionization free energy depending on their dipole orentation and charge. TOTAL: Total free enegy of ionization reaction. It the sum of all above terms. Redisue breakdown: Individual residue contribution. This part is the breakdown of term residues . At the midpoint, [AH] = [A^-] [AH] = [A^-] . This means conformers of AH AH and conformers of A^- A^- strike a balance, and the transition energy \\Delta G \\Delta G between them is 0 under this condition. The value \\Delta G \\Delta G in pH unit also means how far away the pKa is from the solution pH. At the midpoint, \\Delta G = 0 \\Delta G = 0 and residue pKa is the same as envrionment pH. In the above example, ASP52 has low pH because a pretty big stabilization from ASN59. We can also do mfe anaylysis off the midpoint, for example at physiological pH about 7. The command option \"-p 7\" sets the mfe point. $ mfe.py ASP-A0052_ -c 0.1 -p 7 Residue ASP-A0052_ pKa/Em=3.33 ================================= Terms pH meV Kcal --------------------------------- vdw0 -0.02 -0.97 -0.02 vdw1 -0.01 -0.52 -0.01 tors -0.11 -6.30 -0.15 ebkb -1.32 -76.59 -1.80 dsol 1.97 114.53 2.69 offset -0.62 -36.17 -0.85 pH&pK0 -2.25 -130.60 -3.07 Eh&Em0 0.00 0.00 0.00 -TS 0.00 0.00 0.00 residues -1.81 -105.25 -2.47 ********************************* TOTAL -4.17 -241.87 -5.68 sum_crg ********************************* GLUA0035_ 0.85 49.08 1.15 -0.98 ASNA0044_ -1.00 -57.84 -1.36 0.00 ARGA0045_ -0.11 -6.28 -0.15 1.00 ASNA0046_ -0.85 -49.43 -1.16 0.00 ASPA0048_ 0.52 30.08 0.71 -1.00 SERA0050_ 0.13 7.43 0.17 0.00 GLNA0057_ 0.18 10.47 0.25 0.00 ASNA0059_ -1.20 -69.75 -1.64 0.00 ARGA0061_ -0.28 -16.15 -0.38 1.00 ASPA0066_ 0.40 22.96 0.54 -1.00 ARGA0112_ -0.20 -11.56 -0.27 1.00 ================================= We see ASP52 is surrounded by these polar residues.gets extra stabilization from ASN44 and ASN46 besides ASN59. The stabilization is bigger at pH 7. Actually the back calculated pKa 7-4.17=2.83 7-4.17=2.83 is lower than titrated value 3.33 3.33 , indicating extra stabilization at pH 7. With MFE analysis, one can quickly determine what residues affect the pKa most therefore identify the influential sites.","title":"Analyze ionization energy"},{"location":"mfehowto/#how-to-break-down-the-energy-of-a-residue-ionization","text":"Page last updated on: 2020-06-19 MCCE calculates theoretical pKas as well as explain why these residues have those pKas.","title":"How to break down the energy of a residue ionization?"},{"location":"mfehowto/#continuum-electrostatic-interpretation-of-pka","text":"","title":"Continuum Electrostatic interpretation of pKa"},{"location":"mfehowto/#free-energy-and-pka","text":"An amino acid and conjugate base in equilibrium: $$ AH <=> A^- + H^+ $$ The free energy of the reaction has relationship with the equilibrium of: $$ \\Delta G = \\Delta G_0 + 2.303RT\\lg(\\frac{[A^- ][H^+ ]}{[HA]}) $$ At the equilibrium of midpoint where [A^- ] = [HA] [A^- ] = [HA] , therefore residue pKa is linked to the reaction free energy: $$ 0 = \\Delta G_0 + 2.303RT\\lg([H^+ ]) $$ pKa = -\\lg([H^+ ]) = \\frac{\\Delta G_0}{2.303RT} pKa = -\\lg([H^+ ]) = \\frac{\\Delta G_0}{2.303RT}","title":"Free energy and pKa"},{"location":"mfehowto/#the-acids-in-solution-and-in-protein","text":"We know the ionization energy in solution, which is represented by the solution pKa: \\begin{alignat*}{5} &AH\\quad &&\\xrightarrow{\\Delta G1}\\quad &&&A^- + H^+ \\quad\\quad\\quad &&&&in\\thinspace solution\\\\ &\\downarrow \\small{\\Delta G2}\\quad &&\\quad &&&\\downarrow \\small{\\Delta G3} \\quad\\quad\\quad &&&&\\\\ &[Protein] | AH\\quad &&\\xrightarrow{\\Delta G4}\\quad &&&[Protein'] | A^- + H^+ \\quad\\quad\\quad &&&&in\\thinspace protein \\end{alignat*} \\begin{alignat*}{5} &AH\\quad &&\\xrightarrow{\\Delta G1}\\quad &&&A^- + H^+ \\quad\\quad\\quad &&&&in\\thinspace solution\\\\ &\\downarrow \\small{\\Delta G2}\\quad &&\\quad &&&\\downarrow \\small{\\Delta G3} \\quad\\quad\\quad &&&&\\\\ &[Protein] | AH\\quad &&\\xrightarrow{\\Delta G4}\\quad &&&[Protein'] | A^- + H^+ \\quad\\quad\\quad &&&&in\\thinspace protein \\end{alignat*} {\\Delta G1} {\\Delta G1} is solution pKa, and {\\Delta G4} {\\Delta G4} is acid pKa in protein, what we are looking for. {\\Delta G2} {\\Delta G2} and {\\Delta G3} {\\Delta G3} involve the free energy of moving acid from solution to protein environment, interaction between the acid and the protein, and the interaction within the protein at AH AH and A^- A^- states. The desolvation energy, pairwise interactions are all calculated by continuum electrostatic methods.","title":"The acids in solution and in protein"},{"location":"mfehowto/#mcces-way-to-compute-pka","text":"MCCE makes residues as independently ionizable pieces. All residues are given freedom to change conformation and ionization if possible. Residue pairwise interactions are precalculated. The choice of a residue being at which position and ionization state is statistically counted by Monte Carlo sampling. A pKa calculation is a simulated titration that carried out at multiple pH points. The residue charges change with pH, and their pKas are their midpoints determined by fitting the titration curve. Therefore the calculated pKa of a residue is a statistical result that came from the simultaneous interactions of many factors. To understand the pKa, we need to decipher the factors with the help of mean field energy analysis.","title":"MCCE's way to compute pKa"},{"location":"mfehowto/#understanding-the-residue-pka-and-factors-that-affect-pka","text":"","title":"Understanding the residue pKa and factors that affect pKa"},{"location":"mfehowto/#mean-field-approximation","text":"The accurate interaction calculation is only possible at microstate level. At the end, what we know is the probability of a residue being at certain conformation and ionization. The interaction between residues calculated after Monte Carlo sampling os approximated by \"mean field\". For example, 4 possible interactions for a pair of acids could be: A_1H \\leftrightarrow A_2H \\tag{1} A_1H \\leftrightarrow A_2H \\tag{1} A_1H \\leftrightarrow A_2^- \\tag{2} A_1H \\leftrightarrow A_2^- \\tag{2} A_1^- \\leftrightarrow A_2H \\tag{3} A_1^- \\leftrightarrow A_2H \\tag{3} A_1^- \\leftrightarrow A_2^- \\tag{4} A_1^- \\leftrightarrow A_2^- \\tag{4} If MCCE sampled acids A1 A1 and A2 A2 are both at 50% ionization, after MOnte Carlo sampling, from the ionization rate alone, we could not know the interaction is 50% of (2) and 50% of (3), 50% of (1) and 50% of (4), or a mix. This is the limitation of mean fields energy analysis. Once we know the limitation, we can extract quite useful information of residue ionization.","title":"Mean field approximation"},{"location":"mfehowto/#mfe-energy-terms","text":"Once step 4 is done, one can run mfe.py on a residue to break down the energy terms of a ionization free energy. The input residue has to be in file pK.out. For example, in lysozyme pKa calculation , we obtained pKa output file pK.out. $ cat pK.out pH pKa/Em n(slope) 1000*chi2 vdw0 vdw1 tors ebkb dsol offset pHpK0 EhEm0 -TS residues total NTR+A0001_ 5.095 0.985 0.015 -0.00 -0.01 -0.26 0.52 4.01 -0.95 -2.90 0.00 0.00 -0.11 0.29 LYS+A0001_ 9.593 0.998 0.027 -0.00 -0.00 0.00 0.15 0.46 0.29 -0.81 0.00 -0.00 -0.09 0.00 ARG+A0005_ 12.695 0.858 0.051 -0.01 -0.00 -0.00 -0.73 0.89 0.00 0.20 0.00 0.14 -0.35 0.14 GLU-A0007_ 3.192 0.944 0.010 -0.01 0.00 -0.19 -1.27 1.17 -0.22 1.56 0.00 0.30 -1.02 0.31 LYS+A0013_ 11.322 0.954 0.019 -0.00 -0.00 0.00 0.19 0.61 0.29 0.92 0.00 0.00 -2.01 0.00 ARG+A0014_ 13.330 0.934 0.004 -0.01 -0.00 0.00 0.07 -0.28 0.00 0.83 0.00 0.43 -0.60 0.44 HIS+A0015_ 6.816 0.988 0.065 -0.01 -0.01 0.00 1.44 1.33 -0.73 -0.16 0.00 0.36 -0.42 1.80 ASP-A0018_ 2.013 0.929 0.127 -0.01 -0.00 -0.16 -2.03 0.95 -0.62 2.74 0.00 0.40 -0.86 0.40 TYR-A0020_ 13.498 0.687 0.401 0.00 0.00 0.00 0.24 3.29 -0.37 -3.30 0.00 0.18 0.04 0.09 ARG+A0021_ 13.239 0.796 0.092 -0.01 -0.00 0.00 -0.09 0.11 0.00 0.74 0.00 0.28 -0.74 0.29 TYR-A0023_ 10.312 0.863 0.020 0.00 0.00 0.00 -1.17 1.98 -0.37 -0.11 0.00 0.29 -0.33 0.29 LYS+A0033_ 10.581 0.974 0.026 -0.00 -0.00 0.00 0.06 0.61 0.29 0.18 0.00 0.00 -1.09 0.05 GLU-A0035_ 5.133 0.880 1.144 -0.04 -0.01 -0.01 -1.26 2.16 -0.22 -0.38 0.00 0.26 -0.23 0.26 ARG+A0045_ 12.919 0.796 1.608 -0.03 -0.00 0.00 0.19 -0.32 0.00 0.42 0.00 0.45 -0.24 0.46 ASP-A0048_ 1.528 0.963 0.058 -0.01 0.00 -0.24 -2.52 3.22 -0.62 3.22 0.00 0.14 -3.01 0.17 ASP-A0052_ 3.330 0.859 0.170 -0.01 0.00 -0.10 -1.32 1.99 -0.62 1.42 0.00 0.46 -1.20 0.61 TYR-A0053_ >14.0 0.00 0.00 0.00 -1.70 4.45 -0.37 -3.80 0.00 0.00 8.03 6.61 ARG+A0061_ >14.0 -0.01 -0.00 0.00 0.69 0.15 0.00 1.50 0.00 0.42 -2.43 0.31 ASP-A0066_ 2.066 3.239 0.002 -0.01 0.02 -0.04 -5.30 7.34 -0.62 2.68 0.00 -0.11 -4.50 -0.55 ARG+A0068_ 13.604 0.768 0.028 0.12 1.81 0.16 0.29 -0.80 0.00 1.10 0.00 -0.19 -0.05 2.46 ARG+A0073_ 12.750 0.935 0.132 -0.01 -0.00 0.00 -0.12 0.10 0.00 0.25 0.00 0.35 -0.22 0.35 ASP-A0087_ 2.073 0.960 0.014 -0.02 0.01 -0.21 -1.88 1.24 -0.62 2.68 0.00 0.31 -1.18 0.31 LYS+A0096_ 10.631 0.831 0.307 -0.00 0.00 0.00 -1.52 1.26 0.29 0.23 0.00 0.00 -0.25 0.01 LYS+A0097_ 10.813 0.918 0.072 -0.00 -0.00 0.00 -0.27 0.07 0.29 0.41 0.00 0.00 -0.51 -0.00 ASP-A0101_ 3.988 1.009 0.010 -0.00 -0.05 -0.10 0.04 1.15 -0.62 0.76 0.00 0.57 -1.17 0.58 ARG+A0112_ 12.956 0.923 0.080 -0.01 -0.00 0.00 -0.27 0.77 0.00 0.46 0.00 0.55 -0.90 0.59 ARG+A0114_ 13.257 0.968 0.050 -0.01 -0.00 0.00 -0.09 -0.29 0.00 0.76 0.00 0.34 -0.35 0.35 LYS+A0116_ 9.554 0.941 0.042 -0.00 -0.00 0.00 0.12 0.43 0.29 -0.85 0.00 0.00 0.02 0.01 ASP-A0119_ 3.596 1.005 0.031 -0.01 0.00 -0.24 -1.08 1.95 -0.62 1.15 0.00 0.09 -1.15 0.09 ARG+A0125_ 13.083 0.915 0.005 -0.01 -0.00 -0.00 0.36 -0.18 0.00 0.58 0.00 0.45 -0.75 0.45 ARG+A0128_ 13.586 0.939 0.008 0.00 -0.00 0.00 0.08 -0.81 0.00 1.09 0.00 0.45 -0.36 0.45 CTR-A0129_ 2.464 0.905 0.072 -0.01 -0.01 -0.12 -0.06 1.66 0.00 1.29 0.00 0.49 -2.75 0.49 Now we would like to know why ASP52 has a low pKa of 3.33 $ mfe.py ASP-A0052_ -c 0.1 Residue ASP-A0052_ pKa/Em=3.33 ================================= Terms pH meV Kcal --------------------------------- vdw0 -0.01 -0.85 -0.02 vdw1 0.00 0.21 0.00 tors -0.10 -5.89 -0.14 ebkb -1.32 -76.87 -1.81 dsol 1.99 115.58 2.72 offset -0.62 -36.17 -0.85 pH&pK0 1.42 82.42 1.94 Eh&Em0 0.00 0.00 0.00 -TS 0.00 0.00 0.00 residues -1.20 -69.73 -1.64 ********************************* TOTAL 0.15 8.70 0.20 sum_crg ********************************* ASNA0044_ -0.44 -25.31 -0.59 0.00 ARGA0045_ -0.12 -6.74 -0.16 1.00 ASNA0046_ -0.16 -9.25 -0.22 0.00 ASPA0048_ 0.51 29.65 0.70 -0.96 SERA0050_ 0.12 7.04 0.17 0.00 GLNA0057_ 0.22 12.63 0.30 0.00 ASNA0059_ -0.99 -57.31 -1.35 0.00 ARGA0061_ -0.27 -15.65 -0.37 1.00 ASPA0066_ 0.39 22.84 0.54 -1.00 ARGA0112_ -0.19 -11.15 -0.26 1.00 ARGA0114_ -0.10 -5.86 -0.14 1.00 ================================= Program computes the ionization free energy, specifically, the free energy difference between the ionized ASP and the neutral ASP. If we don't specify pH, mfe.py uses the midpoint pH or Eh. Energy terms: vdw0: Van der Waals interaction within the residue. Since the vdw interaction is similar to ionized and neutral ASP, the contribution to \\Delta G \\Delta G of ionization is small. vdw1: Van der Waals interaction to the protein backbone. Again the contribution to pKa is usually small. tors: Side chain torsion energy. The contribution to pKa is usually small. ebkb: The protein backbone electrostatic interaction. The protein secondary structure especially helices have a dipole that may affect the ionized residue more than neutral form of the residue, therefore it could be a factor of pKa. dsolv: The desolvation energy. The ionized residue is less stabilized im protein than in solution. This makes the ionization inside protein harder and it links to a positive free energy to the reaction from neutral residue to ionized residue. offset: The is a system correction of pKa calibrated by benchmark. It captures the terms not counted by MCCE. pH&pK0: Solution pH effect to the ionization. It is environment pressure to the residue ionization. To an acid, low solution pH makes the ionization (releasing proton) easy so it contributes as a favorable energy. To a base, low pH makes ionization harder. When pH equals residue's solution pKa, the environment pH is at the balance point, where the contribution is 0. Eh&Em0: Environment Eh effect to redox reaction. This works similarily as pH&pK0. -TS: Entropy term. The number of rotamers of neutral and ionized residues generated by MCCE may be different. The effect of number of rotamers on two ionization states act like entropy. Since this may not be a desired effect, one can enable entropy correction in step 4, Monte Carlo sampling. If entropy correction is enabled in MC, the entropy effect has been eliminated and entropy should be set to 0 in MFE analysis. Program mfe.py is able to know how MC is done and handle this accordingly, or one can turn on or off in MFE manually. residues: Total pairwise interaction from other residues. Other residues may shift the ionization free energy depending on their dipole orentation and charge. TOTAL: Total free enegy of ionization reaction. It the sum of all above terms. Redisue breakdown: Individual residue contribution. This part is the breakdown of term residues . At the midpoint, [AH] = [A^-] [AH] = [A^-] . This means conformers of AH AH and conformers of A^- A^- strike a balance, and the transition energy \\Delta G \\Delta G between them is 0 under this condition. The value \\Delta G \\Delta G in pH unit also means how far away the pKa is from the solution pH. At the midpoint, \\Delta G = 0 \\Delta G = 0 and residue pKa is the same as envrionment pH. In the above example, ASP52 has low pH because a pretty big stabilization from ASN59. We can also do mfe anaylysis off the midpoint, for example at physiological pH about 7. The command option \"-p 7\" sets the mfe point. $ mfe.py ASP-A0052_ -c 0.1 -p 7 Residue ASP-A0052_ pKa/Em=3.33 ================================= Terms pH meV Kcal --------------------------------- vdw0 -0.02 -0.97 -0.02 vdw1 -0.01 -0.52 -0.01 tors -0.11 -6.30 -0.15 ebkb -1.32 -76.59 -1.80 dsol 1.97 114.53 2.69 offset -0.62 -36.17 -0.85 pH&pK0 -2.25 -130.60 -3.07 Eh&Em0 0.00 0.00 0.00 -TS 0.00 0.00 0.00 residues -1.81 -105.25 -2.47 ********************************* TOTAL -4.17 -241.87 -5.68 sum_crg ********************************* GLUA0035_ 0.85 49.08 1.15 -0.98 ASNA0044_ -1.00 -57.84 -1.36 0.00 ARGA0045_ -0.11 -6.28 -0.15 1.00 ASNA0046_ -0.85 -49.43 -1.16 0.00 ASPA0048_ 0.52 30.08 0.71 -1.00 SERA0050_ 0.13 7.43 0.17 0.00 GLNA0057_ 0.18 10.47 0.25 0.00 ASNA0059_ -1.20 -69.75 -1.64 0.00 ARGA0061_ -0.28 -16.15 -0.38 1.00 ASPA0066_ 0.40 22.96 0.54 -1.00 ARGA0112_ -0.20 -11.56 -0.27 1.00 ================================= We see ASP52 is surrounded by these polar residues.gets extra stabilization from ASN44 and ASN46 besides ASN59. The stabilization is bigger at pH 7. Actually the back calculated pKa 7-4.17=2.83 7-4.17=2.83 is lower than titrated value 3.33 3.33 , indicating extra stabilization at pH 7. With MFE analysis, one can quickly determine what residues affect the pKa most therefore identify the influential sites.","title":"MFE energy terms"},{"location":"newftpl/","text":"How to make a new topology file? \u00b6 Page last updated on: 2020-07-07 Topology file defines a molecule, including the atom connectivity, atom charge and radius, how conformers are made etc. General format of ftpl file \u00b6 The format of free format tpl file is simple. It is simply a key value pair separated by \":\". The key can be up to three fields, separated by \",\". The first key field is primary key, describing what kind of record it is, and the other two keys are supplementary, describing what molecule/conformer/atom it belongs to. The Value is a string, and will be processed by the mcce program in the context of key. If a space is a part of the key or value, it must be quoted inside double quotes. \":\", \",\" and \"#\" are reserved, and can not be used as part of key and value. The following is an example: Any text after \"#\" is considered comment. Any line that doesn't have \":\" is considered as comment CONNECT, \" N \", GLUBK: sp2, \" ? \", \" CA \", \" H \" MCCE reads in lines from ftpl files and save them in a single database. The content in multiple ftpl files are compiled into the database. Therefore one ftpl file can define multiple residues, and one residue parameter lines can be spread in multiple files. If the same key appears more than once, only the value of the last one is valid. This means the previous loaded value under this key will be overwritten. The order of reading ftpl files is alphabetic order of the file names. Reference of ftpl records \u00b6 Conformer list \u00b6 Example: CONFLIST, GLU: GLUBK, GLU01, GLU02, GLU-1 This is a required parameter for a molecule This parameter tells MCCE that residue GLU has 4 conformers. A conformer is named in as a 3-char residue name + 2-char conformer label. The conformer that ends with BK is a special backbone conformer. The atoms of the backbone conformerdo not change charge and protonation states. They and the atoms of one of the other side chain conformers make up the residue. In addition backbone conformers of all residues are grouped into one big chunck for energy calculation. Conformers other than backbone conformer are side chain conformers. They differ with each other by atom charge, bond connection, or proton number. Another special type conformer ends with \"DM\" as a convention name. The \"DM\" is not required. It has 0 atoms (no matching CONNECT parameters), and it represents the absence of this conformer, such as water leaving the site. Atom and bonds \u00b6 Example: CONNECT, \" N \", GLUBK: sp2, \" ? \", \" CA \", \" H \" CONNECT, \" H \", GLUBK: s, \" N \" CONNECT, \" CA \", GLUBK: sp3, \" N \", \" C \", \" CB \", \" HA \" CONNECT, \" HA \", GLUBK: s, \" CA \" CONNECT, \" C \", GLUBK: sp2, \" CA \", \" O \", \" ? \" CONNECT, \" O \", GLUBK: sp2, \" C \" CONNECT, \" CB \", GLU01: sp3, \" CA \", \" CG \", \" HB2\", \" HB3\" CONNECT, \" HB2\", GLU01: s, \" CB \" CONNECT, \" HB3\", GLU01: s, \" CB \" CONNECT, \" CG \", GLU01: sp3, \" CB \", \" CD \", \" HG2\", \" HG3\" CONNECT, \" HG2\", GLU01: s, \" CG \" CONNECT, \" HG3\", GLU01: s, \" CG \" CONNECT, \" CD \", GLU01: sp2, \" CG \", \" OE1\", \" OE2\" CONNECT, \" OE1\", GLU01: sp3, \" CD \", \" HE1\" CONNECT, \" HE1\", GLU01: s, \" OE1\" CONNECT, \" OE2\", GLU01: s, \" CD \" CONNECT, \" CB \", GLU02: sp3, \" CA \", \" CG \", \" HB2\", \" HB3\" CONNECT, \" HB2\", GLU02: s, \" CB \" CONNECT, \" HB3\", GLU02: s, \" CB \" CONNECT, \" CG \", GLU02: sp3, \" CB \", \" CD \", \" HG2\", \" HG3\" CONNECT, \" HG2\", GLU02: s, \" CG \" CONNECT, \" HG3\", GLU02: s, \" CG \" CONNECT, \" CD \", GLU02: sp2, \" CG \", \" OE1\", \" OE2\" CONNECT, \" OE1\", GLU02: s, \" CD \" CONNECT, \" OE2\", GLU02: sp3, \" CD \", \" HE2\" CONNECT, \" HE2\", GLU02: sp3, \" OE2\" CONNECT, \" CB \", GLU-1: sp3, \" CA \", \" CG \", \" HB2\", \" HB3\" CONNECT, \" HB2\", GLU-1: s, \" CB \" CONNECT, \" HB3\", GLU-1: s, \" CB \" CONNECT, \" CG \", GLU-1: sp3, \" CB \", \" CD \", \" HG2\", \" HG3\" CONNECT, \" HG2\", GLU-1: s, \" CG \" CONNECT, \" HG3\", GLU-1: s, \" CG \" CONNECT, \" CD \", GLU-1: sp2, \" CG \", \" OE1\", \" OE2\" CONNECT, \" OE1\", GLU-1: sp2, \" CD \" CONNECT, \" OE2\", GLU-1: sp2, \" CD \" CONNECT parameters define three things for a conformer: the atom names, bond geometry, and bonds. If none CONNECT parameters exist for a conformer, that conformer is a \"dummy\" conformer, representing the absence of the atoms/molecule. The keys are: parameter name, atom name, and conformer name, in this order. The value starts with atom orbital hybridization, which defines the bond angles and bond numbers, then the atoms that are bonded. For a single atom molecule, or an atom that are not connected to other atoms, use \"ion\" as the orbital type. The atom names need to be enclosed in quotations so the spaces will be counted. Atom charges \u00b6 CHARGE, GLUBK, \" N \": -0.350 CHARGE, GLUBK, \" H \": 0.250 CHARGE, GLUBK, \" CA \": 0.100 CHARGE, GLUBK, \" HA \": 0.000 CHARGE, GLUBK, \" C \": 0.550 CHARGE, GLUBK, \" O \": -0.550 CHARGE, GLU01, \" CB \": 0.000 CHARGE, GLU01, \" HB2\": 0.000 CHARGE, GLU01, \" HB3\": 0.000 CHARGE, GLU01, \" CG \": 0.000 CHARGE, GLU01, \" HG2\": 0.000 CHARGE, GLU01, \" HG3\": 0.000 CHARGE, GLU01, \" CD \": 0.550 CHARGE, GLU01, \" OE1\": -0.495 CHARGE, GLU01, \" HE1\": 0.435 CHARGE, GLU01, \" OE2\": -0.490 CHARGE, GLU02, \" CB \": 0.000 CHARGE, GLU02, \" HB2\": 0.000 CHARGE, GLU02, \" HB3\": 0.000 CHARGE, GLU02, \" CG \": 0.000 CHARGE, GLU02, \" HG2\": 0.000 CHARGE, GLU02, \" HG3\": 0.000 CHARGE, GLU02, \" CD \": 0.550 CHARGE, GLU02, \" OE1\": -0.490 CHARGE, GLU02, \" OE2\": -0.495 CHARGE, GLU02, \" HE2\": 0.435 CHARGE, GLU-1, \" CB \": 0.000 CHARGE, GLU-1, \" HB2\": 0.000 CHARGE, GLU-1, \" HB3\": 0.000 CHARGE, GLU-1, \" CG \": 0.000 CHARGE, GLU-1, \" HG2\": 0.000 CHARGE, GLU-1, \" HG3\": 0.000 CHARGE, GLU-1, \" CD \": 0.100 CHARGE, GLU-1, \" OE1\": -0.550 CHARGE, GLU-1, \" OE2\": -0.550 This parameter defines the charge of an atom in a conformer. The same atom in a molecule may have different charge depending on its bond status, protonation states, and ionization states. The key is the parameter name, conformer name and atom name. and the value is the atomic charge. If a CHARGE parameter is missing for an atom, a 0 charge is assumed. Atom radius \u00b6 Example: RADIUS, GLUBK, \" N \": 1.500, 1.750, 0.160 RADIUS, GLUBK, \" H \": 1.000, 1.000, 0.020 RADIUS, GLUBK, \" CA \": 2.000, 2.000, 0.150 RADIUS, GLUBK, \" HA \": 0.000, 1.000, 0.020 RADIUS, GLUBK, \" C \": 1.700, 2.000, 0.150 RADIUS, GLUBK, \" O \": 1.400, 1.600, 0.200 RADIUS, GLU01, \" CB \": 2.000, 2.000, 0.150 RADIUS, GLU01, \" HB2\": 0.000, 1.000, 0.020 RADIUS, GLU01, \" HB3\": 0.000, 1.000, 0.020 RADIUS, GLU01, \" CG \": 2.000, 2.000, 0.150 RADIUS, GLU01, \" HG2\": 0.000, 1.000, 0.020 RADIUS, GLU01, \" HG3\": 0.000, 1.000, 0.020 RADIUS, GLU01, \" CD \": 1.700, 2.000, 0.150 RADIUS, GLU01, \" OE1\": 1.400, 1.600, 0.200 RADIUS, GLU01, \" HE1\": 1.000, 1.000, 0.020 RADIUS, GLU01, \" OE2\": 1.400, 1.600, 0.200 RADIUS, GLU02, \" CB \": 2.000, 2.000, 0.150 RADIUS, GLU02, \" HB2\": 0.000, 1.000, 0.020 RADIUS, GLU02, \" HB3\": 0.000, 1.000, 0.020 RADIUS, GLU02, \" CG \": 2.000, 2.000, 0.150 RADIUS, GLU02, \" HG2\": 0.000, 1.000, 0.020 RADIUS, GLU02, \" HG3\": 0.000, 1.000, 0.020 RADIUS, GLU02, \" CD \": 1.700, 2.000, 0.150 RADIUS, GLU02, \" OE1\": 1.400, 1.600, 0.200 RADIUS, GLU02, \" OE2\": 1.400, 1.600, 0.200 RADIUS, GLU02, \" HE2\": 1.000, 1.000, 0.020 RADIUS, GLU-1, \" CB \": 2.000, 2.000, 0.150 RADIUS, GLU-1, \" HB2\": 0.000, 1.000, 0.020 RADIUS, GLU-1, \" HB3\": 0.000, 1.000, 0.020 RADIUS, GLU-1, \" CG \": 2.000, 2.000, 0.150 RADIUS, GLU-1, \" HG2\": 0.000, 1.000, 0.020 RADIUS, GLU-1, \" HG3\": 0.000, 1.000, 0.020 RADIUS, GLU-1, \" CD \": 1.700, 2.000, 0.150 RADIUS, GLU-1, \" OE1\": 1.400, 1.600, 0.200 RADIUS, GLU-1, \" OE2\": 1.400, 1.600, 0.200 The radius parameter includes both the dielelctric boundary radius, and VDW radius plus energy well depth. The key is the parameter name, conformer name and atom name. The value has three fields. They are radius for defining dielectric boundary, and the radius and energy well depth to caculate Van der Waals energy. Conformer parameters \u00b6 Example: CONFORMER, GLU01: Em0= 0.0, pKa0= 0.00, ne= 0, nH= 0, rxn02 = -6.41, rxn04= -3.100, rxn08= -1.39 CONFORMER, GLU02: Em0= 0.0, pKa0= 0.00, ne= 0, nH= 0, rxn02 = -6.44, rxn04= -3.100, rxn08= -1.39 CONFORMER, GLU-1: Em0= 0.0, pKa0= 4.75, ne= 0, nH=-1, rxn02 =-41.76, rxn04=-20.200, rxn08= -9.59 Each conformer defined in CONFLIST except backbone and dummy conformers should have a line in this section. It defines some necessary conformer properties. The key is parameter name and conformer. The value consists fields separated by commas. Each field is a key value pair. Em0: Redox titration midpoint potential of the molecule in solution. pKa0: pH titration mid point of the molecule in solution ne: relative number of electrons. For a redox reaction, the ground state has ne = 0, the excited state has a ne of none 0. nH: relative number of protons. For a protonation reaction, the ground state has nH = 0, charged acid loses a proton so nH = -1 and charged base gains a proton so nH = 1. rxn02: reference reaction field energy at dielectric constant 2. rxn04: reference reaction field energy at dielectric constant 4. rxn08: reference reaction field energy at dielectric constant 8. Rotatable bonds \u00b6 Example: ROTATE, GLU: \" CA \" - \" CB \", \" CB \" - \" CG \", \" CG \" - \" CD \" This is an optional parameter. The key is parameter name and residue name. Different conformer types are not configured to have different bond rotations. The key is a series of rotatable bonds. Each rotatable bond is defined by two atoms, and these two atoms are directional. The direction means when a bond rotation is made, the first atom is stationary, and the second atom and all atoms connected to it in that direction will all rotate accordingly. How to make a new ftpl file \u00b6 Although one can manually write all the parameter lines in ftpl file. There are tools to help making ftpl file much easier. Make ftpl file template \u00b6 If you have a pdb file, you can build a ftpl file template out of it. Syntax: $ pdb2ftpl.py [-d] [-c ID] pdbfile The command will use CONECT record in pdb file to find bonds when available. If CONECT does not exist, the program will switch to distance calculated by atom coordinates to make bonds. The switch \"-d\" forces the program to use distance to make bonds. The switch \"-c ID\" lets the program to use a different 2-character conformer ID. By default, the ID is 01. Obtain atom charges \u00b6 One way to compute atomic charge is through Atomic Charge Calculator at https://webchem.ncbr.muni.cz/Platform/ChargeCalculator You can specify non-0 total charge of the molecule with this tool. Calculate reference reaction field energy \u00b6 Once you assign the atomic charges to the atoms in the ftpl file template and name it with suffix .ftpl, copy this file to the mcce param directory under its installation folder. The installation directory is where the mcce program is. For example, you find the location of mcce executable: $ which mcce /home/jmao/projects/Stable-MCCE/bin/mcce Then the param directory is: $ ls /home/jmao/projects/Stable-MCCE/param 00always_needed.tpl asn.ftpl _cl.ftpl ena.ftpl gly.ftpl ile.ftpl mel.ftpl ntr.ftpl ser.ftpl tyr.ftpl 7MQ.ftpl asp.ftpl ctr.ftpl for.ftpl hil.ftpl leu.ftpl mem.ftpl pdbs step1_out.pdb val.ftpl ala.ftpl bcl.ftpl cyd.ftpl gln.ftpl his.ftpl lys.ftpl met.ftpl phe.ftpl thr.ftpl _zn.ftpl arg.ftpl bcr.ftpl cys.ftpl glu.ftpl hoh.ftpl mcce.tpl _na.ftpl pro.ftpl trp.ftpl This is the directory ftpl files are stored. Examples of making ftpl file \u00b6 Here are some examples of making new ftpl file for molecules: Single state \u00b6 This example prepares a ftpl file for a molecule with one single state. That is, no inozation conformer, no dummy conformer. Ethanol: CH3CH2OH Step 1: Get pdb file \u00b6 Goto RSCB ligand expo http://ligand-expo.rcsb.org/ Search Ethanol as molecule name from http://ligand-expo.rcsb.org/ . Download the pdb file of ethanol EOH_ideal.pdb. or use this command to download directly $ wget http://ligand-expo.rcsb.org/reports/E/EOH/EOH_ideal.pdb Step 2: Make a ftpl file \u00b6 $ pdb2ftpl.py EOH_ideal.pdb > eoh.ftpl $ cat eoh.ftpl # Conformer definition CONFLIST, EOH: EOHBK, EOH01 # ATOM name and bonds CONNECT, \" C1 \", EOH01: sp3, \" C2 \",\" O \",\" H11\",\" H12\" CONNECT, \" C2 \", EOH01: sp3, \" C1 \",\" H21\",\" H22\",\" H23\" CONNECT, \" O \", EOH01: sp3, \" C1 \",\" HO \" CONNECT, \" H11\", EOH01: s, \" C1 \" CONNECT, \" H12\", EOH01: s, \" C1 \" CONNECT, \" H21\", EOH01: s, \" C2 \" CONNECT, \" H22\", EOH01: s, \" C2 \" CONNECT, \" H23\", EOH01: s, \" C2 \" CONNECT, \" HO \", EOH01: s, \" O \" # ATOM charges CHARGE, EOH01, \" C1 \": to_be_filled CHARGE, EOH01, \" C2 \": to_be_filled CHARGE, EOH01, \" O \": to_be_filled CHARGE, EOH01, \" H11\": to_be_filled CHARGE, EOH01, \" H12\": to_be_filled CHARGE, EOH01, \" H21\": to_be_filled CHARGE, EOH01, \" H22\": to_be_filled CHARGE, EOH01, \" H23\": to_be_filled CHARGE, EOH01, \" HO \": to_be_filled # Atom radius, dielelctric boundary radius, VDW radius, and energy well depth RADIUS, EOH01, \" C1 \": 1.700, 2.000, 0.150 RADIUS, EOH01, \" C2 \": 1.700, 2.000, 0.150 RADIUS, EOH01, \" O \": 1.400, 1.600, 0.200 RADIUS, EOH01, \" H11\": 1.000, 1.000, 0.020 RADIUS, EOH01, \" H12\": 1.000, 1.000, 0.020 RADIUS, EOH01, \" H21\": 1.000, 1.000, 0.020 RADIUS, EOH01, \" H22\": 1.000, 1.000, 0.020 RADIUS, EOH01, \" H23\": 1.000, 1.000, 0.020 RADIUS, EOH01, \" HO \": 1.000, 1.000, 0.020 # Conformer parameters that appear in head3.lst: ne, Em0, nH, pKa0, rxn CONFORMER, EOH01: Em0=0.0, pKa0=0.00, ne=0, nH=0, rxn02= to_be_filled, rxn04= to_be_filled, rxn08= to_be_filled Step 3: Calculate charge \u00b6 Go to https://webchem.ncbr.muni.cz/Platform/ChargeCalculator Submit EOH_ideal.pdb, set total charge 0, and obtain the atomic charge results. Assign the charges to the previously made file eoh.ftpl # Conformer definition CONFLIST, EOH: EOHBK, EOH01 # ATOM name and bonds CONNECT, \" C1 \", EOH01: sp3, \" C2 \",\" O \",\" H11\",\" H12\" CONNECT, \" C2 \", EOH01: sp3, \" C1 \",\" H21\",\" H22\",\" H23\" CONNECT, \" O \", EOH01: sp3, \" C1 \",\" HO \" CONNECT, \" H11\", EOH01: s, \" C1 \" CONNECT, \" H12\", EOH01: s, \" C1 \" CONNECT, \" H21\", EOH01: s, \" C2 \" CONNECT, \" H22\", EOH01: s, \" C2 \" CONNECT, \" H23\", EOH01: s, \" C2 \" CONNECT, \" HO \", EOH01: s, \" O \" # ATOM charges CHARGE, EOH01, \" C1 \": -0.085 CHARGE, EOH01, \" C2 \": -0.554 CHARGE, EOH01, \" O \": -0.746 CHARGE, EOH01, \" H11\": 0.177 CHARGE, EOH01, \" H12\": 0.177 CHARGE, EOH01, \" H21\": 0.237 CHARGE, EOH01, \" H22\": 0.237 CHARGE, EOH01, \" H23\": 0.209 CHARGE, EOH01, \" HO \": 0.351 # Atom radius, dielelctric boundary radius, VDW radius, and energy well depth RADIUS, EOH01, \" C1 \": 1.700, 2.000, 0.150 RADIUS, EOH01, \" C2 \": 1.700, 2.000, 0.150 RADIUS, EOH01, \" O \": 1.400, 1.600, 0.200 RADIUS, EOH01, \" H11\": 1.000, 1.000, 0.020 RADIUS, EOH01, \" H12\": 1.000, 1.000, 0.020 RADIUS, EOH01, \" H21\": 1.000, 1.000, 0.020 RADIUS, EOH01, \" H22\": 1.000, 1.000, 0.020 RADIUS, EOH01, \" H23\": 1.000, 1.000, 0.020 RADIUS, EOH01, \" HO \": 1.000, 1.000, 0.020 # Conformer parameters that appear in head3.lst: ne, Em0, nH, pKa0, rxn CONFORMER, EOH01: Em0=0.0, pKa0=0.00, ne=0, nH=0, rxn02= 0, rxn04= 0, rxn08= 0 Step 4: Install ftpl file \u00b6 Find the param/ location $ which mcce /home/jmao/projects/Stable-MCCE/bin/mcce Copy ftpl file to param/ $ cp eoh.ftpl /home/jmao/projects/Stable-MCCE/param Step 5: Reaction field energy \u00b6 Starting with rxn02 = 0, rxn04 = 0, and rxn08 = 0, we are going to recalculate the proper reference values so that this molecule in solution gives 0 desolvation energy in self-energy file head3.lst. $ step1.py --noter EOH_ideal.pdb $ step2.py $ step3.py Then do cat head3.lst and find the number under dsolv, which is -4.076 in our case. The step 3 used default dielectric constant 4, so this value is for rxn04. Put this number back to eoh.ftpl file under param/ so it reads like: # Conformer parameters that appear in head3.lst: ne, Em0, nH, pKa0, rxn CONFORMER, EOH01: Em0=0.0, pKa0=0.00, ne=0, nH=0, rxn02= 0, rxn04= -4.076, rxn08= 0 If we run 3 steps again, we will get dsolv about 0 this time: $ step3.py $ cat head3.lst iConf CONFORMER FL occ crg Em0 pKa0 ne nH vdw0 vdw1 tors epol dsolv extra history 00001 EOH01A0001_001 f 0.00 0.003 0 0.00 0 0 0.677 0.000 0.000 0.000 0.004 0.000 01O000M000 t Next we need to do the same for rxn02 and rxn 08. Step3 will take epsilon as our command option this time. Dielectric constant 2 $ step3.py -d 2 $ cat head3.lst iConf CONFORMER FL occ crg Em0 pKa0 ne nH vdw0 vdw1 tors epol dsolv extra history 00001 EOH01A0001_001 f 0.00 0.003 0 0.00 0 0 0.677 0.000 0.000 0.000 -8.500 0.000 01O000M000 t Dielectric constant 8 $ step3.py -d 8 $ cat head3.lst iConf CONFORMER FL occ crg Em0 pKa0 ne nH vdw0 vdw1 tors epol dsolv extra history 00001 EOH01A0001_001 f 0.00 0.003 0 0.00 0 0 0.677 0.000 0.000 0.000 -1.875 0.000 01O000M000 t Put these numbers back to param/eoh.ftpl under installation folder, this line reads as: CONFORMER, EOH01: Em0=0.0, pKa0=0.00, ne=0, nH=0, rxn02= -8.5, rxn04= -4.076, rxn08= -1.875 Protonation or redox states \u00b6 What if a molecule has multiple ionization states? In short, we need to assign two conformer types and give atoms different charge sets. Example: Acetic acid: CH3COOH Prepare pdb files \u00b6 Goto RSCB ligand expo http://ligand-expo.rcsb.org/ Search \"acetic acid\" Click on Chemical details of ACY Download pdb file or $ wget http://ligand-expo.rcsb.org/reports/A/ACY/ACY_ideal.pdb This file is in protonated state: ATOM 1 C ACY A 1 0.012 -0.056 0.002 1.00 10.00 C ATOM 2 O ACY A 1 0.261 -1.238 -0.000 1.00 10.00 O ATOM 3 OXT ACY A 1 1.011 0.840 -0.000 1.00 10.00 O ATOM 4 CH3 ACY A 1 -1.421 0.412 -0.000 1.00 10.00 C ATOM 5 HXT ACY A 1 1.913 0.493 -0.003 1.00 10.00 H ATOM 6 H1 ACY A 1 -1.768 0.523 1.027 1.00 10.00 H ATOM 7 H2 ACY A 1 -1.489 1.372 -0.512 1.00 10.00 H ATOM 8 H3 ACY A 1 -2.042 -0.320 -0.517 1.00 10.00 H CONECT 1 2 3 4 CONECT 2 1 CONECT 3 1 5 CONECT 4 1 6 7 8 CONECT 5 3 CONECT 6 4 CONECT 7 4 CONECT 8 4 We need to make a pdb file in name ACY_deprotonated.pdb for deprotonated state by deleting HXT: ATOM 1 C ACY A 1 0.012 -0.056 0.002 1.00 10.00 C ATOM 2 O ACY A 1 0.261 -1.238 -0.000 1.00 10.00 O ATOM 3 OXT ACY A 1 1.011 0.840 -0.000 1.00 10.00 O ATOM 4 CH3 ACY A 1 -1.421 0.412 -0.000 1.00 10.00 C ATOM 6 H1 ACY A 1 -1.768 0.523 1.027 1.00 10.00 H ATOM 7 H2 ACY A 1 -1.489 1.372 -0.512 1.00 10.00 H ATOM 8 H3 ACY A 1 -2.042 -0.320 -0.517 1.00 10.00 H We also deleted CONECT because we dont want to manually fix CONECT due to the missing HXT. Make ftpl files \u00b6 create ftpl template for protonated acetic acid $ pdb2ftpl.py ACY_ideal.pdb > acy.ftpl create ftpl template for deprotonated acetic acid $ pdb2ftpl.py -c -1 ACY_deprotonated.pdb > acy-1.ftpl Merge two files. While CONFLIST maintains a single line, other parameters still take individual lines. # Conformer definition CONFLIST, ACY: ACYBK, ACY01, ACY-1 # ATOM name and bonds CONNECT, \" C \", ACY01: sp2, \" O \",\" OXT\",\" CH3\" CONNECT, \" O \", ACY01: sp3, \" C \" CONNECT, \" OXT\", ACY01: sp2, \" C \",\" HXT\" CONNECT, \" CH3\", ACY01: sp3, \" C \",\" H1 \",\" H2 \",\" H3 \" CONNECT, \" HXT\", ACY01: s, \" OXT\" CONNECT, \" H1 \", ACY01: s, \" CH3\" CONNECT, \" H2 \", ACY01: s, \" CH3\" CONNECT, \" H3 \", ACY01: s, \" CH3\" CONNECT, \" C \", ACY-1: sp2, \" O \",\" OXT\",\" CH3\" CONNECT, \" O \", ACY-1: sp3, \" C \" CONNECT, \" OXT\", ACY-1: sp3, \" C \" CONNECT, \" CH3\", ACY-1: sp3, \" C \",\" H1 \",\" H2 \",\" H3 \" CONNECT, \" H1 \", ACY-1: s, \" CH3\" CONNECT, \" H2 \", ACY-1: s, \" CH3\" CONNECT, \" H3 \", ACY-1: s, \" CH3\" # ATOM charges CHARGE, ACY01, \" C \": to_be_filled CHARGE, ACY01, \" O \": to_be_filled CHARGE, ACY01, \" OXT\": to_be_filled CHARGE, ACY01, \" CH3\": to_be_filled CHARGE, ACY01, \" HXT\": to_be_filled CHARGE, ACY01, \" H1 \": to_be_filled CHARGE, ACY01, \" H2 \": to_be_filled CHARGE, ACY01, \" H3 \": to_be_filled CHARGE, ACY-1, \" C \": to_be_filled CHARGE, ACY-1, \" O \": to_be_filled CHARGE, ACY-1, \" OXT\": to_be_filled CHARGE, ACY-1, \" CH3\": to_be_filled CHARGE, ACY-1, \" H1 \": to_be_filled CHARGE, ACY-1, \" H2 \": to_be_filled CHARGE, ACY-1, \" H3 \": to_be_filled # Atom radius, dielelctric boundary radius, VDW radius, and energy well depth RADIUS, ACY01, \" C \": 1.700, 2.000, 0.150 RADIUS, ACY01, \" O \": 1.400, 1.600, 0.200 RADIUS, ACY01, \" OXT\": 1.400, 1.600, 0.200 RADIUS, ACY01, \" CH3\": 1.700, 2.000, 0.150 RADIUS, ACY01, \" HXT\": 1.000, 1.000, 0.020 RADIUS, ACY01, \" H1 \": 1.000, 1.000, 0.020 RADIUS, ACY01, \" H2 \": 1.000, 1.000, 0.020 RADIUS, ACY01, \" H3 \": 1.000, 1.000, 0.020 RADIUS, ACY-1, \" C \": 1.700, 2.000, 0.150 RADIUS, ACY-1, \" O \": 1.400, 1.600, 0.200 RADIUS, ACY-1, \" OXT\": 1.400, 1.600, 0.200 RADIUS, ACY-1, \" CH3\": 1.700, 2.000, 0.150 RADIUS, ACY-1, \" H1 \": 1.000, 1.000, 0.020 RADIUS, ACY-1, \" H2 \": 1.000, 1.000, 0.020 RADIUS, ACY-1, \" H3 \": 1.000, 1.000, 0.020 # Conformer parameters that appear in head3.lst: ne, Em0, nH, pKa0, rxn CONFORMER, ACY01: Em0=0.0, pKa0=0.00, ne=0, nH=0, rxn02= 0, rxn04= 0, rxn08= 0 CONFORMER, ACY-1: Em0=0.0, pKa0=0.00, ne=0, nH=0, rxn02= 0, rxn04= 0, rxn08= 0 Calculate charge \u00b6 Go to https://webchem.ncbr.muni.cz/Platform/ChargeCalculator Submit ACY_ideal.pdb, set total charge 0, and obtain the atomic charge results. Submit ACY_deprotonated.pdb, set total charge -1, and obtain the atomic charge results. Assign the charges to acy.ftpl file: take individual lines. # Conformer definition CONFLIST, ACY: ACYBK, ACY01, ACY-1 # ATOM name and bonds CONNECT, \" C \", ACY01: sp2, \" O \",\" OXT\",\" CH3\" CONNECT, \" O \", ACY01: sp3, \" C \" CONNECT, \" OXT\", ACY01: sp2, \" C \",\" HXT\" CONNECT, \" CH3\", ACY01: sp3, \" C \",\" H1 \",\" H2 \",\" H3 \" CONNECT, \" HXT\", ACY01: s, \" OXT\" CONNECT, \" H1 \", ACY01: s, \" CH3\" CONNECT, \" H2 \", ACY01: s, \" CH3\" CONNECT, \" H3 \", ACY01: s, \" CH3\" CONNECT, \" C \", ACY-1: sp2, \" O \",\" OXT\",\" CH3\" CONNECT, \" O \", ACY-1: sp3, \" C \" CONNECT, \" OXT\", ACY-1: sp3, \" C \" CONNECT, \" CH3\", ACY-1: sp3, \" C \",\" H1 \",\" H2 \",\" H3 \" CONNECT, \" H1 \", ACY-1: s, \" CH3\" CONNECT, \" H2 \", ACY-1: s, \" CH3\" CONNECT, \" H3 \", ACY-1: s, \" CH3\" # ATOM charges CHARGE, ACY01, \" C \": 0.680 CHARGE, ACY01, \" O \": -0.590 CHARGE, ACY01, \" OXT\": -0.774 CHARGE, ACY01, \" CH3\": -0.606 CHARGE, ACY01, \" HXT\": 0.433 CHARGE, ACY01, \" H1 \": 0.283 CHARGE, ACY01, \" H2 \": 0.287 CHARGE, ACY01, \" H3 \": 0.287 CHARGE, ACY-1, \" C \": 0.577 CHARGE, ACY-1, \" O \": -0.768 CHARGE, ACY-1, \" OXT\": -0.699 CHARGE, ACY-1, \" CH3\": -0.714 CHARGE, ACY-1, \" H1 \": 0.198 CHARGE, ACY-1, \" H2 \": 0.202 CHARGE, ACY-1, \" H3 \": 0.204 # Atom radius, dielelctric boundary radius, VDW radius, and energy well depth RADIUS, ACY01, \" C \": 1.700, 2.000, 0.150 RADIUS, ACY01, \" O \": 1.400, 1.600, 0.200 RADIUS, ACY01, \" OXT\": 1.400, 1.600, 0.200 RADIUS, ACY01, \" CH3\": 1.700, 2.000, 0.150 RADIUS, ACY01, \" HXT\": 1.000, 1.000, 0.020 RADIUS, ACY01, \" H1 \": 1.000, 1.000, 0.020 RADIUS, ACY01, \" H2 \": 1.000, 1.000, 0.020 RADIUS, ACY01, \" H3 \": 1.000, 1.000, 0.020 RADIUS, ACY-1, \" C \": 1.700, 2.000, 0.150 RADIUS, ACY-1, \" O \": 1.400, 1.600, 0.200 RADIUS, ACY-1, \" OXT\": 1.400, 1.600, 0.200 RADIUS, ACY-1, \" CH3\": 1.700, 2.000, 0.150 RADIUS, ACY-1, \" H1 \": 1.000, 1.000, 0.020 RADIUS, ACY-1, \" H2 \": 1.000, 1.000, 0.020 RADIUS, ACY-1, \" H3 \": 1.000, 1.000, 0.020 # Conformer parameters that appear in head3.lst: ne, Em0, nH, pKa0, rxn CONFORMER, ACY01: Em0=0.0, pKa0=0.00, ne=0, nH=0, rxn02= 0, rxn04= 0, rxn08= 0 CONFORMER, ACY-1: Em0=0.0, pKa0=0.00, ne=0, nH=0, rxn02= 0, rxn04= 0, rxn08= 0 Install ftpl file \u00b6 Find the param/ location $ which mcce /home/jmao/projects/Stable-MCCE/bin/mcce Copy ftpl file to param/ $ cp acy.ftpl /home/jmao/projects/Stable-MCCE/param Reaction field energy \u00b6 Run step 1 to 3: $ step1.py --noter ACY_ideal.pdb $ step2.py $ step3.py -d 2 $ cat head3.lst iConf CONFORMER FL occ crg Em0 pKa0 ne nH vdw0 vdw1 tors epol dsolv extra history 00001 ACY01A0001_001 f 0.00 0.000 0 0.00 0 0 0.497 0.000 0.000 0.000 -11.413 0.000 01O000M000 t 00002 ACY-1A0001_002 f 0.00 -1.000 0 0.00 0 0 0.180 0.000 0.000 0.000 -47.119 0.000 -1O000M000 t $ step3.py -d 4 $ cat head3.lst iConf CONFORMER FL occ crg Em0 pKa0 ne nH vdw0 vdw1 tors epol dsolv extra history 00001 ACY01A0001_001 f 0.00 0.000 0 0.00 0 0 0.497 0.000 0.000 0.000 -5.495 0.000 01O000M000 t 00002 ACY-1A0001_002 f 0.00 -1.000 0 0.00 0 0 0.180 0.000 0.000 0.000 -22.902 0.000 -1O000M000 t $ step3.py -d 8 $ cat head3.lst iConf CONFORMER FL occ crg Em0 pKa0 ne nH vdw0 vdw1 tors epol dsolv extra history 00001 ACY01A0001_001 f 0.00 0.000 0 0.00 0 0 0.497 0.000 0.000 0.000 -2.548 0.000 01O000M000 t 00002 ACY-1A0001_002 f 0.00 -1.000 0 0.00 0 0 0.180 0.000 0.000 0.000 -10.801 0.000 -1O000M000 t Put the values back in /path/to/param/acy.ftpl, set nH=-1 because this conformer loses a proton, and set pKa0 =4.75 as this is acetic acid pKa. # Conformer parameters that appear in head3.lst: ne, Em0, nH, pKa0, rxn CONFORMER, ACY01: Em0=0.0, pKa0=0.00, ne=0, nH=0, rxn02= -11.413, rxn04= -5.495, rxn08= -2.548 CONFORMER, ACY-1: Em0=0.0, pKa0=4.75, ne=0, nH=-1, rxn02= -47.119, rxn04= -22.902, rxn08= -10.801","title":"Make a new topology file"},{"location":"newftpl/#how-to-make-a-new-topology-file","text":"Page last updated on: 2020-07-07 Topology file defines a molecule, including the atom connectivity, atom charge and radius, how conformers are made etc.","title":"How to make a new topology file?"},{"location":"newftpl/#general-format-of-ftpl-file","text":"The format of free format tpl file is simple. It is simply a key value pair separated by \":\". The key can be up to three fields, separated by \",\". The first key field is primary key, describing what kind of record it is, and the other two keys are supplementary, describing what molecule/conformer/atom it belongs to. The Value is a string, and will be processed by the mcce program in the context of key. If a space is a part of the key or value, it must be quoted inside double quotes. \":\", \",\" and \"#\" are reserved, and can not be used as part of key and value. The following is an example: Any text after \"#\" is considered comment. Any line that doesn't have \":\" is considered as comment CONNECT, \" N \", GLUBK: sp2, \" ? \", \" CA \", \" H \" MCCE reads in lines from ftpl files and save them in a single database. The content in multiple ftpl files are compiled into the database. Therefore one ftpl file can define multiple residues, and one residue parameter lines can be spread in multiple files. If the same key appears more than once, only the value of the last one is valid. This means the previous loaded value under this key will be overwritten. The order of reading ftpl files is alphabetic order of the file names.","title":"General format of ftpl file"},{"location":"newftpl/#reference-of-ftpl-records","text":"","title":"Reference of ftpl records"},{"location":"newftpl/#conformer-list","text":"Example: CONFLIST, GLU: GLUBK, GLU01, GLU02, GLU-1 This is a required parameter for a molecule This parameter tells MCCE that residue GLU has 4 conformers. A conformer is named in as a 3-char residue name + 2-char conformer label. The conformer that ends with BK is a special backbone conformer. The atoms of the backbone conformerdo not change charge and protonation states. They and the atoms of one of the other side chain conformers make up the residue. In addition backbone conformers of all residues are grouped into one big chunck for energy calculation. Conformers other than backbone conformer are side chain conformers. They differ with each other by atom charge, bond connection, or proton number. Another special type conformer ends with \"DM\" as a convention name. The \"DM\" is not required. It has 0 atoms (no matching CONNECT parameters), and it represents the absence of this conformer, such as water leaving the site.","title":"Conformer list"},{"location":"newftpl/#atom-and-bonds","text":"Example: CONNECT, \" N \", GLUBK: sp2, \" ? \", \" CA \", \" H \" CONNECT, \" H \", GLUBK: s, \" N \" CONNECT, \" CA \", GLUBK: sp3, \" N \", \" C \", \" CB \", \" HA \" CONNECT, \" HA \", GLUBK: s, \" CA \" CONNECT, \" C \", GLUBK: sp2, \" CA \", \" O \", \" ? \" CONNECT, \" O \", GLUBK: sp2, \" C \" CONNECT, \" CB \", GLU01: sp3, \" CA \", \" CG \", \" HB2\", \" HB3\" CONNECT, \" HB2\", GLU01: s, \" CB \" CONNECT, \" HB3\", GLU01: s, \" CB \" CONNECT, \" CG \", GLU01: sp3, \" CB \", \" CD \", \" HG2\", \" HG3\" CONNECT, \" HG2\", GLU01: s, \" CG \" CONNECT, \" HG3\", GLU01: s, \" CG \" CONNECT, \" CD \", GLU01: sp2, \" CG \", \" OE1\", \" OE2\" CONNECT, \" OE1\", GLU01: sp3, \" CD \", \" HE1\" CONNECT, \" HE1\", GLU01: s, \" OE1\" CONNECT, \" OE2\", GLU01: s, \" CD \" CONNECT, \" CB \", GLU02: sp3, \" CA \", \" CG \", \" HB2\", \" HB3\" CONNECT, \" HB2\", GLU02: s, \" CB \" CONNECT, \" HB3\", GLU02: s, \" CB \" CONNECT, \" CG \", GLU02: sp3, \" CB \", \" CD \", \" HG2\", \" HG3\" CONNECT, \" HG2\", GLU02: s, \" CG \" CONNECT, \" HG3\", GLU02: s, \" CG \" CONNECT, \" CD \", GLU02: sp2, \" CG \", \" OE1\", \" OE2\" CONNECT, \" OE1\", GLU02: s, \" CD \" CONNECT, \" OE2\", GLU02: sp3, \" CD \", \" HE2\" CONNECT, \" HE2\", GLU02: sp3, \" OE2\" CONNECT, \" CB \", GLU-1: sp3, \" CA \", \" CG \", \" HB2\", \" HB3\" CONNECT, \" HB2\", GLU-1: s, \" CB \" CONNECT, \" HB3\", GLU-1: s, \" CB \" CONNECT, \" CG \", GLU-1: sp3, \" CB \", \" CD \", \" HG2\", \" HG3\" CONNECT, \" HG2\", GLU-1: s, \" CG \" CONNECT, \" HG3\", GLU-1: s, \" CG \" CONNECT, \" CD \", GLU-1: sp2, \" CG \", \" OE1\", \" OE2\" CONNECT, \" OE1\", GLU-1: sp2, \" CD \" CONNECT, \" OE2\", GLU-1: sp2, \" CD \" CONNECT parameters define three things for a conformer: the atom names, bond geometry, and bonds. If none CONNECT parameters exist for a conformer, that conformer is a \"dummy\" conformer, representing the absence of the atoms/molecule. The keys are: parameter name, atom name, and conformer name, in this order. The value starts with atom orbital hybridization, which defines the bond angles and bond numbers, then the atoms that are bonded. For a single atom molecule, or an atom that are not connected to other atoms, use \"ion\" as the orbital type. The atom names need to be enclosed in quotations so the spaces will be counted.","title":"Atom and bonds"},{"location":"newftpl/#atom-charges","text":"CHARGE, GLUBK, \" N \": -0.350 CHARGE, GLUBK, \" H \": 0.250 CHARGE, GLUBK, \" CA \": 0.100 CHARGE, GLUBK, \" HA \": 0.000 CHARGE, GLUBK, \" C \": 0.550 CHARGE, GLUBK, \" O \": -0.550 CHARGE, GLU01, \" CB \": 0.000 CHARGE, GLU01, \" HB2\": 0.000 CHARGE, GLU01, \" HB3\": 0.000 CHARGE, GLU01, \" CG \": 0.000 CHARGE, GLU01, \" HG2\": 0.000 CHARGE, GLU01, \" HG3\": 0.000 CHARGE, GLU01, \" CD \": 0.550 CHARGE, GLU01, \" OE1\": -0.495 CHARGE, GLU01, \" HE1\": 0.435 CHARGE, GLU01, \" OE2\": -0.490 CHARGE, GLU02, \" CB \": 0.000 CHARGE, GLU02, \" HB2\": 0.000 CHARGE, GLU02, \" HB3\": 0.000 CHARGE, GLU02, \" CG \": 0.000 CHARGE, GLU02, \" HG2\": 0.000 CHARGE, GLU02, \" HG3\": 0.000 CHARGE, GLU02, \" CD \": 0.550 CHARGE, GLU02, \" OE1\": -0.490 CHARGE, GLU02, \" OE2\": -0.495 CHARGE, GLU02, \" HE2\": 0.435 CHARGE, GLU-1, \" CB \": 0.000 CHARGE, GLU-1, \" HB2\": 0.000 CHARGE, GLU-1, \" HB3\": 0.000 CHARGE, GLU-1, \" CG \": 0.000 CHARGE, GLU-1, \" HG2\": 0.000 CHARGE, GLU-1, \" HG3\": 0.000 CHARGE, GLU-1, \" CD \": 0.100 CHARGE, GLU-1, \" OE1\": -0.550 CHARGE, GLU-1, \" OE2\": -0.550 This parameter defines the charge of an atom in a conformer. The same atom in a molecule may have different charge depending on its bond status, protonation states, and ionization states. The key is the parameter name, conformer name and atom name. and the value is the atomic charge. If a CHARGE parameter is missing for an atom, a 0 charge is assumed.","title":"Atom charges"},{"location":"newftpl/#atom-radius","text":"Example: RADIUS, GLUBK, \" N \": 1.500, 1.750, 0.160 RADIUS, GLUBK, \" H \": 1.000, 1.000, 0.020 RADIUS, GLUBK, \" CA \": 2.000, 2.000, 0.150 RADIUS, GLUBK, \" HA \": 0.000, 1.000, 0.020 RADIUS, GLUBK, \" C \": 1.700, 2.000, 0.150 RADIUS, GLUBK, \" O \": 1.400, 1.600, 0.200 RADIUS, GLU01, \" CB \": 2.000, 2.000, 0.150 RADIUS, GLU01, \" HB2\": 0.000, 1.000, 0.020 RADIUS, GLU01, \" HB3\": 0.000, 1.000, 0.020 RADIUS, GLU01, \" CG \": 2.000, 2.000, 0.150 RADIUS, GLU01, \" HG2\": 0.000, 1.000, 0.020 RADIUS, GLU01, \" HG3\": 0.000, 1.000, 0.020 RADIUS, GLU01, \" CD \": 1.700, 2.000, 0.150 RADIUS, GLU01, \" OE1\": 1.400, 1.600, 0.200 RADIUS, GLU01, \" HE1\": 1.000, 1.000, 0.020 RADIUS, GLU01, \" OE2\": 1.400, 1.600, 0.200 RADIUS, GLU02, \" CB \": 2.000, 2.000, 0.150 RADIUS, GLU02, \" HB2\": 0.000, 1.000, 0.020 RADIUS, GLU02, \" HB3\": 0.000, 1.000, 0.020 RADIUS, GLU02, \" CG \": 2.000, 2.000, 0.150 RADIUS, GLU02, \" HG2\": 0.000, 1.000, 0.020 RADIUS, GLU02, \" HG3\": 0.000, 1.000, 0.020 RADIUS, GLU02, \" CD \": 1.700, 2.000, 0.150 RADIUS, GLU02, \" OE1\": 1.400, 1.600, 0.200 RADIUS, GLU02, \" OE2\": 1.400, 1.600, 0.200 RADIUS, GLU02, \" HE2\": 1.000, 1.000, 0.020 RADIUS, GLU-1, \" CB \": 2.000, 2.000, 0.150 RADIUS, GLU-1, \" HB2\": 0.000, 1.000, 0.020 RADIUS, GLU-1, \" HB3\": 0.000, 1.000, 0.020 RADIUS, GLU-1, \" CG \": 2.000, 2.000, 0.150 RADIUS, GLU-1, \" HG2\": 0.000, 1.000, 0.020 RADIUS, GLU-1, \" HG3\": 0.000, 1.000, 0.020 RADIUS, GLU-1, \" CD \": 1.700, 2.000, 0.150 RADIUS, GLU-1, \" OE1\": 1.400, 1.600, 0.200 RADIUS, GLU-1, \" OE2\": 1.400, 1.600, 0.200 The radius parameter includes both the dielelctric boundary radius, and VDW radius plus energy well depth. The key is the parameter name, conformer name and atom name. The value has three fields. They are radius for defining dielectric boundary, and the radius and energy well depth to caculate Van der Waals energy.","title":"Atom radius"},{"location":"newftpl/#conformer-parameters","text":"Example: CONFORMER, GLU01: Em0= 0.0, pKa0= 0.00, ne= 0, nH= 0, rxn02 = -6.41, rxn04= -3.100, rxn08= -1.39 CONFORMER, GLU02: Em0= 0.0, pKa0= 0.00, ne= 0, nH= 0, rxn02 = -6.44, rxn04= -3.100, rxn08= -1.39 CONFORMER, GLU-1: Em0= 0.0, pKa0= 4.75, ne= 0, nH=-1, rxn02 =-41.76, rxn04=-20.200, rxn08= -9.59 Each conformer defined in CONFLIST except backbone and dummy conformers should have a line in this section. It defines some necessary conformer properties. The key is parameter name and conformer. The value consists fields separated by commas. Each field is a key value pair. Em0: Redox titration midpoint potential of the molecule in solution. pKa0: pH titration mid point of the molecule in solution ne: relative number of electrons. For a redox reaction, the ground state has ne = 0, the excited state has a ne of none 0. nH: relative number of protons. For a protonation reaction, the ground state has nH = 0, charged acid loses a proton so nH = -1 and charged base gains a proton so nH = 1. rxn02: reference reaction field energy at dielectric constant 2. rxn04: reference reaction field energy at dielectric constant 4. rxn08: reference reaction field energy at dielectric constant 8.","title":"Conformer parameters"},{"location":"newftpl/#rotatable-bonds","text":"Example: ROTATE, GLU: \" CA \" - \" CB \", \" CB \" - \" CG \", \" CG \" - \" CD \" This is an optional parameter. The key is parameter name and residue name. Different conformer types are not configured to have different bond rotations. The key is a series of rotatable bonds. Each rotatable bond is defined by two atoms, and these two atoms are directional. The direction means when a bond rotation is made, the first atom is stationary, and the second atom and all atoms connected to it in that direction will all rotate accordingly.","title":"Rotatable bonds"},{"location":"newftpl/#how-to-make-a-new-ftpl-file","text":"Although one can manually write all the parameter lines in ftpl file. There are tools to help making ftpl file much easier.","title":"How to make a new ftpl file"},{"location":"newftpl/#make-ftpl-file-template","text":"If you have a pdb file, you can build a ftpl file template out of it. Syntax: $ pdb2ftpl.py [-d] [-c ID] pdbfile The command will use CONECT record in pdb file to find bonds when available. If CONECT does not exist, the program will switch to distance calculated by atom coordinates to make bonds. The switch \"-d\" forces the program to use distance to make bonds. The switch \"-c ID\" lets the program to use a different 2-character conformer ID. By default, the ID is 01.","title":"Make ftpl file template"},{"location":"newftpl/#obtain-atom-charges","text":"One way to compute atomic charge is through Atomic Charge Calculator at https://webchem.ncbr.muni.cz/Platform/ChargeCalculator You can specify non-0 total charge of the molecule with this tool.","title":"Obtain atom charges"},{"location":"newftpl/#calculate-reference-reaction-field-energy","text":"Once you assign the atomic charges to the atoms in the ftpl file template and name it with suffix .ftpl, copy this file to the mcce param directory under its installation folder. The installation directory is where the mcce program is. For example, you find the location of mcce executable: $ which mcce /home/jmao/projects/Stable-MCCE/bin/mcce Then the param directory is: $ ls /home/jmao/projects/Stable-MCCE/param 00always_needed.tpl asn.ftpl _cl.ftpl ena.ftpl gly.ftpl ile.ftpl mel.ftpl ntr.ftpl ser.ftpl tyr.ftpl 7MQ.ftpl asp.ftpl ctr.ftpl for.ftpl hil.ftpl leu.ftpl mem.ftpl pdbs step1_out.pdb val.ftpl ala.ftpl bcl.ftpl cyd.ftpl gln.ftpl his.ftpl lys.ftpl met.ftpl phe.ftpl thr.ftpl _zn.ftpl arg.ftpl bcr.ftpl cys.ftpl glu.ftpl hoh.ftpl mcce.tpl _na.ftpl pro.ftpl trp.ftpl This is the directory ftpl files are stored.","title":"Calculate reference reaction field energy"},{"location":"newftpl/#examples-of-making-ftpl-file","text":"Here are some examples of making new ftpl file for molecules:","title":"Examples of making ftpl file"},{"location":"newftpl/#single-state","text":"This example prepares a ftpl file for a molecule with one single state. That is, no inozation conformer, no dummy conformer. Ethanol: CH3CH2OH","title":"Single state"},{"location":"newftpl/#step-1-get-pdb-file","text":"Goto RSCB ligand expo http://ligand-expo.rcsb.org/ Search Ethanol as molecule name from http://ligand-expo.rcsb.org/ . Download the pdb file of ethanol EOH_ideal.pdb. or use this command to download directly $ wget http://ligand-expo.rcsb.org/reports/E/EOH/EOH_ideal.pdb","title":"Step 1: Get pdb file"},{"location":"newftpl/#step-2-make-a-ftpl-file","text":"$ pdb2ftpl.py EOH_ideal.pdb > eoh.ftpl $ cat eoh.ftpl # Conformer definition CONFLIST, EOH: EOHBK, EOH01 # ATOM name and bonds CONNECT, \" C1 \", EOH01: sp3, \" C2 \",\" O \",\" H11\",\" H12\" CONNECT, \" C2 \", EOH01: sp3, \" C1 \",\" H21\",\" H22\",\" H23\" CONNECT, \" O \", EOH01: sp3, \" C1 \",\" HO \" CONNECT, \" H11\", EOH01: s, \" C1 \" CONNECT, \" H12\", EOH01: s, \" C1 \" CONNECT, \" H21\", EOH01: s, \" C2 \" CONNECT, \" H22\", EOH01: s, \" C2 \" CONNECT, \" H23\", EOH01: s, \" C2 \" CONNECT, \" HO \", EOH01: s, \" O \" # ATOM charges CHARGE, EOH01, \" C1 \": to_be_filled CHARGE, EOH01, \" C2 \": to_be_filled CHARGE, EOH01, \" O \": to_be_filled CHARGE, EOH01, \" H11\": to_be_filled CHARGE, EOH01, \" H12\": to_be_filled CHARGE, EOH01, \" H21\": to_be_filled CHARGE, EOH01, \" H22\": to_be_filled CHARGE, EOH01, \" H23\": to_be_filled CHARGE, EOH01, \" HO \": to_be_filled # Atom radius, dielelctric boundary radius, VDW radius, and energy well depth RADIUS, EOH01, \" C1 \": 1.700, 2.000, 0.150 RADIUS, EOH01, \" C2 \": 1.700, 2.000, 0.150 RADIUS, EOH01, \" O \": 1.400, 1.600, 0.200 RADIUS, EOH01, \" H11\": 1.000, 1.000, 0.020 RADIUS, EOH01, \" H12\": 1.000, 1.000, 0.020 RADIUS, EOH01, \" H21\": 1.000, 1.000, 0.020 RADIUS, EOH01, \" H22\": 1.000, 1.000, 0.020 RADIUS, EOH01, \" H23\": 1.000, 1.000, 0.020 RADIUS, EOH01, \" HO \": 1.000, 1.000, 0.020 # Conformer parameters that appear in head3.lst: ne, Em0, nH, pKa0, rxn CONFORMER, EOH01: Em0=0.0, pKa0=0.00, ne=0, nH=0, rxn02= to_be_filled, rxn04= to_be_filled, rxn08= to_be_filled","title":"Step 2: Make a ftpl file"},{"location":"newftpl/#step-3-calculate-charge","text":"Go to https://webchem.ncbr.muni.cz/Platform/ChargeCalculator Submit EOH_ideal.pdb, set total charge 0, and obtain the atomic charge results. Assign the charges to the previously made file eoh.ftpl # Conformer definition CONFLIST, EOH: EOHBK, EOH01 # ATOM name and bonds CONNECT, \" C1 \", EOH01: sp3, \" C2 \",\" O \",\" H11\",\" H12\" CONNECT, \" C2 \", EOH01: sp3, \" C1 \",\" H21\",\" H22\",\" H23\" CONNECT, \" O \", EOH01: sp3, \" C1 \",\" HO \" CONNECT, \" H11\", EOH01: s, \" C1 \" CONNECT, \" H12\", EOH01: s, \" C1 \" CONNECT, \" H21\", EOH01: s, \" C2 \" CONNECT, \" H22\", EOH01: s, \" C2 \" CONNECT, \" H23\", EOH01: s, \" C2 \" CONNECT, \" HO \", EOH01: s, \" O \" # ATOM charges CHARGE, EOH01, \" C1 \": -0.085 CHARGE, EOH01, \" C2 \": -0.554 CHARGE, EOH01, \" O \": -0.746 CHARGE, EOH01, \" H11\": 0.177 CHARGE, EOH01, \" H12\": 0.177 CHARGE, EOH01, \" H21\": 0.237 CHARGE, EOH01, \" H22\": 0.237 CHARGE, EOH01, \" H23\": 0.209 CHARGE, EOH01, \" HO \": 0.351 # Atom radius, dielelctric boundary radius, VDW radius, and energy well depth RADIUS, EOH01, \" C1 \": 1.700, 2.000, 0.150 RADIUS, EOH01, \" C2 \": 1.700, 2.000, 0.150 RADIUS, EOH01, \" O \": 1.400, 1.600, 0.200 RADIUS, EOH01, \" H11\": 1.000, 1.000, 0.020 RADIUS, EOH01, \" H12\": 1.000, 1.000, 0.020 RADIUS, EOH01, \" H21\": 1.000, 1.000, 0.020 RADIUS, EOH01, \" H22\": 1.000, 1.000, 0.020 RADIUS, EOH01, \" H23\": 1.000, 1.000, 0.020 RADIUS, EOH01, \" HO \": 1.000, 1.000, 0.020 # Conformer parameters that appear in head3.lst: ne, Em0, nH, pKa0, rxn CONFORMER, EOH01: Em0=0.0, pKa0=0.00, ne=0, nH=0, rxn02= 0, rxn04= 0, rxn08= 0","title":"Step 3: Calculate charge"},{"location":"newftpl/#step-4-install-ftpl-file","text":"Find the param/ location $ which mcce /home/jmao/projects/Stable-MCCE/bin/mcce Copy ftpl file to param/ $ cp eoh.ftpl /home/jmao/projects/Stable-MCCE/param","title":"Step 4: Install ftpl file"},{"location":"newftpl/#step-5-reaction-field-energy","text":"Starting with rxn02 = 0, rxn04 = 0, and rxn08 = 0, we are going to recalculate the proper reference values so that this molecule in solution gives 0 desolvation energy in self-energy file head3.lst. $ step1.py --noter EOH_ideal.pdb $ step2.py $ step3.py Then do cat head3.lst and find the number under dsolv, which is -4.076 in our case. The step 3 used default dielectric constant 4, so this value is for rxn04. Put this number back to eoh.ftpl file under param/ so it reads like: # Conformer parameters that appear in head3.lst: ne, Em0, nH, pKa0, rxn CONFORMER, EOH01: Em0=0.0, pKa0=0.00, ne=0, nH=0, rxn02= 0, rxn04= -4.076, rxn08= 0 If we run 3 steps again, we will get dsolv about 0 this time: $ step3.py $ cat head3.lst iConf CONFORMER FL occ crg Em0 pKa0 ne nH vdw0 vdw1 tors epol dsolv extra history 00001 EOH01A0001_001 f 0.00 0.003 0 0.00 0 0 0.677 0.000 0.000 0.000 0.004 0.000 01O000M000 t Next we need to do the same for rxn02 and rxn 08. Step3 will take epsilon as our command option this time. Dielectric constant 2 $ step3.py -d 2 $ cat head3.lst iConf CONFORMER FL occ crg Em0 pKa0 ne nH vdw0 vdw1 tors epol dsolv extra history 00001 EOH01A0001_001 f 0.00 0.003 0 0.00 0 0 0.677 0.000 0.000 0.000 -8.500 0.000 01O000M000 t Dielectric constant 8 $ step3.py -d 8 $ cat head3.lst iConf CONFORMER FL occ crg Em0 pKa0 ne nH vdw0 vdw1 tors epol dsolv extra history 00001 EOH01A0001_001 f 0.00 0.003 0 0.00 0 0 0.677 0.000 0.000 0.000 -1.875 0.000 01O000M000 t Put these numbers back to param/eoh.ftpl under installation folder, this line reads as: CONFORMER, EOH01: Em0=0.0, pKa0=0.00, ne=0, nH=0, rxn02= -8.5, rxn04= -4.076, rxn08= -1.875","title":"Step 5: Reaction field energy"},{"location":"newftpl/#protonation-or-redox-states","text":"What if a molecule has multiple ionization states? In short, we need to assign two conformer types and give atoms different charge sets. Example: Acetic acid: CH3COOH","title":"Protonation or redox states"},{"location":"newftpl/#prepare-pdb-files","text":"Goto RSCB ligand expo http://ligand-expo.rcsb.org/ Search \"acetic acid\" Click on Chemical details of ACY Download pdb file or $ wget http://ligand-expo.rcsb.org/reports/A/ACY/ACY_ideal.pdb This file is in protonated state: ATOM 1 C ACY A 1 0.012 -0.056 0.002 1.00 10.00 C ATOM 2 O ACY A 1 0.261 -1.238 -0.000 1.00 10.00 O ATOM 3 OXT ACY A 1 1.011 0.840 -0.000 1.00 10.00 O ATOM 4 CH3 ACY A 1 -1.421 0.412 -0.000 1.00 10.00 C ATOM 5 HXT ACY A 1 1.913 0.493 -0.003 1.00 10.00 H ATOM 6 H1 ACY A 1 -1.768 0.523 1.027 1.00 10.00 H ATOM 7 H2 ACY A 1 -1.489 1.372 -0.512 1.00 10.00 H ATOM 8 H3 ACY A 1 -2.042 -0.320 -0.517 1.00 10.00 H CONECT 1 2 3 4 CONECT 2 1 CONECT 3 1 5 CONECT 4 1 6 7 8 CONECT 5 3 CONECT 6 4 CONECT 7 4 CONECT 8 4 We need to make a pdb file in name ACY_deprotonated.pdb for deprotonated state by deleting HXT: ATOM 1 C ACY A 1 0.012 -0.056 0.002 1.00 10.00 C ATOM 2 O ACY A 1 0.261 -1.238 -0.000 1.00 10.00 O ATOM 3 OXT ACY A 1 1.011 0.840 -0.000 1.00 10.00 O ATOM 4 CH3 ACY A 1 -1.421 0.412 -0.000 1.00 10.00 C ATOM 6 H1 ACY A 1 -1.768 0.523 1.027 1.00 10.00 H ATOM 7 H2 ACY A 1 -1.489 1.372 -0.512 1.00 10.00 H ATOM 8 H3 ACY A 1 -2.042 -0.320 -0.517 1.00 10.00 H We also deleted CONECT because we dont want to manually fix CONECT due to the missing HXT.","title":"Prepare pdb files"},{"location":"newftpl/#make-ftpl-files","text":"create ftpl template for protonated acetic acid $ pdb2ftpl.py ACY_ideal.pdb > acy.ftpl create ftpl template for deprotonated acetic acid $ pdb2ftpl.py -c -1 ACY_deprotonated.pdb > acy-1.ftpl Merge two files. While CONFLIST maintains a single line, other parameters still take individual lines. # Conformer definition CONFLIST, ACY: ACYBK, ACY01, ACY-1 # ATOM name and bonds CONNECT, \" C \", ACY01: sp2, \" O \",\" OXT\",\" CH3\" CONNECT, \" O \", ACY01: sp3, \" C \" CONNECT, \" OXT\", ACY01: sp2, \" C \",\" HXT\" CONNECT, \" CH3\", ACY01: sp3, \" C \",\" H1 \",\" H2 \",\" H3 \" CONNECT, \" HXT\", ACY01: s, \" OXT\" CONNECT, \" H1 \", ACY01: s, \" CH3\" CONNECT, \" H2 \", ACY01: s, \" CH3\" CONNECT, \" H3 \", ACY01: s, \" CH3\" CONNECT, \" C \", ACY-1: sp2, \" O \",\" OXT\",\" CH3\" CONNECT, \" O \", ACY-1: sp3, \" C \" CONNECT, \" OXT\", ACY-1: sp3, \" C \" CONNECT, \" CH3\", ACY-1: sp3, \" C \",\" H1 \",\" H2 \",\" H3 \" CONNECT, \" H1 \", ACY-1: s, \" CH3\" CONNECT, \" H2 \", ACY-1: s, \" CH3\" CONNECT, \" H3 \", ACY-1: s, \" CH3\" # ATOM charges CHARGE, ACY01, \" C \": to_be_filled CHARGE, ACY01, \" O \": to_be_filled CHARGE, ACY01, \" OXT\": to_be_filled CHARGE, ACY01, \" CH3\": to_be_filled CHARGE, ACY01, \" HXT\": to_be_filled CHARGE, ACY01, \" H1 \": to_be_filled CHARGE, ACY01, \" H2 \": to_be_filled CHARGE, ACY01, \" H3 \": to_be_filled CHARGE, ACY-1, \" C \": to_be_filled CHARGE, ACY-1, \" O \": to_be_filled CHARGE, ACY-1, \" OXT\": to_be_filled CHARGE, ACY-1, \" CH3\": to_be_filled CHARGE, ACY-1, \" H1 \": to_be_filled CHARGE, ACY-1, \" H2 \": to_be_filled CHARGE, ACY-1, \" H3 \": to_be_filled # Atom radius, dielelctric boundary radius, VDW radius, and energy well depth RADIUS, ACY01, \" C \": 1.700, 2.000, 0.150 RADIUS, ACY01, \" O \": 1.400, 1.600, 0.200 RADIUS, ACY01, \" OXT\": 1.400, 1.600, 0.200 RADIUS, ACY01, \" CH3\": 1.700, 2.000, 0.150 RADIUS, ACY01, \" HXT\": 1.000, 1.000, 0.020 RADIUS, ACY01, \" H1 \": 1.000, 1.000, 0.020 RADIUS, ACY01, \" H2 \": 1.000, 1.000, 0.020 RADIUS, ACY01, \" H3 \": 1.000, 1.000, 0.020 RADIUS, ACY-1, \" C \": 1.700, 2.000, 0.150 RADIUS, ACY-1, \" O \": 1.400, 1.600, 0.200 RADIUS, ACY-1, \" OXT\": 1.400, 1.600, 0.200 RADIUS, ACY-1, \" CH3\": 1.700, 2.000, 0.150 RADIUS, ACY-1, \" H1 \": 1.000, 1.000, 0.020 RADIUS, ACY-1, \" H2 \": 1.000, 1.000, 0.020 RADIUS, ACY-1, \" H3 \": 1.000, 1.000, 0.020 # Conformer parameters that appear in head3.lst: ne, Em0, nH, pKa0, rxn CONFORMER, ACY01: Em0=0.0, pKa0=0.00, ne=0, nH=0, rxn02= 0, rxn04= 0, rxn08= 0 CONFORMER, ACY-1: Em0=0.0, pKa0=0.00, ne=0, nH=0, rxn02= 0, rxn04= 0, rxn08= 0","title":"Make ftpl files"},{"location":"newftpl/#calculate-charge","text":"Go to https://webchem.ncbr.muni.cz/Platform/ChargeCalculator Submit ACY_ideal.pdb, set total charge 0, and obtain the atomic charge results. Submit ACY_deprotonated.pdb, set total charge -1, and obtain the atomic charge results. Assign the charges to acy.ftpl file: take individual lines. # Conformer definition CONFLIST, ACY: ACYBK, ACY01, ACY-1 # ATOM name and bonds CONNECT, \" C \", ACY01: sp2, \" O \",\" OXT\",\" CH3\" CONNECT, \" O \", ACY01: sp3, \" C \" CONNECT, \" OXT\", ACY01: sp2, \" C \",\" HXT\" CONNECT, \" CH3\", ACY01: sp3, \" C \",\" H1 \",\" H2 \",\" H3 \" CONNECT, \" HXT\", ACY01: s, \" OXT\" CONNECT, \" H1 \", ACY01: s, \" CH3\" CONNECT, \" H2 \", ACY01: s, \" CH3\" CONNECT, \" H3 \", ACY01: s, \" CH3\" CONNECT, \" C \", ACY-1: sp2, \" O \",\" OXT\",\" CH3\" CONNECT, \" O \", ACY-1: sp3, \" C \" CONNECT, \" OXT\", ACY-1: sp3, \" C \" CONNECT, \" CH3\", ACY-1: sp3, \" C \",\" H1 \",\" H2 \",\" H3 \" CONNECT, \" H1 \", ACY-1: s, \" CH3\" CONNECT, \" H2 \", ACY-1: s, \" CH3\" CONNECT, \" H3 \", ACY-1: s, \" CH3\" # ATOM charges CHARGE, ACY01, \" C \": 0.680 CHARGE, ACY01, \" O \": -0.590 CHARGE, ACY01, \" OXT\": -0.774 CHARGE, ACY01, \" CH3\": -0.606 CHARGE, ACY01, \" HXT\": 0.433 CHARGE, ACY01, \" H1 \": 0.283 CHARGE, ACY01, \" H2 \": 0.287 CHARGE, ACY01, \" H3 \": 0.287 CHARGE, ACY-1, \" C \": 0.577 CHARGE, ACY-1, \" O \": -0.768 CHARGE, ACY-1, \" OXT\": -0.699 CHARGE, ACY-1, \" CH3\": -0.714 CHARGE, ACY-1, \" H1 \": 0.198 CHARGE, ACY-1, \" H2 \": 0.202 CHARGE, ACY-1, \" H3 \": 0.204 # Atom radius, dielelctric boundary radius, VDW radius, and energy well depth RADIUS, ACY01, \" C \": 1.700, 2.000, 0.150 RADIUS, ACY01, \" O \": 1.400, 1.600, 0.200 RADIUS, ACY01, \" OXT\": 1.400, 1.600, 0.200 RADIUS, ACY01, \" CH3\": 1.700, 2.000, 0.150 RADIUS, ACY01, \" HXT\": 1.000, 1.000, 0.020 RADIUS, ACY01, \" H1 \": 1.000, 1.000, 0.020 RADIUS, ACY01, \" H2 \": 1.000, 1.000, 0.020 RADIUS, ACY01, \" H3 \": 1.000, 1.000, 0.020 RADIUS, ACY-1, \" C \": 1.700, 2.000, 0.150 RADIUS, ACY-1, \" O \": 1.400, 1.600, 0.200 RADIUS, ACY-1, \" OXT\": 1.400, 1.600, 0.200 RADIUS, ACY-1, \" CH3\": 1.700, 2.000, 0.150 RADIUS, ACY-1, \" H1 \": 1.000, 1.000, 0.020 RADIUS, ACY-1, \" H2 \": 1.000, 1.000, 0.020 RADIUS, ACY-1, \" H3 \": 1.000, 1.000, 0.020 # Conformer parameters that appear in head3.lst: ne, Em0, nH, pKa0, rxn CONFORMER, ACY01: Em0=0.0, pKa0=0.00, ne=0, nH=0, rxn02= 0, rxn04= 0, rxn08= 0 CONFORMER, ACY-1: Em0=0.0, pKa0=0.00, ne=0, nH=0, rxn02= 0, rxn04= 0, rxn08= 0","title":"Calculate charge"},{"location":"newftpl/#install-ftpl-file","text":"Find the param/ location $ which mcce /home/jmao/projects/Stable-MCCE/bin/mcce Copy ftpl file to param/ $ cp acy.ftpl /home/jmao/projects/Stable-MCCE/param","title":"Install ftpl file"},{"location":"newftpl/#reaction-field-energy","text":"Run step 1 to 3: $ step1.py --noter ACY_ideal.pdb $ step2.py $ step3.py -d 2 $ cat head3.lst iConf CONFORMER FL occ crg Em0 pKa0 ne nH vdw0 vdw1 tors epol dsolv extra history 00001 ACY01A0001_001 f 0.00 0.000 0 0.00 0 0 0.497 0.000 0.000 0.000 -11.413 0.000 01O000M000 t 00002 ACY-1A0001_002 f 0.00 -1.000 0 0.00 0 0 0.180 0.000 0.000 0.000 -47.119 0.000 -1O000M000 t $ step3.py -d 4 $ cat head3.lst iConf CONFORMER FL occ crg Em0 pKa0 ne nH vdw0 vdw1 tors epol dsolv extra history 00001 ACY01A0001_001 f 0.00 0.000 0 0.00 0 0 0.497 0.000 0.000 0.000 -5.495 0.000 01O000M000 t 00002 ACY-1A0001_002 f 0.00 -1.000 0 0.00 0 0 0.180 0.000 0.000 0.000 -22.902 0.000 -1O000M000 t $ step3.py -d 8 $ cat head3.lst iConf CONFORMER FL occ crg Em0 pKa0 ne nH vdw0 vdw1 tors epol dsolv extra history 00001 ACY01A0001_001 f 0.00 0.000 0 0.00 0 0 0.497 0.000 0.000 0.000 -2.548 0.000 01O000M000 t 00002 ACY-1A0001_002 f 0.00 -1.000 0 0.00 0 0 0.180 0.000 0.000 0.000 -10.801 0.000 -1O000M000 t Put the values back in /path/to/param/acy.ftpl, set nH=-1 because this conformer loses a proton, and set pKa0 =4.75 as this is acetic acid pKa. # Conformer parameters that appear in head3.lst: ne, Em0, nH, pKa0, rxn CONFORMER, ACY01: Em0=0.0, pKa0=0.00, ne=0, nH=0, rxn02= -11.413, rxn04= -5.495, rxn08= -2.548 CONFORMER, ACY-1: Em0=0.0, pKa0=4.75, ne=0, nH=-1, rxn02= -47.119, rxn04= -22.902, rxn08= -10.801","title":"Reaction field energy"},{"location":"pkaexample/","text":"Calculate pKas of Lysozyme \u00b6 Page last updated on: 2020-07-07 Background \u00b6 Lysozyme is a small enzyme that dissolves bacterial cell walls thus kills bacteria. It was discovered as the first antibiotic to inhibit bacteria growth in food, before penicillin. Crystal structure of hen egg white lysozyme - PDB ID 3WUM The residue GLU 35 and ASP 52 have been identified as two active sites. The pKas of these two residues play an important role in the enzyme's activity. In order for lysozyme to attack the glucose molecule of the substrate, GLU has high pKa and ASP 52 has low pKa. This way GLU 35 acts as a proton donor, cuts the glucose with protonation of the glycosidic oxygen and a deprotonated ASP 52 stabilizes the highly charged intermediate, making the reaction easier. Jens Erik Nielsen and J. Andrew McCammon, Protein Sci. 2003 Sep; 12(9): 1894\u20131901 Prepare the calculation \u00b6 After the program is installed and the environment variable PATH is configured (see link for details), make a working directory and go to the working directory. MCCE will generate intermediate files and result files in the current directory, so it's best to prepare one directory for calculation on one structure. $ mkdir 4lzt $ cd 4lzt Then download pdb file 4LZT to the working directory: jmao@jmao-desktop ~/4lzt $ getpdb 4lzt Inquiring the remote file 4LZT.pdb ... Saving as 4LZT.pdb ... Download completed. Run 4 steps of MCCE \u00b6 Step 1. Convert PDB file into MCCE PDB \u00b6 This step proof reads the structure file and cut terminal residues and complex cofactors into smaller ones if necessary. $ step1.py 4LZT.pdb This command generates step1_out.pdb which is required of step 2. If you want to know the help information and other options of this command: $ step1.py -h Step 2. Make side chain conformers \u00b6 This step makes alternative side chain locations and ionization states. $ step2.py This command generates step2_out.pdb which is required of step 3. If you want to know the help information and other options of this command: $ step2.py -h Step 3. Make energy table \u00b6 This step calculates conformer self energy and pairwise interaction table. $ step3.py This command generates opp files under energies/ folder and file head3.lst which are required of step 4. If you want to know the help information and other options of this command: $ step3.py -h Step 4. Simulate a titration with Monte Carlo sampling \u00b6 This step simulates a titration and writes out the conformation and ionization states of each side chain at various conditions. $ step4.py --xts The occupancy table is in file fort.38. The net charge is in file sum_crg.out pKas are in file pK.out Results \u00b6 The pKa report is in file pK.out. $ cat pK.out From the result, GLU 35 (pKa = 5.13) has a higher pKa than ASP 52 (pKa = 3.33). To analyze the ionization energy of an ionizable residue at the mid point pH=5.13 with pairwise cutoff 0.1: $ mfe.py ASP-A0052_ -c 0.1 To analyze the ionization energy of this residue pH 7 with pairwise cutoff 0.1: $ mfe.py ASP-A0052_ -p 7 -c 0.1","title":"pKa calculation"},{"location":"pkaexample/#calculate-pkas-of-lysozyme","text":"Page last updated on: 2020-07-07","title":"Calculate pKas of Lysozyme"},{"location":"pkaexample/#background","text":"Lysozyme is a small enzyme that dissolves bacterial cell walls thus kills bacteria. It was discovered as the first antibiotic to inhibit bacteria growth in food, before penicillin. Crystal structure of hen egg white lysozyme - PDB ID 3WUM The residue GLU 35 and ASP 52 have been identified as two active sites. The pKas of these two residues play an important role in the enzyme's activity. In order for lysozyme to attack the glucose molecule of the substrate, GLU has high pKa and ASP 52 has low pKa. This way GLU 35 acts as a proton donor, cuts the glucose with protonation of the glycosidic oxygen and a deprotonated ASP 52 stabilizes the highly charged intermediate, making the reaction easier. Jens Erik Nielsen and J. Andrew McCammon, Protein Sci. 2003 Sep; 12(9): 1894\u20131901","title":"Background"},{"location":"pkaexample/#prepare-the-calculation","text":"After the program is installed and the environment variable PATH is configured (see link for details), make a working directory and go to the working directory. MCCE will generate intermediate files and result files in the current directory, so it's best to prepare one directory for calculation on one structure. $ mkdir 4lzt $ cd 4lzt Then download pdb file 4LZT to the working directory: jmao@jmao-desktop ~/4lzt $ getpdb 4lzt Inquiring the remote file 4LZT.pdb ... Saving as 4LZT.pdb ... Download completed.","title":"Prepare the calculation"},{"location":"pkaexample/#run-4-steps-of-mcce","text":"","title":"Run 4 steps of MCCE"},{"location":"pkaexample/#step-1-convert-pdb-file-into-mcce-pdb","text":"This step proof reads the structure file and cut terminal residues and complex cofactors into smaller ones if necessary. $ step1.py 4LZT.pdb This command generates step1_out.pdb which is required of step 2. If you want to know the help information and other options of this command: $ step1.py -h","title":"Step 1. Convert PDB file into MCCE PDB"},{"location":"pkaexample/#step-2-make-side-chain-conformers","text":"This step makes alternative side chain locations and ionization states. $ step2.py This command generates step2_out.pdb which is required of step 3. If you want to know the help information and other options of this command: $ step2.py -h","title":"Step 2. Make side chain conformers"},{"location":"pkaexample/#step-3-make-energy-table","text":"This step calculates conformer self energy and pairwise interaction table. $ step3.py This command generates opp files under energies/ folder and file head3.lst which are required of step 4. If you want to know the help information and other options of this command: $ step3.py -h","title":"Step 3. Make energy table"},{"location":"pkaexample/#step-4-simulate-a-titration-with-monte-carlo-sampling","text":"This step simulates a titration and writes out the conformation and ionization states of each side chain at various conditions. $ step4.py --xts The occupancy table is in file fort.38. The net charge is in file sum_crg.out pKas are in file pK.out","title":"Step 4. Simulate a titration with Monte Carlo sampling"},{"location":"pkaexample/#results","text":"The pKa report is in file pK.out. $ cat pK.out From the result, GLU 35 (pKa = 5.13) has a higher pKa than ASP 52 (pKa = 3.33). To analyze the ionization energy of an ionizable residue at the mid point pH=5.13 with pairwise cutoff 0.1: $ mfe.py ASP-A0052_ -c 0.1 To analyze the ionization energy of this residue pH 7 with pairwise cutoff 0.1: $ mfe.py ASP-A0052_ -p 7 -c 0.1","title":"Results"},{"location":"quick/","text":"MCCE quick start \u00b6 Page last updated on: 2020-07-15 Prerequisites \u00b6 Compilers: C, gfortran \u00b6 The C and gfortran compilers usually come with your operating system. If not, use the package manager to install. On Ubuntu Linux: $ sudo apt-get update $ sudo apt-get upgrade $ sudo apt-get install build-essential $ sudo apt-get install gfortran On Mac OS X: For Mac users, the gcc compiler comes with Xcode from the App store. Once Xcode is installed, install command line tools. This provides gcc. Gfortran is avalaible from https://github.com/fxcoudert/gfortran-for-macOS/releases , find your Mac OS X version and install appropriate gfortran package. Python and modules \u00b6 We need Python3 and optionally these modules: numpy, scipy, matplotlib, pygraphviz, pandas, xlrd, and openpyxl Install Miniconda Python3: https://docs.conda.io/en/latest/miniconda.html After installing Miniconda, install these optional modules for data analysis: conda install numpy scipy matplotlib pygraphviz pandas xlrd openpyxl Get the code \u00b6 Download the latest code \u00b6 Under a terminal window, run: git clone https://github.com/GunnerLab/Stable-MCCE.git Compile the code: \u00b6 The above command creates a directory named Stable-MCCE, enter the directory and compile: $ cd Stable-MCCE $ make clean $ make Compiling on Mac OS X: On Mac OS X, an explicit memory free for tree is not supported. You may have to change this subroutine in file lib/db.c /* release database memory */ void free_param () { tdestroy ( param_root , free ); return ; } to /* release database memory */ void free_param () { return ; } Configure environment \u00b6 Find the path of Stable-MCCE installation directory: (base) jmao@pc:~/projects/Stable-MCCE$ pwd /home/jmao/projects/Stable-MCCE In my case the installation directory is /home/jmao/projects/Stable-MCCE/ Add the executable to your path: export PATH=/home/jmao/projects/Stable-MCCE/bin:$PATH Remember to replace the installation directory /home/jmao/projects/Stable-MCCE/ with your own installation path. Also put this line at the end of .bashrc file under your home directory so that the environment is properly set every time you open a terminal window. Run MCCE \u00b6 Prepare a working directory: \u00b6 $ mkdir test_lysozyme $ cd test_lysozyme Get a pdb file \u00b6 $ getpdb 1dpx You now have a pdb file 1DPX.pdb in the working directory. The simplest way to run mcce is do these four steps: Step 1 convert PDB file into MCCE PDB \u00b6 This step proof reads the structure file and cuts terminal residues and complex cofactors into smaller ones if necessary. $ step1.py 1DPX.pdb Step 2 make side chain conformers \u00b6 This step makes alternative side chain locations and ionization states. $ step2.py Step 3 make energy table \u00b6 This step calculates conformer self energy and pairwise interaction table. $ step3.py Step 4 Simulate a titration with Monte Carlo sampling \u00b6 This step simulates a titration and writes out the conformation and ionization states of each side chain at various conditions. $ step4.py Notes \u00b6 Command help \"-h\" \u00b6 For more detailed command usages, use \"-h\" switch in each command above. Run in background \u00b6 Some steps take hours to finish, so it is recommended to run at the background. For example: step3.py > run.log & Jupyter notebook \u00b6 Here is a Jupiter note book template: mcce.ipynb","title":"Quick Start"},{"location":"quick/#mcce-quick-start","text":"Page last updated on: 2020-07-15","title":"MCCE quick start"},{"location":"quick/#prerequisites","text":"","title":"Prerequisites"},{"location":"quick/#compilers-c-gfortran","text":"The C and gfortran compilers usually come with your operating system. If not, use the package manager to install. On Ubuntu Linux: $ sudo apt-get update $ sudo apt-get upgrade $ sudo apt-get install build-essential $ sudo apt-get install gfortran On Mac OS X: For Mac users, the gcc compiler comes with Xcode from the App store. Once Xcode is installed, install command line tools. This provides gcc. Gfortran is avalaible from https://github.com/fxcoudert/gfortran-for-macOS/releases , find your Mac OS X version and install appropriate gfortran package.","title":"Compilers: C, gfortran"},{"location":"quick/#python-and-modules","text":"We need Python3 and optionally these modules: numpy, scipy, matplotlib, pygraphviz, pandas, xlrd, and openpyxl Install Miniconda Python3: https://docs.conda.io/en/latest/miniconda.html After installing Miniconda, install these optional modules for data analysis: conda install numpy scipy matplotlib pygraphviz pandas xlrd openpyxl","title":"Python and modules"},{"location":"quick/#get-the-code","text":"","title":"Get the code"},{"location":"quick/#download-the-latest-code","text":"Under a terminal window, run: git clone https://github.com/GunnerLab/Stable-MCCE.git","title":"Download the latest code"},{"location":"quick/#compile-the-code","text":"The above command creates a directory named Stable-MCCE, enter the directory and compile: $ cd Stable-MCCE $ make clean $ make Compiling on Mac OS X: On Mac OS X, an explicit memory free for tree is not supported. You may have to change this subroutine in file lib/db.c /* release database memory */ void free_param () { tdestroy ( param_root , free ); return ; } to /* release database memory */ void free_param () { return ; }","title":"Compile the code:"},{"location":"quick/#configure-environment","text":"Find the path of Stable-MCCE installation directory: (base) jmao@pc:~/projects/Stable-MCCE$ pwd /home/jmao/projects/Stable-MCCE In my case the installation directory is /home/jmao/projects/Stable-MCCE/ Add the executable to your path: export PATH=/home/jmao/projects/Stable-MCCE/bin:$PATH Remember to replace the installation directory /home/jmao/projects/Stable-MCCE/ with your own installation path. Also put this line at the end of .bashrc file under your home directory so that the environment is properly set every time you open a terminal window.","title":"Configure environment"},{"location":"quick/#run-mcce","text":"","title":"Run MCCE"},{"location":"quick/#prepare-a-working-directory","text":"$ mkdir test_lysozyme $ cd test_lysozyme","title":"Prepare a working directory:"},{"location":"quick/#get-a-pdb-file","text":"$ getpdb 1dpx You now have a pdb file 1DPX.pdb in the working directory. The simplest way to run mcce is do these four steps:","title":"Get a pdb file"},{"location":"quick/#step-1-convert-pdb-file-into-mcce-pdb","text":"This step proof reads the structure file and cuts terminal residues and complex cofactors into smaller ones if necessary. $ step1.py 1DPX.pdb","title":"Step 1 convert PDB file into MCCE PDB"},{"location":"quick/#step-2-make-side-chain-conformers","text":"This step makes alternative side chain locations and ionization states. $ step2.py","title":"Step 2 make side chain conformers"},{"location":"quick/#step-3-make-energy-table","text":"This step calculates conformer self energy and pairwise interaction table. $ step3.py","title":"Step 3 make energy table"},{"location":"quick/#step-4-simulate-a-titration-with-monte-carlo-sampling","text":"This step simulates a titration and writes out the conformation and ionization states of each side chain at various conditions. $ step4.py","title":"Step 4 Simulate a titration with Monte Carlo sampling"},{"location":"quick/#notes","text":"","title":"Notes"},{"location":"quick/#command-help-h","text":"For more detailed command usages, use \"-h\" switch in each command above.","title":"Command help \"-h\""},{"location":"quick/#run-in-background","text":"Some steps take hours to finish, so it is recommended to run at the background. For example: step3.py > run.log &","title":"Run in background"},{"location":"quick/#jupyter-notebook","text":"Here is a Jupiter note book template: mcce.ipynb","title":"Jupyter notebook"},{"location":"runprm/","text":"How to customize run.prm, the run configuration file? \u00b6 Page last updated on: 2020-05-19 The mcce program reads file run.prm from the working directory and runs according to its instructions. The two ways that run mcce are: customize run.prm and call mcce directly run step1.py, step2.py, step3.py, are step4.py as wrappers of mcce. run.prm format \u00b6 The valid parameters are defined as a key-value pair, defined by a line. At the end of the line, the key string word is enclosed in a pair of parenthesis. The key string must be one word. If a key is detected from a line, the first word of the line is its value. For example: f step 1: pre-run, pdb-> mcce pdb (DO_PREMCCE) The key is \"DO_MCCE\" and the value is \"f\". Lines other than parameter lines are considered as comment lines, therefore ignored. Most commonly edited entries \u00b6 Input and output \u00b6 prot.pdb (INPDB) Th parameter \"INPDB\" specifies a pdb file as the initial input structure. Major mcce steps \u00b6 MCCE can be divided into four steps. The steps have keys: DO_PREMCCE DO_ROTAMERS DO_ENERGY DO_MONTE The value 't' is for true (do), and 'f' is for false (not do). Steps: f step 1: pre-run, pdb-> mcce pdb (DO_PREMCCE) f step 2: make rotatmers (DO_ROTAMERS) f step 3: do energy calculations (DO_ENERGY) f step 4: monte carlo sampling (DO_MONTE) The later step depends on the out put of previous step. Less edited entries \u00b6 Step 2 and step 4 have more flexibility and are customized more often than others. General \u00b6 4.0 Protein dielectric constant for DelPhi (EPSILON_PROT) Dielectric constant of protein. Usually epsilon 8 is used for small soluble protein (~100 residues), and 4 is used for big trans-membrane protein (> 200 residues). This value is used by step 2 to optimize rotamers and step 3 to compute energy table. /home/mcce/Stable-MCCE/extra.tpl (EXTRA) This file contains entries that overwrite those defined in ftpl and tpl files in param/ directory, and extral controls over the program. The extra controls are in two categories: offset energy of ionizable residues. These energy corrects the residue solution pKa values based on previous benchmarks. The scaling factor of van der Walls energy term. The recommended values are the inverse of dielectric constant defined by EPSILON_PROT. /home/mcce/Stable-MCCE/name.txt MCCE renaming rule. (RENAME_RULES) The renaming rule can divide a big group into separate ionizable groups. put ligands and cofactor as one group. This is done by renaming the atom and residue. Step 2, Rotamer making \u00b6 f Use control file \"head1.lst\" for rotamer making (ROT_SPECIF) This file enables site specific rotamer making rules. When set as \"t\", it overwrites the rules defined by run.prm. t Do swap (stereo isotope) (ROT_SWAP) Make stereo isotope conformers for residues like GLN and ASN. t Do rotate? (PACK) Rotate around rotatable bonds? 6 number of rotamers in a bond rotation (ROTATIONS) Number of rotamers in a bond rotation. Step 4, Monte Carlo sampling \u00b6 ph \"ph\" for pH titration, \"eh\" for eh titration (TITR_TYPE) The type of simulation, pH or Eh. 0.0 Initial pH (TITR_PH0) The starting pH, or the pH of Eh titration. 1.0 pH interval (TITR_PHD) The interval of pH titration 0.0 Initial Eh (TITR_EH0) The starting Eh, or the Eh of pH titration. 30.0 Eh interval (in mV) (TITR_EHD) The interval of Eh titration. 15 Number of titration points (TITR_STEPS) Number of titration points. f Output Microstate from standard monte carlo (MS_OUT) f Output readable micristate file from standard monte carlo (RE_MS_OUT) Write out microstates or not. System specific entries \u00b6 These entries are tailored to the system and installation. System and installation location \u00b6 /home/mcce/Stable-MCCE (MCCE_HOME) The MCCE installation root. It is required by the program to find relevant parameters. /home/mcce/Stable-MCCE/bin/delphi DelPhi executable (DELPHI_EXE) PB solver delphi location. /tmp delphi temporary file folder, \"/tmp\" uses node (PBE_FOLDER) Location of PB solver output. This should be a folder with write permission and large enough Sometimes to store GBs of files. new.tpl local parameter file for unrecognized res (NEWTPL) Program mcce creates a temporary tpl file whenever it couldn't solve a new cofactor. The presumed parameters are in this file. debug.log (DEBUG_LOG) Debug log file name. Detail levels of program output \u00b6 t Minimize output files (MINIMIZE_SIZE) If this is \"f\", mcce will write more debug information. t Print trace file (DO_TRACE) Creates a record with MCCE revision number, time and date of run, and all user options set in run.prm and appends it to (or creates) the run.trace file. t clean up delphi focusing directory? (DELPHI_CLEAN) Flag of cleaning delphi temporary folder. Set to 't' only for debugging purpose. Other entries \u00b6 Step 1 \u00b6 t Label terminal residues? (TERMINALS) If this flag is on 't', mcce program will identify the C terminus and N terminus of the polypeteides based on the geometry. Terminal residues have extra ionizable sites than residues having peptide bonds. One needs to be careful if there are missing piece of peptide in the given structure. 0.1 cut off water if % SAS exceeds this number (H2O_SASCUTOFF) The water molecules are stripped of if the surface exposure is over this cutoff. This a recursive procedure which means after some waters are removed, the new surface exposure is recaculated and the process id repeated. 2.0 distance limit of reporting clashes (CLASH_DISTANCE) The threshold to report abnormal distance found between non-bonded atoms. t ignore hydrogens in input structure (IGNORE_INPUT_H) Delete and rebuild input H atoms in step 1 and step 2. Step 2: \u00b6 t Rebuild sidechain based on torsion minima (REBUILD_SC) Rebuild side chain. f Do swing? (SWING) Swing conformers deviate from their parent conformer by a small degree. 10.0 phi in degrees of swing (PHI_SWING) Swing angle. 1.00 SAS cuttoff of making fewer rotamers (SAS_CUTOFF) Surface residues get fewer rotamers. There is another mechanism to search the most exposed rotamer to compensate this. 10.0 Cutoff of self vdw in kcal/mol (VDW_CUTOFF) If a rotamer has self energy, comparing with the most favorable one, over this cutoff, it will not ne kept. 5000 number of repacks (REPACKS) The rotamer optimization starts from random initial state, then minimizes the energy on each side chain. The number of restarts of this process is rapacks. 0.03 occupancy cutoff of repacks (REPACK_CUTOFF) The occupancy of side chain conformer lower than this value will not be kept. t h-bond directed rotamer making (HDIRECTED) Do search on hydrogen bond. 1.0 threshold for two conformers being different (HDIRDIFF) Only one of the similar conformers is kept. Similarity os measured by Root Mean Square Deviation. 36 Limit number of the H bond conformers (HDIRLIMT) The number limit on H bond directed conformers. f Do relaxation on water (RELAX_WAT) Move water molecules to relax the distance crash. 3.2 if distance between water and heavy atom is smaller than this, move water away (WATER_RELAX_THR) The threshold of moving water. 10 number of cycles to relax rotamer clash (HV_RELAX_NCYCLE) Heavy atom rotamer relaxation by MD. Number of global restarts (cycles). 10 time (in fs) for each relaxation iteration (HV_RELAX_DT) Heavy atom rotamer relaxation time. 10 number of iterations (HV_RELAX_NITER) Number of local restarts. 2. relax rotamer if vdw interaction is bigger than this (HV_RELAX_VDW_THR) Lower end threshold of relaxing rotamers, Van der Waals energy value in kcal/mol. 5. not relax rotamer if heavy atom vdw is bigger than this (HV_RELAX_HV_VDW_THR) High end threshold of relaxing rotamers, Van der Waals energy value in kcal/mol. -1.0 relax if electrostatic interaction is more favorable than this, and the charged groups are close (HV_RELAX_ELEC_THR) Relax heavy atoms when they show dominantly favorable electrostatic interaction. 0.1 threshold used to define a charged atom, see hv_relax_elec_dist_thr (HV_RELAX_ELEC_CRG_THR) Atoms with charge over this value are considered charged atoms. 3.0 only relax electrostatically favorable pairs that has charged atom distance shorter than this (HV_RELAX_ELEC_DIST_THR) Relax heavy atoms when they show close proximity. 20. scaling factor for torsion during relaxation (HV_TORS_SCALE) Scaling factor for torsion energy when searching torsion minima. 10000 maximun n steps of shake (HV_RELAX_N_SHAKE) MD shake parameter. 0.001 maximun allowance for bond length to deviate (HV_RELAX_SHAKE_TOL) MD bond length detaion parameter. 1.0 constraint distance (HV_RELAX_CONSTRAINT) MD atom constrain distance. 20. constraint force for atom stay in original position (HV_RELAX_CONSTRAINT_FRC) MD atom constraint force. f include neighbors when doing relaxation (expensive) (HV_RELAX_INCLUDE_NGH) Include neighbor in MD relaxation. 4.0 threshold for include as a neighbor during relaxation (HV_RELAX_NGH_THR) Define a neighboring side chain. t Do relaxation on hydrogens (RELAX_H) Optimize hydrogen position. -5.0 Energy threshold for keeping the conformer (RELAX_E_THR) 200 Loop over N local microstates (RELAX_NSTATES) 6 default number of hydroxyl positions (RELAX_N_HYD) 5. do not relax hydrogen if vdw bwt two sidechain conformer bigger than this (RELAX_CLASH_THR) 1.0 phi for each step of relaxation (RELAX_PHI) 300 Maximum number of steps of relaxation (RELAX_NITER) 0.5 Torque threshold for keep relaxing (RELAX_TORQ_THR) These parameters are for MD relaxation. 0.02 Last pruning threshold for conformers (PRUNE_THR) 0.5 Pruning cutoff of RMSD (PRUNE_RMSD) 1.0 Pruning cutoff of eletrostatic pairwise (PRUNE_ELE) 8.0 Pruning cutoff of vdw pairwise (PRUNE_VDW) To reduce the number of final conformers, similar conformers are grouped into one. The similarity is defined by these parameters. 0 maximum number of conformer per residue ( 0=unlimited ) (NCONF_LIMIT) Set a limit to final conformers of a residue. step 3: \u00b6 f Use SAS + Coulomb's law for ele interaction (QUICK_ENERGIES) Use coulomb's law instead of solving PB equation. 80.0 Solvent dielectric constant for DelPhi (EPSILON_SOLV) 65 Grids in each DelPhi (GRIDS_DELPHI) 2.0 The target grids per angstrom for DelPhi (GRIDS_PER_ANG) 1.4 Radius of the probe (RADIUS_PROBE) 2.0 Ion radius (IONRAD) 0.15 Salt (SALT) PB solver parameters. f skip delphi in step3 (DEBUG option) (SKIP_ELE) This is a debug option. f Reassign charge and radii before delphi(if not true then use value in PDB file) (REASSIGN) Step 3 uses atom charges from step2_out.pdb. Use this to overwrite. f Recalculate torsions energy when write out head3.lst (RECALC_TORS) Recalculate torsion energy. 1.7 defalut van der Waals radius, for SAS (DEFAULT_RADIUS) 0.5 factor to 1-4 LJ potontial (1.0 is full) (FACTOR_14LJ) 6.0 dielectric constant for Coulomb's law (EPSILON_COULOMB) More parameters used by the prigram in step 1, 2 and 3. 1 delphi start conformer number, 0 based (PBE_START) 99999 delphi end conformer number, self included (PBE_END) Start and end of PB solution on conformers. step 4: \u00b6 f Average the pairwise, \"f\" uses the smaller (AVERAGE_PAIRWISE) When loading energy from step 3, average the pairwise interaction. 20. Warning Threshold of difference in pairwise (WARN_PAIRWISE) Issue a warning message if asymmetric pairwise interaction is detected. 5.0 Big pairwise threshold to make big list (BIG_PAIRWISE) Residues with big interactions may get synchronized flips. This is the cut off value. -1 Random seed, -1 uses time as random seed (MONTE_SEED) Random seed. 298.15 Temperature (MONTE_T) 3 Number of flips (MONTE_FLIPS) 100 Annealing = n_start * confs (MONTE_NSTART) 500 Equalibration = n_eq * confs (MONTE_NEQ) 0.001 Cut-off occupancy of the reduction (MONTE_REDUCE) Monte Carlo simulation parameters. ### Only for Junjun's monte carlo 2 Number of independent monte carlo sampling (MONTE_RUNS) 2000 Sampling = n_iter * confs (MONTE_NITER) 20000 Trace energy each MONTE_TRACE steps, 0 no trace (MONTE_TRACE) 1000000 Maximum microstates for analytical solution (NSTATE_MAX) f Specify mfe point, f=pKa/Em (MFE_POINT) -1.0 MFE cutoff(Kcal), default 0.5 (MFE_CUTOFF) More Monte Carlo simulation parameters. ### Only for Yifan's monte carlo t Using Yifan's monte carlo (MONTE_ADV_OPT) f Using format from old version (MONTE_OLD_INPUT) 5000 Min Sampling = n_iter * confs (MONTE_NITER_MIN) -1 Max Sampling = n_iter * confs(-1 stop @ converge) (MONTE_NITER_MAX) 10000 Number of iterations each cycle (MONTE_NITER_CYCLE) 1000 niter * n_conf check convergence (MONTE_NITER_CHK) -1 Number of the reduce steps(-1 stop @ converge) (MONTE_N_REDUCE) 0.01 Threshhold for convergence (MONTE_CONVERGE) f Calculate free energy (MONTE_DO_ENERGY) 298.15 Starting temperature for annealling (ANNEAL_TEMP_START) 0 Number of steps of annealling (ANNEAL_NSTEP) 1000 Number of iterations for each annealling step (ANNEAL_NITER_STEP) More Monte Carlo simulation parameters. IPECE parameters \u00b6 f add neutral atoms to simulate a membrane slab (IPECE_ADD_ME) 33. the thichness of the membrane to be add (IPECE_MEM_THICKNESS) M the chain ID of the add atoms (IPECE_MEM_CHAINID) This is for creating a simulated membrane.","title":"Customize run.prm"},{"location":"runprm/#how-to-customize-runprm-the-run-configuration-file","text":"Page last updated on: 2020-05-19 The mcce program reads file run.prm from the working directory and runs according to its instructions. The two ways that run mcce are: customize run.prm and call mcce directly run step1.py, step2.py, step3.py, are step4.py as wrappers of mcce.","title":"How to customize run.prm, the run configuration file?"},{"location":"runprm/#runprm-format","text":"The valid parameters are defined as a key-value pair, defined by a line. At the end of the line, the key string word is enclosed in a pair of parenthesis. The key string must be one word. If a key is detected from a line, the first word of the line is its value. For example: f step 1: pre-run, pdb-> mcce pdb (DO_PREMCCE) The key is \"DO_MCCE\" and the value is \"f\". Lines other than parameter lines are considered as comment lines, therefore ignored.","title":"run.prm format"},{"location":"runprm/#most-commonly-edited-entries","text":"","title":"Most commonly edited entries"},{"location":"runprm/#input-and-output","text":"prot.pdb (INPDB) Th parameter \"INPDB\" specifies a pdb file as the initial input structure.","title":"Input and output"},{"location":"runprm/#major-mcce-steps","text":"MCCE can be divided into four steps. The steps have keys: DO_PREMCCE DO_ROTAMERS DO_ENERGY DO_MONTE The value 't' is for true (do), and 'f' is for false (not do). Steps: f step 1: pre-run, pdb-> mcce pdb (DO_PREMCCE) f step 2: make rotatmers (DO_ROTAMERS) f step 3: do energy calculations (DO_ENERGY) f step 4: monte carlo sampling (DO_MONTE) The later step depends on the out put of previous step.","title":"Major mcce steps"},{"location":"runprm/#less-edited-entries","text":"Step 2 and step 4 have more flexibility and are customized more often than others.","title":"Less edited entries"},{"location":"runprm/#general","text":"4.0 Protein dielectric constant for DelPhi (EPSILON_PROT) Dielectric constant of protein. Usually epsilon 8 is used for small soluble protein (~100 residues), and 4 is used for big trans-membrane protein (> 200 residues). This value is used by step 2 to optimize rotamers and step 3 to compute energy table. /home/mcce/Stable-MCCE/extra.tpl (EXTRA) This file contains entries that overwrite those defined in ftpl and tpl files in param/ directory, and extral controls over the program. The extra controls are in two categories: offset energy of ionizable residues. These energy corrects the residue solution pKa values based on previous benchmarks. The scaling factor of van der Walls energy term. The recommended values are the inverse of dielectric constant defined by EPSILON_PROT. /home/mcce/Stable-MCCE/name.txt MCCE renaming rule. (RENAME_RULES) The renaming rule can divide a big group into separate ionizable groups. put ligands and cofactor as one group. This is done by renaming the atom and residue.","title":"General"},{"location":"runprm/#step-2-rotamer-making","text":"f Use control file \"head1.lst\" for rotamer making (ROT_SPECIF) This file enables site specific rotamer making rules. When set as \"t\", it overwrites the rules defined by run.prm. t Do swap (stereo isotope) (ROT_SWAP) Make stereo isotope conformers for residues like GLN and ASN. t Do rotate? (PACK) Rotate around rotatable bonds? 6 number of rotamers in a bond rotation (ROTATIONS) Number of rotamers in a bond rotation.","title":"Step 2, Rotamer making"},{"location":"runprm/#step-4-monte-carlo-sampling","text":"ph \"ph\" for pH titration, \"eh\" for eh titration (TITR_TYPE) The type of simulation, pH or Eh. 0.0 Initial pH (TITR_PH0) The starting pH, or the pH of Eh titration. 1.0 pH interval (TITR_PHD) The interval of pH titration 0.0 Initial Eh (TITR_EH0) The starting Eh, or the Eh of pH titration. 30.0 Eh interval (in mV) (TITR_EHD) The interval of Eh titration. 15 Number of titration points (TITR_STEPS) Number of titration points. f Output Microstate from standard monte carlo (MS_OUT) f Output readable micristate file from standard monte carlo (RE_MS_OUT) Write out microstates or not.","title":"Step 4, Monte Carlo sampling"},{"location":"runprm/#system-specific-entries","text":"These entries are tailored to the system and installation.","title":"System specific entries"},{"location":"runprm/#system-and-installation-location","text":"/home/mcce/Stable-MCCE (MCCE_HOME) The MCCE installation root. It is required by the program to find relevant parameters. /home/mcce/Stable-MCCE/bin/delphi DelPhi executable (DELPHI_EXE) PB solver delphi location. /tmp delphi temporary file folder, \"/tmp\" uses node (PBE_FOLDER) Location of PB solver output. This should be a folder with write permission and large enough Sometimes to store GBs of files. new.tpl local parameter file for unrecognized res (NEWTPL) Program mcce creates a temporary tpl file whenever it couldn't solve a new cofactor. The presumed parameters are in this file. debug.log (DEBUG_LOG) Debug log file name.","title":"System and installation location"},{"location":"runprm/#detail-levels-of-program-output","text":"t Minimize output files (MINIMIZE_SIZE) If this is \"f\", mcce will write more debug information. t Print trace file (DO_TRACE) Creates a record with MCCE revision number, time and date of run, and all user options set in run.prm and appends it to (or creates) the run.trace file. t clean up delphi focusing directory? (DELPHI_CLEAN) Flag of cleaning delphi temporary folder. Set to 't' only for debugging purpose.","title":"Detail levels of program output"},{"location":"runprm/#other-entries","text":"","title":"Other entries"},{"location":"runprm/#step-1","text":"t Label terminal residues? (TERMINALS) If this flag is on 't', mcce program will identify the C terminus and N terminus of the polypeteides based on the geometry. Terminal residues have extra ionizable sites than residues having peptide bonds. One needs to be careful if there are missing piece of peptide in the given structure. 0.1 cut off water if % SAS exceeds this number (H2O_SASCUTOFF) The water molecules are stripped of if the surface exposure is over this cutoff. This a recursive procedure which means after some waters are removed, the new surface exposure is recaculated and the process id repeated. 2.0 distance limit of reporting clashes (CLASH_DISTANCE) The threshold to report abnormal distance found between non-bonded atoms. t ignore hydrogens in input structure (IGNORE_INPUT_H) Delete and rebuild input H atoms in step 1 and step 2.","title":"Step 1"},{"location":"runprm/#step-2","text":"t Rebuild sidechain based on torsion minima (REBUILD_SC) Rebuild side chain. f Do swing? (SWING) Swing conformers deviate from their parent conformer by a small degree. 10.0 phi in degrees of swing (PHI_SWING) Swing angle. 1.00 SAS cuttoff of making fewer rotamers (SAS_CUTOFF) Surface residues get fewer rotamers. There is another mechanism to search the most exposed rotamer to compensate this. 10.0 Cutoff of self vdw in kcal/mol (VDW_CUTOFF) If a rotamer has self energy, comparing with the most favorable one, over this cutoff, it will not ne kept. 5000 number of repacks (REPACKS) The rotamer optimization starts from random initial state, then minimizes the energy on each side chain. The number of restarts of this process is rapacks. 0.03 occupancy cutoff of repacks (REPACK_CUTOFF) The occupancy of side chain conformer lower than this value will not be kept. t h-bond directed rotamer making (HDIRECTED) Do search on hydrogen bond. 1.0 threshold for two conformers being different (HDIRDIFF) Only one of the similar conformers is kept. Similarity os measured by Root Mean Square Deviation. 36 Limit number of the H bond conformers (HDIRLIMT) The number limit on H bond directed conformers. f Do relaxation on water (RELAX_WAT) Move water molecules to relax the distance crash. 3.2 if distance between water and heavy atom is smaller than this, move water away (WATER_RELAX_THR) The threshold of moving water. 10 number of cycles to relax rotamer clash (HV_RELAX_NCYCLE) Heavy atom rotamer relaxation by MD. Number of global restarts (cycles). 10 time (in fs) for each relaxation iteration (HV_RELAX_DT) Heavy atom rotamer relaxation time. 10 number of iterations (HV_RELAX_NITER) Number of local restarts. 2. relax rotamer if vdw interaction is bigger than this (HV_RELAX_VDW_THR) Lower end threshold of relaxing rotamers, Van der Waals energy value in kcal/mol. 5. not relax rotamer if heavy atom vdw is bigger than this (HV_RELAX_HV_VDW_THR) High end threshold of relaxing rotamers, Van der Waals energy value in kcal/mol. -1.0 relax if electrostatic interaction is more favorable than this, and the charged groups are close (HV_RELAX_ELEC_THR) Relax heavy atoms when they show dominantly favorable electrostatic interaction. 0.1 threshold used to define a charged atom, see hv_relax_elec_dist_thr (HV_RELAX_ELEC_CRG_THR) Atoms with charge over this value are considered charged atoms. 3.0 only relax electrostatically favorable pairs that has charged atom distance shorter than this (HV_RELAX_ELEC_DIST_THR) Relax heavy atoms when they show close proximity. 20. scaling factor for torsion during relaxation (HV_TORS_SCALE) Scaling factor for torsion energy when searching torsion minima. 10000 maximun n steps of shake (HV_RELAX_N_SHAKE) MD shake parameter. 0.001 maximun allowance for bond length to deviate (HV_RELAX_SHAKE_TOL) MD bond length detaion parameter. 1.0 constraint distance (HV_RELAX_CONSTRAINT) MD atom constrain distance. 20. constraint force for atom stay in original position (HV_RELAX_CONSTRAINT_FRC) MD atom constraint force. f include neighbors when doing relaxation (expensive) (HV_RELAX_INCLUDE_NGH) Include neighbor in MD relaxation. 4.0 threshold for include as a neighbor during relaxation (HV_RELAX_NGH_THR) Define a neighboring side chain. t Do relaxation on hydrogens (RELAX_H) Optimize hydrogen position. -5.0 Energy threshold for keeping the conformer (RELAX_E_THR) 200 Loop over N local microstates (RELAX_NSTATES) 6 default number of hydroxyl positions (RELAX_N_HYD) 5. do not relax hydrogen if vdw bwt two sidechain conformer bigger than this (RELAX_CLASH_THR) 1.0 phi for each step of relaxation (RELAX_PHI) 300 Maximum number of steps of relaxation (RELAX_NITER) 0.5 Torque threshold for keep relaxing (RELAX_TORQ_THR) These parameters are for MD relaxation. 0.02 Last pruning threshold for conformers (PRUNE_THR) 0.5 Pruning cutoff of RMSD (PRUNE_RMSD) 1.0 Pruning cutoff of eletrostatic pairwise (PRUNE_ELE) 8.0 Pruning cutoff of vdw pairwise (PRUNE_VDW) To reduce the number of final conformers, similar conformers are grouped into one. The similarity is defined by these parameters. 0 maximum number of conformer per residue ( 0=unlimited ) (NCONF_LIMIT) Set a limit to final conformers of a residue.","title":"Step 2:"},{"location":"runprm/#step-3","text":"f Use SAS + Coulomb's law for ele interaction (QUICK_ENERGIES) Use coulomb's law instead of solving PB equation. 80.0 Solvent dielectric constant for DelPhi (EPSILON_SOLV) 65 Grids in each DelPhi (GRIDS_DELPHI) 2.0 The target grids per angstrom for DelPhi (GRIDS_PER_ANG) 1.4 Radius of the probe (RADIUS_PROBE) 2.0 Ion radius (IONRAD) 0.15 Salt (SALT) PB solver parameters. f skip delphi in step3 (DEBUG option) (SKIP_ELE) This is a debug option. f Reassign charge and radii before delphi(if not true then use value in PDB file) (REASSIGN) Step 3 uses atom charges from step2_out.pdb. Use this to overwrite. f Recalculate torsions energy when write out head3.lst (RECALC_TORS) Recalculate torsion energy. 1.7 defalut van der Waals radius, for SAS (DEFAULT_RADIUS) 0.5 factor to 1-4 LJ potontial (1.0 is full) (FACTOR_14LJ) 6.0 dielectric constant for Coulomb's law (EPSILON_COULOMB) More parameters used by the prigram in step 1, 2 and 3. 1 delphi start conformer number, 0 based (PBE_START) 99999 delphi end conformer number, self included (PBE_END) Start and end of PB solution on conformers.","title":"step 3:"},{"location":"runprm/#step-4","text":"f Average the pairwise, \"f\" uses the smaller (AVERAGE_PAIRWISE) When loading energy from step 3, average the pairwise interaction. 20. Warning Threshold of difference in pairwise (WARN_PAIRWISE) Issue a warning message if asymmetric pairwise interaction is detected. 5.0 Big pairwise threshold to make big list (BIG_PAIRWISE) Residues with big interactions may get synchronized flips. This is the cut off value. -1 Random seed, -1 uses time as random seed (MONTE_SEED) Random seed. 298.15 Temperature (MONTE_T) 3 Number of flips (MONTE_FLIPS) 100 Annealing = n_start * confs (MONTE_NSTART) 500 Equalibration = n_eq * confs (MONTE_NEQ) 0.001 Cut-off occupancy of the reduction (MONTE_REDUCE) Monte Carlo simulation parameters. ### Only for Junjun's monte carlo 2 Number of independent monte carlo sampling (MONTE_RUNS) 2000 Sampling = n_iter * confs (MONTE_NITER) 20000 Trace energy each MONTE_TRACE steps, 0 no trace (MONTE_TRACE) 1000000 Maximum microstates for analytical solution (NSTATE_MAX) f Specify mfe point, f=pKa/Em (MFE_POINT) -1.0 MFE cutoff(Kcal), default 0.5 (MFE_CUTOFF) More Monte Carlo simulation parameters. ### Only for Yifan's monte carlo t Using Yifan's monte carlo (MONTE_ADV_OPT) f Using format from old version (MONTE_OLD_INPUT) 5000 Min Sampling = n_iter * confs (MONTE_NITER_MIN) -1 Max Sampling = n_iter * confs(-1 stop @ converge) (MONTE_NITER_MAX) 10000 Number of iterations each cycle (MONTE_NITER_CYCLE) 1000 niter * n_conf check convergence (MONTE_NITER_CHK) -1 Number of the reduce steps(-1 stop @ converge) (MONTE_N_REDUCE) 0.01 Threshhold for convergence (MONTE_CONVERGE) f Calculate free energy (MONTE_DO_ENERGY) 298.15 Starting temperature for annealling (ANNEAL_TEMP_START) 0 Number of steps of annealling (ANNEAL_NSTEP) 1000 Number of iterations for each annealling step (ANNEAL_NITER_STEP) More Monte Carlo simulation parameters.","title":"step 4:"},{"location":"runprm/#ipece-parameters","text":"f add neutral atoms to simulate a membrane slab (IPECE_ADD_ME) 33. the thichness of the membrane to be add (IPECE_MEM_THICKNESS) M the chain ID of the add atoms (IPECE_MEM_CHAINID) This is for creating a simulated membrane.","title":"IPECE parameters"},{"location":"tools/","text":"MCCE tools reference \u00b6 Page last updated on: 2020-06-26 Improving and helping runs \u00b6 step by step mcce run scripts \u00b6 MCCE involves 4 main steps: Step 1: Convert raw PDB file to MCCE PDB file, reformat terminal residues, and strip off surface water and ions. Step 2: Make side chain conformers, including rotamers and ionization conformers. Step 3: Compute self-energy of conformers and pairwise energy lookup table. Step 4: Monte Carlo sampling to evaluate favorable side chain position and ionization at various conditions. While the control of these 4 steps is fully configured in run.prm and executed by mcce command, the 4 steps can be carried out by python wrapper scripts without configuring run.prm. Step 1: prepare structure \u00b6 usage: step1.py [-h] [--norun] [--noter] [-e /path/to/mcce] [-u Key=Value] [-d epsilon] [--dry] pdb Run mcce step 1, premcce to format PDB file to MCCE PDB format. positional arguments: pdb optional arguments: -h, --help show this help message and exit --norun Create run.prm but do not run step 1 --noter Do not label terminal residues (for making ftpl). -e /path/to/mcce mcce executable location, default to \"mcce\" -u Key=Value User customized variables -d epsilon protein dielectric constant for delphi, default to 4.0 --dry Delete all water molecules. Step 2: make conformers \u00b6 usage: step2.py [-h] [--norun] [-d epsilon] [-e /path/to/mcce] [-u Key=Value] [-l level] Run mcce step 2, make side chain conformers from step1_out.pdb. optional arguments: -h, --help show this help message and exit --norun Create run.prm but do not run step 2 -d epsilon dielectric constant for optimizing conformers -e /path/to/mcce mcce executable location, default to \"mcce\" -u Key=Value User customized variables -l level conformer level 1: quick, 2: medium, 3: comprehensive Step 3: energy calculation \u00b6 usage: step3.py [-h] [-c start end] [-d epsilon] [-e /path/to/mcce] [-f tmp folder] [-p processes] [-r] [-u Key=Value] [-x /path/to/delphi] [--norun] Run mcce step 3, energy calculations, with multiple threads. optional arguments: -h, --help show this help message and exit -c start end starting and ending conformer, default to 1 and 9999 -d epsilon protein dielectric constant for delphi, default to 4.0 -e /path/to/mcce mcce executable location, default to \"mcce\" -f tmp folder delphi temporary folder, default to /tmp -p processes run mcce with number of processes, default to 1 -r refresh opp files and head3.lst without running delphi -u Key=Value User customized variables -x /path/to/delphi delphi executable location, default to \"delphi\" --norun Create run.prm but do not run step 3 step3.py is able to run in multiple threads. Step 4: Monte Carlo sampling \u00b6 usage: step4.py [-h] [--norun] [-i initial ph/eh] [-d interval] [-n steps] [--xts] [--ms] [-e /path/to/mcce] [-t ph or eh] [-u Key=Value] Run mcce step 4, Monte Carlo sampling to simulate a titration. optional arguments: -h, --help show this help message and exit --norun Create run.prm but do not run step 4 -i initial ph/eh Initial pH/Eh of titration -d interval titration interval in pJ or mV -n steps number of steps of titration --xts Enable entropy correction, default is false --ms Enable microstate output -e /path/to/mcce mcce executable location, default to \"mcce\" -t ph or eh titration type, pH or Eh -u Key=Value User customized variables Step 5: titration fitting \u00b6 Step 5 is optional. It writes net charge of each residue in sum_crg2.out and fits the titration curve in pK2.out. usage: step5.py [-h] Run mcce step 5, generate net charge, fit titration curve. optional arguments: -h, --help show this help message and exit Step 6: hydrogen bond \u00b6 Step 6 is for hydrogen bond network analysis. It requires step 4 to output microstates. usage: step6.py [-h] [--norun] [-e /path/to/mcce] [-u Key=Value] Run step 6, hydrogen bond analysis, requires microstate output from step 4. optional arguments: -h, --help show this help message and exit --norun Create run.prm but do not run step 6 -e /path/to/mcce mcce executable location, default to \"mcce\" -u Key=Value User customized variables Example: step4.py --ms step6.py Combine first 4 steps \u00b6 The first 4 steps are essential steps. #!/bin/bash step1.py input.pdb step2.py step3.py step4.py energies.py \u00b6 Run step3 with multiple threads. Syntax: energies.py [-h] [-p processes] [-r] [-c start end] [-e /path/to/mcce] Optional arguments: Argument Description -h, --help show this help message and exit -p processes run mcce with number of processes, default to 1 -r refresh opp files and head3.lst without running delphi -c start end starting and ending conformer, default to 1 and 9999 -e /path/to/mcce mcce executable location, default to \"mcce\" Examples: energies.py -p 6 This command runs step 3 in 6 threads. energies.py -r This command runs step 3 just to refresh head3.lst and vdw energy. energies.py -c 1 100 -p 4 This command calculates conformer from 1 to 100 in 5 threads. Note After this command, the lines: 1 delphi start conformer number, 0 based (PBE_START) 99999 delphi end conformer number, self included (PBE_END) in run.prm file might be altered. getpdb \u00b6 Download a pdb file by its PDB ID. Syntax: getpbd pdbid [saved name] Example: getpdb 1akk Inquiring the remote file 1AKK.pdb ... Saving as 1AKK.pdb ... Download completed. Or getpdb 1akk prot.pdb Inquiring the remote file 1AKK.pdb ... Saving as prot.pdb ... Download completed. to save as specified name. translate_step2.py \u00b6 Translate old atom names in step2_out to new PDB v3 names. Syntax: translate_step2.py step2_out.pdb Hydrogen names in PDB v3 are significantly different from PDB v2. Due to the randomness in step 2, it is sometimes desired to preserve step2_out.pdb. This tool translates the names so that step2_out.pdb so that it can be used by new mcce. This program prints the translated content on screen. So the user is responsible to make backup of the step2_out.pdb file and redirect the outcome to a new step2_out.pdb. Example: cp step2_out.pdb step2_out.pdb.bak translate_step2.py step2_out.pdb.bak > step2_out.pdb Result Analysis \u00b6 fitpka.py \u00b6 Fit the titration curve of an ionizable residue. Syntax: $ fitpka.py -h usage: fitpka.py [-h] RES [RES ...] Fit a titration of charged residues positional arguments: RES Charged residue names to plot, as in sum_crg.out optional arguments: -h, --help show this help message and exit Required input file sum_crg.out Example: $ cat sum_crg.out pH 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 NTR+A0001_ 1.00 1.00 1.00 0.99 0.92 0.55 0.12 0.01 0.00 0.00 0.00 0.00 0.00 0.00 0.00 LYS+A0001_ 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 0.97 0.79 0.28 0.05 0.00 0.00 0.00 ARG+A0005_ 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 0.96 0.79 0.36 0.07 GLU-A0007_ -0.00 -0.01 -0.08 -0.40 -0.85 -0.98 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 LYS+A0013_ 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 0.99 0.95 0.67 0.19 0.03 0.00 ARG+A0014_ 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 0.99 0.94 0.67 0.20 HIS+A0015_ 1.00 1.00 1.00 1.00 1.00 0.98 0.86 0.40 0.06 0.01 0.00 0.00 0.00 0.00 0.00 ASP-A0018_ -0.01 -0.10 -0.50 -0.88 -0.98 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 TYR-A0020_ -0.00 -0.00 -0.00 -0.00 -0.00 -0.00 -0.00 -0.00 -0.00 -0.00 -0.01 -0.04 -0.09 -0.31 -0.69 ARG+A0021_ 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 0.99 0.91 0.60 0.21 TYR-A0023_ -0.00 -0.00 -0.00 -0.00 -0.00 -0.00 -0.00 -0.00 -0.01 -0.07 -0.35 -0.79 -0.97 -0.99 -1.00 LYS+A0033_ 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 0.97 0.78 0.28 0.04 0.01 0.00 GLU-A0035_ -0.00 -0.00 -0.00 -0.03 -0.12 -0.42 -0.86 -0.98 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 ARG+A0045_ 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 0.98 0.86 0.44 0.15 ASP-A0048_ -0.03 -0.24 -0.74 -0.95 -0.99 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 ASP-A0052_ -0.00 -0.00 -0.07 -0.34 -0.79 -0.96 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 TYR-A0053_ -0.00 -0.00 -0.00 -0.00 -0.00 -0.00 -0.00 -0.00 -0.00 -0.00 -0.00 -0.00 -0.00 -0.00 -0.00 ARG+A0061_ 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 0.98 0.89 0.56 ASP-A0066_ -0.00 -0.00 -0.38 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 ARG+A0068_ 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 0.99 0.94 0.74 0.34 ARG+A0073_ 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 0.98 0.83 0.37 0.08 ASP-A0087_ -0.01 -0.09 -0.46 -0.88 -0.99 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 LYS+A0096_ 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 0.97 0.76 0.33 0.08 0.02 0.01 LYS+A0097_ 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 0.98 0.84 0.41 0.07 0.01 0.00 ASP-A0101_ -0.00 -0.00 -0.01 -0.09 -0.51 -0.91 -0.99 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 ARG+A0112_ 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 0.99 0.88 0.47 0.11 ARG+A0114_ 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 0.99 0.93 0.64 0.16 LYS+A0116_ 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 0.97 0.76 0.28 0.05 0.01 0.00 0.00 ASP-A0119_ -0.00 -0.00 -0.03 -0.20 -0.72 -0.96 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 ARG+A0125_ 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 0.99 0.90 0.54 0.13 ARG+A0128_ 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 0.96 0.78 0.29 CTR-A0129_ -0.00 -0.04 -0.28 -0.75 -0.96 -0.99 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 ---------- Net_Charge 18.95 18.51 16.44 13.45 11.02 9.32 8.13 7.43 6.98 6.40 4.52 1.80 -0.72 -4.73 -9.38 Protons 18.95 18.51 16.44 13.45 11.02 9.32 8.13 7.43 6.98 6.40 4.52 1.80 -0.72 -4.73 -9.38 Electrons 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 Find the residue ID in sum_carg.out, then fit the titration curve: fitpka.py ASP-A0066_ state.py \u00b6 Analyze how a microstate energy is composed. Syntax: state.py Required files: run.prm head3.lst extra.tpl for scaling factors that are not equal to 1. energies/*.opp for pairwise interactions microstate file named \"states\" The microstate file is in a fixed format. The first line is like: T=298.15, ph=7.0, eh=0.0 It specifies the the environment variables which affects the energy calculation. Variables are separated by \", \". The variable names are not case sensitive. T: Temperature. Room temperature is 298.15 K ph: pH value. eh: Eh value, the electric potential for potential titration. The rest of the lines are microstates. One line per state. Each line consists the index number of conformers (0 based). Numbers can be separated by either comma or space. Example: Make a states file: Run state.py mfe.py \u00b6 Analyze ionization free energy of a residue. It tells you why a residue has that pKa and what factors played a role. Syntax mfe.py [-h] [-p pH/Eh] [-x TS_correction] [-c cutoff] residue residue: residue ID as in pK.out pH/Eh: pH value at which ionization energy is calculated. Default is the pKa (midpoint) where dG = 0. cut_off: Report only pairwise interaction bigger than this value. TS_correction: \"t\" to include entropy in G, \"f\" not to include, \"r\" (default) will look for run.prm. If entropy correction was turned on in step 4, mfe should not include this term as entropy has been \"removed\". Required files: run.prm head3.lst extra.tpl for scaling factors that are not equal to 1. energies/*.opp for pairwise interactions Example: Check titration result in pKa.out: cat pK.out ... ASP-A0044_ 3.947 ... ASP-A0052 is the residue_ID. Its calculated pKa is 2.275. At this point, the free energy of reaction from ASP neutral to ASP ionized should be close to 0. Run $ mfe.py -c 0.01 ASP-A0044_ Residue ASP-A0044_ pKa/Em=3.947 ================================= Terms pH meV Kcal --------------------------------- vdw0 -0.00 -0.27 -0.01 vdw1 -0.01 -0.59 -0.01 tors -0.15 -8.63 -0.20 ebkb -0.67 -38.66 -0.91 dsol 0.26 15.35 0.36 offset -0.62 -36.17 -0.85 pH&pK0 0.80 46.61 1.10 Eh&Em0 0.00 0.00 0.00 -TS 0.58 33.46 0.79 residues -0.19 -11.14 -0.26 ********************************* TOTAL -0.00 -0.05 -0.00 sum_crg ********************************* NTRA0003_ -0.03 -1.66 -0.04 1.00 ASPA0022_ 0.02 0.95 0.02 -0.86 ASNA0023_ -0.01 -0.68 -0.02 0.00 LYSA0027_ -0.01 -0.77 -0.02 1.00 LYSA0039_ -0.14 -8.23 -0.19 1.00 ASNA0041_ -0.01 -0.62 -0.01 0.00 LYSA0049_ -0.04 -2.10 -0.05 1.00 ASPA0054_ 0.01 0.69 0.02 -0.95 GLUA0073_ 0.01 0.79 0.02 -0.99 ASPA0075_ 0.05 2.85 0.07 -1.00 TYRA0078_ 0.02 1.05 0.02 -0.00 SERA0080_ 0.02 1.19 0.03 0.00 ARGA0083_ -0.04 -2.51 -0.06 1.00 ARGA0087_ -0.03 -1.49 -0.04 1.00 HISA0102_ -0.02 -1.02 -0.02 1.00 ================================= You can do mfe calculation at pH other than mid-point. mfe_all.py \u00b6 Perform mfe analysis on all ionizable residues. Syntax mfe_all.py [-h] [-p pH/Eh] [-x TS_correction] [-f format] [-o filename] pH/Eh: pH value at which ionization energy is calculated. Default is the pKa (midpoint) where dG = 0. TS_correction: \"t\" to include entropy in G, \"f\" not to include, \"r\" (default) will look for run.prm. If entropy correction was turned on in step 4, mfe should not include this term as entropy has been \"removed\". format: output file format, xlsx, csv, or html. The default is excel format xlsx. filename: output file name. The default is mfe_all.[ext] Required files: run.prm head3.lst extra.tpl for scaling factors that are not equal to 1. energies/*.opp for pairwise interactions Example: mfe_all.py -f html MFE output saved in file mfe_all.html sanity.py \u00b6 Quick check on the charge state of ionizable residues abd report unusual charge. Syntax sanity.py Required files: run.prm sum_crg.out Example: $ sanity.py TYR-A0013_: charge 0.00 expected near -1.0 at pH=12.0 HIS+A0018_: charge 0.00 expected near 1.0 at pH= 0.0 TYR-A0024_: charge 0.00 expected near -1.0 at pH=12.0 LYS+A0062_: charge 0.55 expected near 0.0 at pH=13.0 GLU-A0073_: charge -0.74 expected near 0.0 at pH= 2.0 ASP-A0075_: charge -1.00 expected near 0.0 at pH= 0.0 TYR-A0078_: charge 0.00 expected near -1.0 at pH=12.0 TYR-A0090_: charge -0.09 expected near -1.0 at pH=12.0 ASP-A0093_: charge -0.83 expected near 0.0 at pH= 1.0 TYR-A0097_: charge -0.17 expected near -1.0 at pH=12.0 TYR-A0103_: charge 0.00 expected near -1.0 at pH=12.0 Parameter file preparation \u00b6 pdb2ftpl.py \u00b6 This tool converts a pdb file to a ftpl template. Syntax usage: pdb2ftpl.py [-h] [-d] [-c conformer type] pdbfile Create a ftpl template file from a cofactor PDB file. The atoms in the input files are considered as one molecule. positional arguments: pdbfile optional arguments: -h, --help show this help message and exit -d Ignore CONNECT, use distance to determine bond -c conformer type Specify a 2-character conformer type ID, default 01 mol2_charge.py \u00b6 Apply mol2 charge to a conformer in ftpl template. The mol2 file doesn't need to have the matching atom names, as long as the element names are correct. Syntax $ mol2_charge.py -h usage: mol2_charge.py [-h] -m mol2 -c conf [--show] ftpl Apply mol2 charge to a conformer in ftpl template. The mol2 file doesn't need to have the matching atom names, as long as the element names are correct. positional arguments: ftpl optional arguments: -h, --help show this help message and exit -m mol2 mol2 file with charge -c conf Conformer ID in conformer list to be matched. --show Show atom name matching, default false. Example: If I have a ftpl file T4Y.tpl and a mol2 file 27c-p.mol2 with atom charge. $ mol2_charge.py -m 27c-p.mol2 T4Y.ftpl -c T4Y01 --show ================= ftpl --- mol2 ================= \" N1 \" --- \"N4\" \" C4 \" --- \"C14\" \" C5 \" --- \"C13\" \" C6 \" --- \"C12\" \" C7 \" --- \"C11\" \" C8 \" --- \"C7\" \" C10\" --- \"C5\" \" C13\" --- \"C2\" \" N \" --- \"N8\" \" C \" --- \"C18\" \" O \" --- \"O3\" \" C1 \" --- \"C17\" \" C11\" --- \"C10\" \" C12\" --- \"C9\" \" C14\" --- \"C1\" \" C2 \" --- \"C16\" \" C3 \" --- \"C15\" \" C9 \" --- \"C6\" \" H5 \" --- \"H35\" \" H6 \" --- \"H34\" \" H8 \" --- \"H32\" \" H7 \" --- \"H33\" \" H9 \" --- \"H26\" \" H10\" --- \"H27\" \" H13\" --- \"H22\" \" H14\" --- \"H23\" \" H1 \" --- \"H38\" \" H \" --- \"H39\" \" H2 \" --- \"H40\" \" H15\" --- \"H30\" \" H16\" --- \"H31\" \" H18\" --- \"H28\" \" H17\" --- \"H29\" \" H22\" --- \"H19\" \" H19\" --- \"H20\" \" H20\" --- \"H21\" \" H3 \" --- \"H37\" \" H4 \" --- \"H36\" \" H11\" --- \"H24\" \" H12\" --- \"H25\" ================= CHARGE, T4Y01, \" N1 \": -0.45 CHARGE, T4Y01, \" C4 \": -0.14 CHARGE, T4Y01, \" C5 \": -0.11 CHARGE, T4Y01, \" C6 \": -0.09 CHARGE, T4Y01, \" C7 \": 0.22 CHARGE, T4Y01, \" C8 \": 0.17 CHARGE, T4Y01, \" C10\": 0.09 CHARGE, T4Y01, \" C13\": 0.66 CHARGE, T4Y01, \" N \": -0.75 CHARGE, T4Y01, \" C \": -0.05 CHARGE, T4Y01, \" O \": -0.61 CHARGE, T4Y01, \" C1 \": -0.08 CHARGE, T4Y01, \" C11\": 0.09 CHARGE, T4Y01, \" C12\": 0.15 CHARGE, T4Y01, \" C14\": -0.17 CHARGE, T4Y01, \" C2 \": -0.13 CHARGE, T4Y01, \" C3 \": -0.13 CHARGE, T4Y01, \" C9 \": -0.10 CHARGE, T4Y01, \" H5 \": 0.13 CHARGE, T4Y01, \" H6 \": 0.15 CHARGE, T4Y01, \" H8 \": 0.04 CHARGE, T4Y01, \" H7 \": 0.04 CHARGE, T4Y01, \" H9 \": 0.04 CHARGE, T4Y01, \" H10\": 0.04 CHARGE, T4Y01, \" H13\": 0.06 CHARGE, T4Y01, \" H14\": 0.06 CHARGE, T4Y01, \" H1 \": 0.04 CHARGE, T4Y01, \" H \": 0.04 CHARGE, T4Y01, \" H2 \": 0.04 CHARGE, T4Y01, \" H15\": 0.05 CHARGE, T4Y01, \" H16\": 0.05 CHARGE, T4Y01, \" H18\": 0.03 CHARGE, T4Y01, \" H17\": 0.03 CHARGE, T4Y01, \" H22\": 0.06 CHARGE, T4Y01, \" H19\": 0.06 CHARGE, T4Y01, \" H20\": 0.06 CHARGE, T4Y01, \" H3 \": 0.13 CHARGE, T4Y01, \" H4 \": 0.13 CHARGE, T4Y01, \" H11\": 0.06 CHARGE, T4Y01, \" H12\": 0.06 tpl-free2mcce.py \u00b6 This command converts ftpl files to ./param, a directory hosts old mcce tple files. It is a compatibility tool, which makes new ftpl files readable by old mcce executable. Syntax tpl-free2mcce.py Input file: run.prm param/ under mcce distribution directory Output file param under current directory tpl-mcce2free.py \u00b6 Future versions of MCCE will use ftpl format, and this command converts mcce tpl file to new ftpl file. Syntax tpl-mcce2ftpl.py tplfile Input file: tpl file Output file ftpl file content on screen. verify_ftpl.py \u00b6 This program verifies a ftpl by reading a pdb file of that cofactor. Syntax verify_ftpl.py tplfile pdbfile Input file: ftpl file pdb file that corresponds to that ftpl file Connecting to other programs \u00b6 striph2o.py \u00b6 This tool strips away specified surface molecules layer by layer until all left are buried Syntax usage: striph2o.py [-h] [-c RES [RES ...]] [-s exposure] -f inputfile [-o outputfile] Strip off exposed cofactors like water and ions based on solvent accessible surface area. optional arguments: -h, --help show this help message and exit -c RES [RES ...] Specify cofactor names to strip off, default is HOH. -s exposure Fraction exposure threshold to be cut. Default is 0.05. -f inputfile Input file name. -o outputfile Output file name, default is inputfile name with extension .stripped. This program does not only strip off water, it also strip off any molecule as named in the command line. So one can use it to delete ions and lipid bilayers in the input structure. Required files: input pdb file Output files input_file-stripped.pdb for stripped pdb file unless otherwise named input_file.acc for residue solvent accessibility Example: striph2o.py -f frame32_50.pdb -c HOH CLA SOD BGA POP DLP","title":"Tools Program Reference"},{"location":"tools/#mcce-tools-reference","text":"Page last updated on: 2020-06-26","title":"MCCE tools reference"},{"location":"tools/#improving-and-helping-runs","text":"","title":"Improving and helping runs"},{"location":"tools/#step-by-step-mcce-run-scripts","text":"MCCE involves 4 main steps: Step 1: Convert raw PDB file to MCCE PDB file, reformat terminal residues, and strip off surface water and ions. Step 2: Make side chain conformers, including rotamers and ionization conformers. Step 3: Compute self-energy of conformers and pairwise energy lookup table. Step 4: Monte Carlo sampling to evaluate favorable side chain position and ionization at various conditions. While the control of these 4 steps is fully configured in run.prm and executed by mcce command, the 4 steps can be carried out by python wrapper scripts without configuring run.prm.","title":"step by step mcce run scripts"},{"location":"tools/#step-1-prepare-structure","text":"usage: step1.py [-h] [--norun] [--noter] [-e /path/to/mcce] [-u Key=Value] [-d epsilon] [--dry] pdb Run mcce step 1, premcce to format PDB file to MCCE PDB format. positional arguments: pdb optional arguments: -h, --help show this help message and exit --norun Create run.prm but do not run step 1 --noter Do not label terminal residues (for making ftpl). -e /path/to/mcce mcce executable location, default to \"mcce\" -u Key=Value User customized variables -d epsilon protein dielectric constant for delphi, default to 4.0 --dry Delete all water molecules.","title":"Step 1: prepare structure"},{"location":"tools/#step-2-make-conformers","text":"usage: step2.py [-h] [--norun] [-d epsilon] [-e /path/to/mcce] [-u Key=Value] [-l level] Run mcce step 2, make side chain conformers from step1_out.pdb. optional arguments: -h, --help show this help message and exit --norun Create run.prm but do not run step 2 -d epsilon dielectric constant for optimizing conformers -e /path/to/mcce mcce executable location, default to \"mcce\" -u Key=Value User customized variables -l level conformer level 1: quick, 2: medium, 3: comprehensive","title":"Step 2: make conformers"},{"location":"tools/#step-3-energy-calculation","text":"usage: step3.py [-h] [-c start end] [-d epsilon] [-e /path/to/mcce] [-f tmp folder] [-p processes] [-r] [-u Key=Value] [-x /path/to/delphi] [--norun] Run mcce step 3, energy calculations, with multiple threads. optional arguments: -h, --help show this help message and exit -c start end starting and ending conformer, default to 1 and 9999 -d epsilon protein dielectric constant for delphi, default to 4.0 -e /path/to/mcce mcce executable location, default to \"mcce\" -f tmp folder delphi temporary folder, default to /tmp -p processes run mcce with number of processes, default to 1 -r refresh opp files and head3.lst without running delphi -u Key=Value User customized variables -x /path/to/delphi delphi executable location, default to \"delphi\" --norun Create run.prm but do not run step 3 step3.py is able to run in multiple threads.","title":"Step 3: energy calculation"},{"location":"tools/#step-4-monte-carlo-sampling","text":"usage: step4.py [-h] [--norun] [-i initial ph/eh] [-d interval] [-n steps] [--xts] [--ms] [-e /path/to/mcce] [-t ph or eh] [-u Key=Value] Run mcce step 4, Monte Carlo sampling to simulate a titration. optional arguments: -h, --help show this help message and exit --norun Create run.prm but do not run step 4 -i initial ph/eh Initial pH/Eh of titration -d interval titration interval in pJ or mV -n steps number of steps of titration --xts Enable entropy correction, default is false --ms Enable microstate output -e /path/to/mcce mcce executable location, default to \"mcce\" -t ph or eh titration type, pH or Eh -u Key=Value User customized variables","title":"Step 4: Monte Carlo sampling"},{"location":"tools/#step-5-titration-fitting","text":"Step 5 is optional. It writes net charge of each residue in sum_crg2.out and fits the titration curve in pK2.out. usage: step5.py [-h] Run mcce step 5, generate net charge, fit titration curve. optional arguments: -h, --help show this help message and exit","title":"Step 5: titration fitting"},{"location":"tools/#step-6-hydrogen-bond","text":"Step 6 is for hydrogen bond network analysis. It requires step 4 to output microstates. usage: step6.py [-h] [--norun] [-e /path/to/mcce] [-u Key=Value] Run step 6, hydrogen bond analysis, requires microstate output from step 4. optional arguments: -h, --help show this help message and exit --norun Create run.prm but do not run step 6 -e /path/to/mcce mcce executable location, default to \"mcce\" -u Key=Value User customized variables Example: step4.py --ms step6.py","title":"Step 6: hydrogen bond"},{"location":"tools/#combine-first-4-steps","text":"The first 4 steps are essential steps. #!/bin/bash step1.py input.pdb step2.py step3.py step4.py","title":"Combine first 4 steps"},{"location":"tools/#energiespy","text":"Run step3 with multiple threads. Syntax: energies.py [-h] [-p processes] [-r] [-c start end] [-e /path/to/mcce] Optional arguments: Argument Description -h, --help show this help message and exit -p processes run mcce with number of processes, default to 1 -r refresh opp files and head3.lst without running delphi -c start end starting and ending conformer, default to 1 and 9999 -e /path/to/mcce mcce executable location, default to \"mcce\" Examples: energies.py -p 6 This command runs step 3 in 6 threads. energies.py -r This command runs step 3 just to refresh head3.lst and vdw energy. energies.py -c 1 100 -p 4 This command calculates conformer from 1 to 100 in 5 threads. Note After this command, the lines: 1 delphi start conformer number, 0 based (PBE_START) 99999 delphi end conformer number, self included (PBE_END) in run.prm file might be altered.","title":"energies.py"},{"location":"tools/#getpdb","text":"Download a pdb file by its PDB ID. Syntax: getpbd pdbid [saved name] Example: getpdb 1akk Inquiring the remote file 1AKK.pdb ... Saving as 1AKK.pdb ... Download completed. Or getpdb 1akk prot.pdb Inquiring the remote file 1AKK.pdb ... Saving as prot.pdb ... Download completed. to save as specified name.","title":"getpdb"},{"location":"tools/#translate_step2py","text":"Translate old atom names in step2_out to new PDB v3 names. Syntax: translate_step2.py step2_out.pdb Hydrogen names in PDB v3 are significantly different from PDB v2. Due to the randomness in step 2, it is sometimes desired to preserve step2_out.pdb. This tool translates the names so that step2_out.pdb so that it can be used by new mcce. This program prints the translated content on screen. So the user is responsible to make backup of the step2_out.pdb file and redirect the outcome to a new step2_out.pdb. Example: cp step2_out.pdb step2_out.pdb.bak translate_step2.py step2_out.pdb.bak > step2_out.pdb","title":"translate_step2.py"},{"location":"tools/#result-analysis","text":"","title":"Result Analysis"},{"location":"tools/#fitpkapy","text":"Fit the titration curve of an ionizable residue. Syntax: $ fitpka.py -h usage: fitpka.py [-h] RES [RES ...] Fit a titration of charged residues positional arguments: RES Charged residue names to plot, as in sum_crg.out optional arguments: -h, --help show this help message and exit Required input file sum_crg.out Example: $ cat sum_crg.out pH 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 NTR+A0001_ 1.00 1.00 1.00 0.99 0.92 0.55 0.12 0.01 0.00 0.00 0.00 0.00 0.00 0.00 0.00 LYS+A0001_ 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 0.97 0.79 0.28 0.05 0.00 0.00 0.00 ARG+A0005_ 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 0.96 0.79 0.36 0.07 GLU-A0007_ -0.00 -0.01 -0.08 -0.40 -0.85 -0.98 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 LYS+A0013_ 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 0.99 0.95 0.67 0.19 0.03 0.00 ARG+A0014_ 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 0.99 0.94 0.67 0.20 HIS+A0015_ 1.00 1.00 1.00 1.00 1.00 0.98 0.86 0.40 0.06 0.01 0.00 0.00 0.00 0.00 0.00 ASP-A0018_ -0.01 -0.10 -0.50 -0.88 -0.98 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 TYR-A0020_ -0.00 -0.00 -0.00 -0.00 -0.00 -0.00 -0.00 -0.00 -0.00 -0.00 -0.01 -0.04 -0.09 -0.31 -0.69 ARG+A0021_ 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 0.99 0.91 0.60 0.21 TYR-A0023_ -0.00 -0.00 -0.00 -0.00 -0.00 -0.00 -0.00 -0.00 -0.01 -0.07 -0.35 -0.79 -0.97 -0.99 -1.00 LYS+A0033_ 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 0.97 0.78 0.28 0.04 0.01 0.00 GLU-A0035_ -0.00 -0.00 -0.00 -0.03 -0.12 -0.42 -0.86 -0.98 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 ARG+A0045_ 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 0.98 0.86 0.44 0.15 ASP-A0048_ -0.03 -0.24 -0.74 -0.95 -0.99 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 ASP-A0052_ -0.00 -0.00 -0.07 -0.34 -0.79 -0.96 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 TYR-A0053_ -0.00 -0.00 -0.00 -0.00 -0.00 -0.00 -0.00 -0.00 -0.00 -0.00 -0.00 -0.00 -0.00 -0.00 -0.00 ARG+A0061_ 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 0.98 0.89 0.56 ASP-A0066_ -0.00 -0.00 -0.38 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 ARG+A0068_ 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 0.99 0.94 0.74 0.34 ARG+A0073_ 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 0.98 0.83 0.37 0.08 ASP-A0087_ -0.01 -0.09 -0.46 -0.88 -0.99 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 LYS+A0096_ 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 0.97 0.76 0.33 0.08 0.02 0.01 LYS+A0097_ 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 0.98 0.84 0.41 0.07 0.01 0.00 ASP-A0101_ -0.00 -0.00 -0.01 -0.09 -0.51 -0.91 -0.99 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 ARG+A0112_ 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 0.99 0.88 0.47 0.11 ARG+A0114_ 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 0.99 0.93 0.64 0.16 LYS+A0116_ 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 0.97 0.76 0.28 0.05 0.01 0.00 0.00 ASP-A0119_ -0.00 -0.00 -0.03 -0.20 -0.72 -0.96 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 ARG+A0125_ 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 0.99 0.90 0.54 0.13 ARG+A0128_ 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 1.00 0.96 0.78 0.29 CTR-A0129_ -0.00 -0.04 -0.28 -0.75 -0.96 -0.99 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 -1.00 ---------- Net_Charge 18.95 18.51 16.44 13.45 11.02 9.32 8.13 7.43 6.98 6.40 4.52 1.80 -0.72 -4.73 -9.38 Protons 18.95 18.51 16.44 13.45 11.02 9.32 8.13 7.43 6.98 6.40 4.52 1.80 -0.72 -4.73 -9.38 Electrons 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 Find the residue ID in sum_carg.out, then fit the titration curve: fitpka.py ASP-A0066_","title":"fitpka.py"},{"location":"tools/#statepy","text":"Analyze how a microstate energy is composed. Syntax: state.py Required files: run.prm head3.lst extra.tpl for scaling factors that are not equal to 1. energies/*.opp for pairwise interactions microstate file named \"states\" The microstate file is in a fixed format. The first line is like: T=298.15, ph=7.0, eh=0.0 It specifies the the environment variables which affects the energy calculation. Variables are separated by \", \". The variable names are not case sensitive. T: Temperature. Room temperature is 298.15 K ph: pH value. eh: Eh value, the electric potential for potential titration. The rest of the lines are microstates. One line per state. Each line consists the index number of conformers (0 based). Numbers can be separated by either comma or space. Example: Make a states file: Run state.py","title":"state.py"},{"location":"tools/#mfepy","text":"Analyze ionization free energy of a residue. It tells you why a residue has that pKa and what factors played a role. Syntax mfe.py [-h] [-p pH/Eh] [-x TS_correction] [-c cutoff] residue residue: residue ID as in pK.out pH/Eh: pH value at which ionization energy is calculated. Default is the pKa (midpoint) where dG = 0. cut_off: Report only pairwise interaction bigger than this value. TS_correction: \"t\" to include entropy in G, \"f\" not to include, \"r\" (default) will look for run.prm. If entropy correction was turned on in step 4, mfe should not include this term as entropy has been \"removed\". Required files: run.prm head3.lst extra.tpl for scaling factors that are not equal to 1. energies/*.opp for pairwise interactions Example: Check titration result in pKa.out: cat pK.out ... ASP-A0044_ 3.947 ... ASP-A0052 is the residue_ID. Its calculated pKa is 2.275. At this point, the free energy of reaction from ASP neutral to ASP ionized should be close to 0. Run $ mfe.py -c 0.01 ASP-A0044_ Residue ASP-A0044_ pKa/Em=3.947 ================================= Terms pH meV Kcal --------------------------------- vdw0 -0.00 -0.27 -0.01 vdw1 -0.01 -0.59 -0.01 tors -0.15 -8.63 -0.20 ebkb -0.67 -38.66 -0.91 dsol 0.26 15.35 0.36 offset -0.62 -36.17 -0.85 pH&pK0 0.80 46.61 1.10 Eh&Em0 0.00 0.00 0.00 -TS 0.58 33.46 0.79 residues -0.19 -11.14 -0.26 ********************************* TOTAL -0.00 -0.05 -0.00 sum_crg ********************************* NTRA0003_ -0.03 -1.66 -0.04 1.00 ASPA0022_ 0.02 0.95 0.02 -0.86 ASNA0023_ -0.01 -0.68 -0.02 0.00 LYSA0027_ -0.01 -0.77 -0.02 1.00 LYSA0039_ -0.14 -8.23 -0.19 1.00 ASNA0041_ -0.01 -0.62 -0.01 0.00 LYSA0049_ -0.04 -2.10 -0.05 1.00 ASPA0054_ 0.01 0.69 0.02 -0.95 GLUA0073_ 0.01 0.79 0.02 -0.99 ASPA0075_ 0.05 2.85 0.07 -1.00 TYRA0078_ 0.02 1.05 0.02 -0.00 SERA0080_ 0.02 1.19 0.03 0.00 ARGA0083_ -0.04 -2.51 -0.06 1.00 ARGA0087_ -0.03 -1.49 -0.04 1.00 HISA0102_ -0.02 -1.02 -0.02 1.00 ================================= You can do mfe calculation at pH other than mid-point.","title":"mfe.py"},{"location":"tools/#mfe_allpy","text":"Perform mfe analysis on all ionizable residues. Syntax mfe_all.py [-h] [-p pH/Eh] [-x TS_correction] [-f format] [-o filename] pH/Eh: pH value at which ionization energy is calculated. Default is the pKa (midpoint) where dG = 0. TS_correction: \"t\" to include entropy in G, \"f\" not to include, \"r\" (default) will look for run.prm. If entropy correction was turned on in step 4, mfe should not include this term as entropy has been \"removed\". format: output file format, xlsx, csv, or html. The default is excel format xlsx. filename: output file name. The default is mfe_all.[ext] Required files: run.prm head3.lst extra.tpl for scaling factors that are not equal to 1. energies/*.opp for pairwise interactions Example: mfe_all.py -f html MFE output saved in file mfe_all.html","title":"mfe_all.py"},{"location":"tools/#sanitypy","text":"Quick check on the charge state of ionizable residues abd report unusual charge. Syntax sanity.py Required files: run.prm sum_crg.out Example: $ sanity.py TYR-A0013_: charge 0.00 expected near -1.0 at pH=12.0 HIS+A0018_: charge 0.00 expected near 1.0 at pH= 0.0 TYR-A0024_: charge 0.00 expected near -1.0 at pH=12.0 LYS+A0062_: charge 0.55 expected near 0.0 at pH=13.0 GLU-A0073_: charge -0.74 expected near 0.0 at pH= 2.0 ASP-A0075_: charge -1.00 expected near 0.0 at pH= 0.0 TYR-A0078_: charge 0.00 expected near -1.0 at pH=12.0 TYR-A0090_: charge -0.09 expected near -1.0 at pH=12.0 ASP-A0093_: charge -0.83 expected near 0.0 at pH= 1.0 TYR-A0097_: charge -0.17 expected near -1.0 at pH=12.0 TYR-A0103_: charge 0.00 expected near -1.0 at pH=12.0","title":"sanity.py"},{"location":"tools/#parameter-file-preparation","text":"","title":"Parameter file preparation"},{"location":"tools/#pdb2ftplpy","text":"This tool converts a pdb file to a ftpl template. Syntax usage: pdb2ftpl.py [-h] [-d] [-c conformer type] pdbfile Create a ftpl template file from a cofactor PDB file. The atoms in the input files are considered as one molecule. positional arguments: pdbfile optional arguments: -h, --help show this help message and exit -d Ignore CONNECT, use distance to determine bond -c conformer type Specify a 2-character conformer type ID, default 01","title":"pdb2ftpl.py"},{"location":"tools/#mol2_chargepy","text":"Apply mol2 charge to a conformer in ftpl template. The mol2 file doesn't need to have the matching atom names, as long as the element names are correct. Syntax $ mol2_charge.py -h usage: mol2_charge.py [-h] -m mol2 -c conf [--show] ftpl Apply mol2 charge to a conformer in ftpl template. The mol2 file doesn't need to have the matching atom names, as long as the element names are correct. positional arguments: ftpl optional arguments: -h, --help show this help message and exit -m mol2 mol2 file with charge -c conf Conformer ID in conformer list to be matched. --show Show atom name matching, default false. Example: If I have a ftpl file T4Y.tpl and a mol2 file 27c-p.mol2 with atom charge. $ mol2_charge.py -m 27c-p.mol2 T4Y.ftpl -c T4Y01 --show ================= ftpl --- mol2 ================= \" N1 \" --- \"N4\" \" C4 \" --- \"C14\" \" C5 \" --- \"C13\" \" C6 \" --- \"C12\" \" C7 \" --- \"C11\" \" C8 \" --- \"C7\" \" C10\" --- \"C5\" \" C13\" --- \"C2\" \" N \" --- \"N8\" \" C \" --- \"C18\" \" O \" --- \"O3\" \" C1 \" --- \"C17\" \" C11\" --- \"C10\" \" C12\" --- \"C9\" \" C14\" --- \"C1\" \" C2 \" --- \"C16\" \" C3 \" --- \"C15\" \" C9 \" --- \"C6\" \" H5 \" --- \"H35\" \" H6 \" --- \"H34\" \" H8 \" --- \"H32\" \" H7 \" --- \"H33\" \" H9 \" --- \"H26\" \" H10\" --- \"H27\" \" H13\" --- \"H22\" \" H14\" --- \"H23\" \" H1 \" --- \"H38\" \" H \" --- \"H39\" \" H2 \" --- \"H40\" \" H15\" --- \"H30\" \" H16\" --- \"H31\" \" H18\" --- \"H28\" \" H17\" --- \"H29\" \" H22\" --- \"H19\" \" H19\" --- \"H20\" \" H20\" --- \"H21\" \" H3 \" --- \"H37\" \" H4 \" --- \"H36\" \" H11\" --- \"H24\" \" H12\" --- \"H25\" ================= CHARGE, T4Y01, \" N1 \": -0.45 CHARGE, T4Y01, \" C4 \": -0.14 CHARGE, T4Y01, \" C5 \": -0.11 CHARGE, T4Y01, \" C6 \": -0.09 CHARGE, T4Y01, \" C7 \": 0.22 CHARGE, T4Y01, \" C8 \": 0.17 CHARGE, T4Y01, \" C10\": 0.09 CHARGE, T4Y01, \" C13\": 0.66 CHARGE, T4Y01, \" N \": -0.75 CHARGE, T4Y01, \" C \": -0.05 CHARGE, T4Y01, \" O \": -0.61 CHARGE, T4Y01, \" C1 \": -0.08 CHARGE, T4Y01, \" C11\": 0.09 CHARGE, T4Y01, \" C12\": 0.15 CHARGE, T4Y01, \" C14\": -0.17 CHARGE, T4Y01, \" C2 \": -0.13 CHARGE, T4Y01, \" C3 \": -0.13 CHARGE, T4Y01, \" C9 \": -0.10 CHARGE, T4Y01, \" H5 \": 0.13 CHARGE, T4Y01, \" H6 \": 0.15 CHARGE, T4Y01, \" H8 \": 0.04 CHARGE, T4Y01, \" H7 \": 0.04 CHARGE, T4Y01, \" H9 \": 0.04 CHARGE, T4Y01, \" H10\": 0.04 CHARGE, T4Y01, \" H13\": 0.06 CHARGE, T4Y01, \" H14\": 0.06 CHARGE, T4Y01, \" H1 \": 0.04 CHARGE, T4Y01, \" H \": 0.04 CHARGE, T4Y01, \" H2 \": 0.04 CHARGE, T4Y01, \" H15\": 0.05 CHARGE, T4Y01, \" H16\": 0.05 CHARGE, T4Y01, \" H18\": 0.03 CHARGE, T4Y01, \" H17\": 0.03 CHARGE, T4Y01, \" H22\": 0.06 CHARGE, T4Y01, \" H19\": 0.06 CHARGE, T4Y01, \" H20\": 0.06 CHARGE, T4Y01, \" H3 \": 0.13 CHARGE, T4Y01, \" H4 \": 0.13 CHARGE, T4Y01, \" H11\": 0.06 CHARGE, T4Y01, \" H12\": 0.06","title":"mol2_charge.py"},{"location":"tools/#tpl-free2mccepy","text":"This command converts ftpl files to ./param, a directory hosts old mcce tple files. It is a compatibility tool, which makes new ftpl files readable by old mcce executable. Syntax tpl-free2mcce.py Input file: run.prm param/ under mcce distribution directory Output file param under current directory","title":"tpl-free2mcce.py"},{"location":"tools/#tpl-mcce2freepy","text":"Future versions of MCCE will use ftpl format, and this command converts mcce tpl file to new ftpl file. Syntax tpl-mcce2ftpl.py tplfile Input file: tpl file Output file ftpl file content on screen.","title":"tpl-mcce2free.py"},{"location":"tools/#verify_ftplpy","text":"This program verifies a ftpl by reading a pdb file of that cofactor. Syntax verify_ftpl.py tplfile pdbfile Input file: ftpl file pdb file that corresponds to that ftpl file","title":"verify_ftpl.py"},{"location":"tools/#connecting-to-other-programs","text":"","title":"Connecting to other programs"},{"location":"tools/#striph2opy","text":"This tool strips away specified surface molecules layer by layer until all left are buried Syntax usage: striph2o.py [-h] [-c RES [RES ...]] [-s exposure] -f inputfile [-o outputfile] Strip off exposed cofactors like water and ions based on solvent accessible surface area. optional arguments: -h, --help show this help message and exit -c RES [RES ...] Specify cofactor names to strip off, default is HOH. -s exposure Fraction exposure threshold to be cut. Default is 0.05. -f inputfile Input file name. -o outputfile Output file name, default is inputfile name with extension .stripped. This program does not only strip off water, it also strip off any molecule as named in the command line. So one can use it to delete ions and lipid bilayers in the input structure. Required files: input pdb file Output files input_file-stripped.pdb for stripped pdb file unless otherwise named input_file.acc for residue solvent accessibility Example: striph2o.py -f frame32_50.pdb -c HOH CLA SOD BGA POP DLP","title":"striph2o.py"},{"location":"wikihowto/","text":"How to edit MCCE wiki \u00b6 Page last updated on: 2020-07-07 This documentation is written in mkdocs, which uses markdown language and publishes on github pages at url https://github.com/GunnerLab/Stable-MCCE . Install of Mkdocs \u00b6 You need pip, a python package manager, for installation. Generally, you are able to install pip through conda $ conda install pip or system package manager $ sudo aptitude install python-pip If you don't know pip, please go to https://pip.pypa.io/en/stable/ for more information. In a terminal window, run these commands to install mkdocs, theme, and necessary plugins for documentation of this project. $ pip install --upgrade pip $ pip install bs4 $ pip install unicode $ pip install mkdocs $ pip install mkdocs-material $ pip install pymdown-extensions $ pip install markdown-blockdiag $ pip install markdown-include $ pip install mkdocs-git-revision-date-plugin Writing and editing \u00b6 All documentation files reside under folder wiki/ mkdocs.yml : configuration file, also defines the menu docs/ : location of documentation files img/ : location for image files site/ : site web pages published by command mkdocs gh-deploy, do not edit this directory. Under wiki/ directory, run $ mkdocs serve will bring up a web service, and point browser to http://localhost:8000 to enable viewing and debugging the documentation. Deploying \u00b6 Commit changes: \u00b6 $ git commit -a -m \"updated by jmao\" This commit will update the time stamp on the page as well. Push to your forked repository \u00b6 First check if you set up the GunnerLab as upstream For example: (base) jmao@pc:~/projects/Stable-MCCE/wiki$ git remote -v origin https://github.com/newbooks/Stable-MCCE.git (fetch) origin https://github.com/newbooks/Stable-MCCE.git (push) upstream https://github.com/GunnerLab/Stable-MCCE.git (fetch) upstream https://github.com/GunnerLab/Stable-MCCE.git (push) If you do not have upstream repo, push to the origin, then make a pull request: $ git push Then go to https://github.com/ under your forked repository. Make a pull request. Someone will publish the edit for you. Publish directly \u00b6 If you are a group member with publish permission, you can publish directly. Make sure the upstream is setup properly: $ git remote -v If upstream is not pointing to https://github.com/GunnerLab/Stable-MCCE.git , run git remote add upstream https://github.com/GunnerLab/Stable-MCCE.git Under wiki folder, run gh-deploy (base) jmao@pc:~/projects/Stable-MCCE/wiki$ mkdocs gh-deploy INFO - Cleaning site directory INFO - Building documentation to directory: /home/jmao/projects/Stable-MCCE/wiki/site INFO - Copying '/home/jmao/projects/Stable-MCCE/wiki/site' to 'gh-pages' branch and pushing to GitHub. INFO - Your documentation should shortly be available at: https://GunnerLab.github.io/Stable-MCCE/ If gh-deploy reports conflict in special branch gh-pages, use \"--force\" switch to overwrite: $ mkdocs gh-deploy --force The published site is on: https://gunnerlab.github.io/Stable-MCCE/ . Markdown resources \u00b6 Basic syntax: https://www.markdownguide.org/cheat-sheet/ More on syntax: https://alinex.gitlab.io/env/mkdocs/ Diagram: http://blockdiag.com/en/blockdiag/ PyDown: https://facelessuser.github.io/pymdown-extensions/extensions/arithmatex/","title":"How to write documentation"},{"location":"wikihowto/#how-to-edit-mcce-wiki","text":"Page last updated on: 2020-07-07 This documentation is written in mkdocs, which uses markdown language and publishes on github pages at url https://github.com/GunnerLab/Stable-MCCE .","title":"How to edit MCCE wiki"},{"location":"wikihowto/#install-of-mkdocs","text":"You need pip, a python package manager, for installation. Generally, you are able to install pip through conda $ conda install pip or system package manager $ sudo aptitude install python-pip If you don't know pip, please go to https://pip.pypa.io/en/stable/ for more information. In a terminal window, run these commands to install mkdocs, theme, and necessary plugins for documentation of this project. $ pip install --upgrade pip $ pip install bs4 $ pip install unicode $ pip install mkdocs $ pip install mkdocs-material $ pip install pymdown-extensions $ pip install markdown-blockdiag $ pip install markdown-include $ pip install mkdocs-git-revision-date-plugin","title":"Install of Mkdocs"},{"location":"wikihowto/#writing-and-editing","text":"All documentation files reside under folder wiki/ mkdocs.yml : configuration file, also defines the menu docs/ : location of documentation files img/ : location for image files site/ : site web pages published by command mkdocs gh-deploy, do not edit this directory. Under wiki/ directory, run $ mkdocs serve will bring up a web service, and point browser to http://localhost:8000 to enable viewing and debugging the documentation.","title":"Writing and editing"},{"location":"wikihowto/#deploying","text":"","title":"Deploying"},{"location":"wikihowto/#commit-changes","text":"$ git commit -a -m \"updated by jmao\" This commit will update the time stamp on the page as well.","title":"Commit changes:"},{"location":"wikihowto/#push-to-your-forked-repository","text":"First check if you set up the GunnerLab as upstream For example: (base) jmao@pc:~/projects/Stable-MCCE/wiki$ git remote -v origin https://github.com/newbooks/Stable-MCCE.git (fetch) origin https://github.com/newbooks/Stable-MCCE.git (push) upstream https://github.com/GunnerLab/Stable-MCCE.git (fetch) upstream https://github.com/GunnerLab/Stable-MCCE.git (push) If you do not have upstream repo, push to the origin, then make a pull request: $ git push Then go to https://github.com/ under your forked repository. Make a pull request. Someone will publish the edit for you.","title":"Push to your forked repository"},{"location":"wikihowto/#publish-directly","text":"If you are a group member with publish permission, you can publish directly. Make sure the upstream is setup properly: $ git remote -v If upstream is not pointing to https://github.com/GunnerLab/Stable-MCCE.git , run git remote add upstream https://github.com/GunnerLab/Stable-MCCE.git Under wiki folder, run gh-deploy (base) jmao@pc:~/projects/Stable-MCCE/wiki$ mkdocs gh-deploy INFO - Cleaning site directory INFO - Building documentation to directory: /home/jmao/projects/Stable-MCCE/wiki/site INFO - Copying '/home/jmao/projects/Stable-MCCE/wiki/site' to 'gh-pages' branch and pushing to GitHub. INFO - Your documentation should shortly be available at: https://GunnerLab.github.io/Stable-MCCE/ If gh-deploy reports conflict in special branch gh-pages, use \"--force\" switch to overwrite: $ mkdocs gh-deploy --force The published site is on: https://gunnerlab.github.io/Stable-MCCE/ .","title":"Publish directly"},{"location":"wikihowto/#markdown-resources","text":"Basic syntax: https://www.markdownguide.org/cheat-sheet/ More on syntax: https://alinex.gitlab.io/env/mkdocs/ Diagram: http://blockdiag.com/en/blockdiag/ PyDown: https://facelessuser.github.io/pymdown-extensions/extensions/arithmatex/","title":"Markdown resources"}]}